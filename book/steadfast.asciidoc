= Steadfast Self-Hosting: Rapid-Rise Personal Cloud
:author: Adam Monsen
:copyright: (C)2025 {author}
:doctype: book
:docinfo:
:toc: macro
:toclevels: 2
:imagesdir: img
:front-cover-image: image:cover.png[]
:icons: font
:xrefstyle: full
:hide-uri-scheme:
// see https://pygments.org/languages/ for available languages and their short names
:source-highlighter: pygments
:!chapter-signifier:
// prevent unnecessary blocking fetch of fonts
:!webfonts:
:pdf-themesdir: pdf-theme
ifdef::shb-screenPDF[]
:pdf-theme: screen.yml
endif::[]
ifdef::shb-printPDF[]
:!front-cover-image:
:pdf-theme: print.yml
:media: prepress
endif::[]
// necessary for keyboard macro (kbd)
:experimental:
:keywords: linux, web, servers, sysadmin, computers, tech, self-hosting, FOSS
:description: Quickly learn the hows and whys of reliable self-hosted web services.
:revnumber: {build_git_tag}
:revdate: {build_date_time}
:revremark: {build_locale_lang}
// see https://docs.asciidoctor.org/asciidoc/latest/blocks/add-title/#captioned-titles
:listing-caption: Listing

ifdef::backend-html5[]
// https://github.com/asciidoctor/asciidoctor/issues/857
++++
<style>
  .imageblock > .title {
    text-align: inherit;
  }
</style>
++++
endif::backend-html5[]

include::locale/attributes-de.adoc[]

[colophon%notitle%nonfacing]
== Kolophon

--
_{doctitle}_
--

--
{copyright}.
Manche Rechte vorbehalten.
Dieses Buch ist lizenziert unter einer https://creativecommons.org/licenses/by-sa/4.0/[Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0) License].

image::cc-by-sa.svg[align="center"]
--

--
Das wundersch√∂ne Titelbild wurde von meiner Tochter mit Krita gestaltet.
Mehr von ihrer gro√üartigen Kunst findest du im Laufe des Buches.
--

--
Technische Redaktion von https://www.wondra.codes[Lenny Wondra].
--

--
Deutsche √úbersetzung von Fiona Burkart.
--

--
Erstmals ver√∂ffentlicht im Jahr 2024 von https://sunrisedata.io[Sunrise Data Press].
--

--
Seattle, Washington, USA.
--

ifdef::backend-epub3[]
--
EPUB ISBN: 979-8-9908615-0-3
--
endif::[]

ifdef::shb-screenPDF[]
--
PDF ISBN: 979-8-9908615-2-7
--
endif::[]

ifdef::shb-printPDF+printQuality-standard[]
--
Paperback ISBN: 979-8-9908615-1-0
--

--
Library of Congress Control Number: 2024911437
--
endif::[]

ifdef::shb-printPDF+printQuality-premium[]
--
Premium paperback ISBN: 979-8-9908615-3-4
--
endif::[]

// "big" is perhaps deprecated, see https://docs.asciidoctor.org/asciidoc/latest/text/text-span-built-in-roles/#built-in
//
// ...or maybe it is only deprecated for HTML? See https://docs.asciidoctor.org/pdf-converter/latest/roles/

--
[.text-center]
image:sunrisedata-logo.svg[alt=Sunrise Data logo,width=49,height=97,fit=line] [.big]#Sunrise Data Press#
--

toc::[]

== Vorwort

Bevor ich 2006 anfing, im Open-Source-Bereich zu arbeiten, war ich als Community-Organisator in Massachusetts t√§tig.
Ich kannte die Auswirkungen eines Mangels an Informationszugang oder das Fehlen des ‚Äûrichtigen‚Äú Handbuchs sehr gut ‚Äì beides hindert Menschen daran, mitzubestimmen, wie sie ihr Leben gestalten.
Als Community-Organisatorin brachte ich den Menschen bei, wie man Lobbyarbeit betreibt.
Unsere Organisation lud Menschen ein, gemeinsam mit Abgeordneten Gesetze zu entwerfen, die ihren Bed√ºrfnissen gerecht wurden und ihr Leben verbesserten.
Wir zeigten ihnen, wie man Spenden sammelt, und wie sie sich selbst und ihre Nachbarschaft organisieren k√∂nnen.
Und dann verlagerte sich alles zunehmend ins Internet ‚Äì und wichtige Diskussionen dar√ºber, wie wir die Schw√§chsten sch√ºtzen und die n√§chste Generation st√§rken k√∂nnen, begannen, √ºber unsere Computer stattzufinden.

Man kann Fortschritt entweder beklagen oder ihn annehmen.
Ich entschied mich daf√ºr, ihn anzunehmen. Ich wollte Menschen st√§rken und ihnen helfen, ein Gef√ºhl von Kontrolle √ºber ihre Computer- und Technologienutzung zu erlangen.
Ich begann, ganz unterschiedliche Menschen aus der Freie-Software-Bewegung kennenzulernen. Einige von ihnen interessierten sich sehr daf√ºr, wie der Code funktioniert, und andere - wie Adam - waren vor allem daran interessiert, auf welche Weise frei zug√§nglicher Code Menschen helfen kann.

Adam und ich lernten uns 2009 bei ((LFNW)) (LinuxFest Northwest) kennen, einer kostenlosen Community-Konferenz in Bellingham, Washington.
Ein gemeinsamer Freund hatte mir empfohlen, bei einem Besuch in Washington anl√§sslich des LFNW auch einmal Seattle zu besuchen ‚Äì was bedeutete, dass wir gemainsam von Seattle nach Bellingham fuhren.
Wir trafen uns alle in Seattle zum Mittagessen und machten uns dann gemeinsam auf die zweist√ºndige Autofahrt nach Bellingham.
Auf diesen Fahrten begannen wir wirklich, √ºber das Fehlen einer Freie-Software-Veranstaltung in Seattle zu sprechen.
Uns wurde klar, dass es in Seattle Leute brauchte, die ihre Unternehmen zur Sponsorenrolle bewegen konnten (wie Adam und Rob Smith), und jemanden, der sich um Referenten k√ºmmern und die Veranstaltung in der Freie-Software-Community bekannt machen konnte ‚Äì und so kam es, dass ich (als Bewohnerin von Massachusetts) Mitbegr√ºnderin einer j√§hrlichen Veranstaltung in Seattle wurde.

[#image-seagl-crew]
.Die SeaGL crew. Von links nach rechts: Salt, Deb, Patch, (mit french fry), Adam, Rob. Nicht im Bild: Chris, Jesse, Bri, Lisa, and viele andere.
image::seagl-crew.jpg[align="center",scaledwidth=80%]

Die erste ((SeaGL)) fand 2013 am Seattle Central College statt und war ziemlich improvisiert.
Keine Keynotes, viele gemeinsam genutzte Mehrfachsteckdosen und ein paar Freund*innen, die hineingezogen worden waren, ohne genau zu wissen, worauf sie sich da eingelassen hatten.
Wir hatten bewusst einen Freitag gew√§hlt, um eventuell Studierende anzusprechen, solange der Campus ge√∂ffnet war, und einen Samstag, um den zweiten Tag f√ºr diejenigen zug√§nglich zu machen, deren Arbeitsstellen eine Teilnahme unter der Woche nicht unterst√ºtzten.
Die Veranstaltung war ‚Äì und ist bis heute ‚Äì kostenlos und offen f√ºr alle.

Adam tauchte bei unserer ersten Veranstaltung mit einem kleinen Stapel ‚ÄûPrint-on-Demand‚Äú-H√ºten und -T-Shirts auf, versehen mit unserem brandneuen Logo (nat√ºrlich eine seagull (eng. M√∂we).
Die Auswahl der Vortr√§ge lief nach dem Motto: ‚ÄûWenn du einen Vortrag halten willst, dann halt einen.‚Äú
Adam hielt gro√üartige Einf√ºhrungsvortr√§ge zu Git und Hadoop, und ich sprach √ºber politische Rahmenbedingungen und Community-Organizing.
Wir hatten es noch nicht schriftlich festgehalten, aber SeaGL war von Anfang an dazu bestimmt, eine Konferenz f√ºr Anf√§ngerinnen und Expertinnen zu sein, f√ºr Programmierer*innen und Politikbegeisterte, und f√ºr Vortr√§ge √ºber das gesamte √ñkosystem ‚Äì seine Schw√§chen, sein Potenzial und die Chancen zur Zusammenarbeit mit anderen Initiativen, die Menschen st√§rken wollen.

Nach dieser chaotischen ersten Ausgabe wurde uns klar: SeaGL sollte f√ºr alle sein ‚Äì aber ganz besonders f√ºr Menschen, die einen Einstieg in Open Quellesuchten, in einer vielf√§ltigen, teuren und technologiegetriebenen Region wie Seattle.
Wir wollten, dass SeaGL eine gro√üartige erste Tech-Konferenz f√ºr Teilnehmende wird und eine einladende Plattform f√ºr angehende Vortragende bietet.
Sp√§ter weiteten wir dieses Ziel aus und bem√ºhten uns gezielt darum, weniger bekannte Sprecher*innen zu finden und ihnen ihre erste Keynote-M√∂glichkeit zu bieten.
Das gesamte SeaGL-Team (einschlie√ülich Adam, nat√ºrlich!) war und ist mit voller Leidenschaft dabei, Neulinge willkommen zu hei√üen und eine freundliche, sichere und neugierige Atmosph√§re zu schaffen.

Adam und ich kennen uns schon seit vielen Jahren.
Ich habe seine Tochter kennengelernt, die die talentierte Illustratorin dieses Buches ist, und auch seine Frau, die klug ist und unerm√ºdlich neugierig darauf, wie Technologie unser Leben beeinflusst.
Sogar einige der H√ºhner habe ich getroffen ‚Äì sie sind tats√§chlich blitzsauber, wenn auch leider nicht besonders schlau.
Zum Gl√ºck werden sie √§u√üerst gut versorgt, sodass sie nicht allzu viel Grips brauchen.

Kurz gesagt: Adam ist sehr engagiert ‚Äì sowohl f√ºr Freie Software als auch daf√ºr, Menschen zu st√§rken.
Au√üerdem ist er unglaublich nett!
Wirklich einer der nettesten Menschen, die ich je getroffen habe.
Wenn dich die Vorstellung anspricht, etwas Herausforderndes mit einem geduldigen und einf√ºhlsamen Mentor anzugehen, und du neugierig auf das Thema Self-Hosting bist, dann ist dieses Buch genau das Richtige f√ºr dich.

Self-Hosting ist schwierig.
Ich selbst habe still Mailinglisten verfolgt, die versprachen, es einfach zu machen. Ich habe Vortr√§ge besucht, Videos geschaut und Artikel gelesen ‚Äì aber wirklich einfach wurde es nie.
Manche dieser Ressourcen fingen gef√ºhlt erst bei Kapitel 2 an, andere waren voller Kommentare, die einem das Gef√ºhl gaben, dass jede einigerma√üen intelligente Person die fehlenden Informationen schon irgendwie selbst finden m√ºsste.
Zum Gl√ºck hat Adam alles aufgenommen, was echte Anf√§nger*innen brauchen, um loszulegen ‚Äì und dabei trotzdem viele Wahlm√∂glichkeiten offengelassen.

Self-Hosting ist aber auch wichtig.
In der Technik ‚Äì und in der Welt insgesamt ‚Äì ver√§ndert sich vieles sehr schnell.
Was man kontrolliert und was nicht, ist st√§ndig im Wandel.
Self-Hosting gibt dir die M√∂glichkeit, ein paar Dinge in deiner eigenen Hand zu behalten ‚Äì deine pers√∂nlichen Daten, deine Medien und die Art, wie du mit deiner digitalen Umgebung interagierst.
Es erm√∂glicht dir, selbst zu entscheiden, was du brauchst, und selbst zu w√§hlen, wie du diesen Bedarf decken willst ‚Äì ohne um Erlaubnis zu fragen oder dich an ein Unternehmen zu binden, dem du als Individuum egal bist.

Du solltest dieses Buch lesen, es mit anderen teilen und vielleicht ‚Äì wenn du soweit bist ‚Äì etwas an die Self-Hosting-Community zur√ºckgeben.

--
Willkommen in der Welt des Self-Hosting,
--

[.big]#Deb Nicholson#

--
Gr√ºnderin, Seattle GNU/Linux Conference +
Gesch√§ftsf√ºhrerin, Python Software Foundation
--

:sectnums:

== Einf√ºhrung

(((Datensouver√§nit√§t)))
Datensouver√§nit√§t bedeutet, die volle Kontrolle √ºber die eigenen Daten zu haben.
Sie verspricht Privatsph√§re, Freiheit und Nachhaltigkeit.
Datensouver√§nit√§t zu verwirklichen ist sowohl spannend als auch praktisch ‚Äì und sie f√∂rdert ((prosoziales Verhalten)).
Self-Hosting (also das Betreiben eines eigenen Servers) ist ein hervorragender Weg zur Datensouver√§nit√§t.

Dieses Buch wird dir helfen, Self-Hosting effizient zu erlernen und in der Praxis anzuwenden.
Du wirst Selbstvertrauen im Umgang mit den damit verbundenen Herausforderungen gewinnen und die Vorteile aus erster Hand erleben.
Die F√§higkeiten, die du dir aneignest, sind sowohl zu Hause, am Arbeitsplatz als auch in deiner Gemeinschaft anwendbar.

=== Willkommen

Ich freue mich sehr dass du hier bist!

Ich m√∂chte dir dabei helfen, einen Server zum Laufen zu bringen.
Das Self-Hosting-√ñkosystem ist √ºberf√ºllt und oft verwirrend ‚Äì deshalb habe ich eine Reihe schwieriger Entscheidungen bereits f√ºr dich getroffen, basierend auf sinnvollen und erprobten Voreinstellungen.
Ich werde dir dabei helfen, deinen eigenen Server bereitzustellen (einzurichten) und einige n√ºtzliche Webdienste darauf zu installieren.
Bring mit, was auch immer du an Sysadmin-Erfahrung hast, ein paar motivierte Nutzer*innen ‚Äì und den Wunsch, dir echte Self-Hosting-Kompetenz anzueignen.

Das Internet ist oft ein unerbittlicher Kampf um Geld und Aufmerksamkeit.
Unser Verhalten wird endlos getrackt ‚Äì wir sind das Produkt.
Der Smog der √úberwachung erstickt unsere Freiheit und untergr√§bt das Vertrauen.
Wir werden:

* Uns nicht mit billigen ((Cloud))-Diensten zufriedengeben.
* Ablenkungen reduzieren.
* Unsere Aufmerksamkeit, Zeit und Freiheit wertsch√§tzen.
* Die klare, frische Luft geringerer √úberwachung atmen, indem wir selbst eine Alternative zum erschreckenden gesellschaftlichen Standard schaffen, Privatsph√§re gegen Bequemlichkeit zu tauschen.
* Geld sparen, indem wir viele Dienste effizient auf eigener Hardware betreiben ‚Äì mit kaum zus√§tzlichen Kosten.
* Gutes tun f√ºr unsere Freund*innen, Familien und sozialen Gruppen.
* Dinge tun, die mit √∂ffentlichen Diensten nicht m√∂glich sind, weil wir vollst√§ndigen Zugriff auf unsere Rohdaten haben.
* Uns anpassen und wachsen, wenn sich Software weiterentwickelt ‚Äì und dabei unsere Daten und Metadaten mitnehmen.
* Teilen, was und wann es sinnvoll ist ‚Äì mit den Menschen, denen wir vertrauen.

Dies ist das Buch, das ich mir gew√ºnscht h√§tte, als ich versucht habe, meinen Kindern ein sicheres Online-Erlebnis zu erm√∂glichen.

Neue Self-Hosterinnen k√∂nnen dieses Buch als Einstieg nutzen.
Erfahrene Self-Hosterinnen k√∂nnen meine Entscheidungen mit ihren eigenen vergleichen.

==== Voraussetzungen

Um das Beste aus diesem Buch herauszuholen, solltest du √ºber grundlegende Sysadmin-Erfahrung verf√ºgen. Dazu geh√∂rt die F√§higkeit, deinen Router und dein LAN (lokales Netzwerk) zu konfigurieren, Linux auf einem Computer zu installieren (im Folgenden als dein Server bezeichnet), dich per SSH (Secure Shell) mit deinem Server zu verbinden, Textdateien zu bearbeiten und Befehle auf dem Server auszuf√ºhren sowie Dateien zwischen deinem Server und anderen Ger√§ten zu √ºbertragen.

Falls dir eines dieser Konzepte nicht vertraut ist, hilft dir ein kurzer Abstecher zu deiner bevorzugten Suchmaschine oder ein Besuch bei einer lokalen Nutzergruppe sicher weiter.

Ich empfehle das Hosting auf Bare Metal (greifbarer, lokal betriebener Computer-Hardware), was einige Anforderungen an den physischen Standort deines Servers mit sich bringt.
Mehr zu den Details und Anforderungen von Bare-Metal-Hosting findest du im Abschnitt <<Hardware vorbereiten>>.

Zum Schluss noch einige bew√§hrte Vorgehensweisen, die du beim Lesen im Hinterkopf behalten solltest:

Dokumentiere alles, was du tust ‚Äì selbst wenn es nur f√ºr dein zuk√ºnftiges Ich ist.
Hole dir Unterst√ºtzung und bilde andere aus, indem du deine Dokumentation nutzt, um Wissen weiterzugeben.
Bleib fokussiert, mach Pausen, sei geduldig und achte auf deinen K√∂rper.
Bitte um Hilfe und fordere aktiv R√ºckmeldungen ein.
H√∂re auf deine Nutzer*innen, sammle Daten und passe dich entsprechend an.

=== Unterst√ºtze den Author

Ich habe dieses Buch aus nach jahrelanger Recherche mit eigenen Reseourcen  viel Unterst√ºtzung gro√üartiger Menschen geschrieben.
Siehe <<Danksagungen>> (gegen Ende des Buches).

Bitte https://selfhostbook.com/buy/[kaufe ein Exemplar] f√ºr dich selbst oder f√ºr jemand anderen ‚Äì besonders, wenn du m√∂chtest, dass ich in Zukunft weitere B√ºcher schreibe.

=== Textversion

Dieses Buch wurde am *{build_date_time}* mit `LANG` auf Einstellung `*{build_locale_lang}*` von der Quelle `{docname}{docfilesuffix}` mit Stand `{build_git_commit}`, Zweig `{build_git_branch}`, Makierung `{build_git_tag}`, mit *{build_os_release}* generiert.

=== Urheberrecht und Lizenz

_{doctitle}_ ist {copyright}.
Manche Rechte vorbehalten.

==== Vervielf√§ltigung dieses Buches

Dieses Buch steht unter der Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0) Lizenz.

image::cc-by-sa.svg[align="center"]

===== Sie d√ºrfen

Teilen::
  das Material in jede Format oder Medium vervielf√§ltigen und weiterverbreiten und zwar f√ºr beliebige Zwecke, sogar kommerziell.
Bearbeiten::
  das Material remixen, ver√§ndern und darauf aufbauen und zwar f√ºr beliebige Zwecke, sogar kommerziell.

_Der Lizenzgeber kann diese Freiheiten nicht widerrufen solange Sie sich an die Lizenzbedingungen halten._

//Share::

===== Unter folgenden Bedingungen...

Namensnennung::
  Sie m√ºssen angemessene Urheber- und Rechteangaben machen, einen Link zur Lizenz beif√ºgen und angeben, ob √Ñnderungen vorgenommen wurden.
  Diese Angaben d√ºrfen in jeder angemessenen Art und Weise gemacht werden, allerdings nicht so, dass der Eindruck entsteht, der Lizenzgeber unterst√ºtze gerade Sie oder Ihre Nutzung besonders.
Weitergabe unter gleichen Bedingungen::
  Wenn Sie das Material remixen, ver√§ndern oder anderweitig direkt darauf aufbauen, d√ºrfen Sie Ihre Beitr√§ge nur unter derselben Lizenz wie das Original verbreiten.
Keine weiteren Einschr√§nkungen::
  Sie d√ºrfen keine zus√§tzlichen Klauseln oder technische Verfahren einsetzen, die anderen rechtlich irgendetwas untersagen, was die Lizenz erlaubt.

===== Hinweise

Sie m√ºssen sich nicht an diese Lizenz halten hinsichtlich solcher Teile des Materials, die gemeinfrei sind, oder soweit Ihre Nutzungshandlungen durch Ausnahmen und Schranken des Urheberrechts gedeckt sind.

Es werden keine Garantien gegeben und auch keine Gew√§hr geleistet.
Die Lizenz verschafft Ihnen m√∂glicherweise nicht alle Erlaubnisse, die Sie f√ºr die jeweilige Nutzung brauchen. Es k√∂nnen beispielsweise andere Rechte wie Pers√∂nlichkeits- und Datenschutzrechte zu beachten sein, die Ihre Nutzung des Materials entsprechend beschr√§nken.


==== Kopiere auch den Code dieses Buches

Siehe <<Weitere Ressourcen>> f√ºr den Quellcode.
Der Quellcode umfasst zwei Originalwerke, die du kopieren, ver√§ndern und weitergeben darfst.
Zum einen das Buch selbst, inklusive des Codes zur Erstellung sch√∂n gesetzter Versionen.
Zum anderen ein Lernwerkzeug namens mario (siehe <<_mario>>).

Die Lizenz f√ºr s√§mtlichen originalen Quellcode im Zusammenhang mit diesem Buch ist die GNU AGPL (Affero General Public License), ver√∂ffentlicht von der Free Software Foundation, entweder in Version 3 der Lizenz oder (nach deiner Wahl) jeder sp√§teren Version.
Eine Kopie der AGPL ist in `mario/COPYING` enthalten.


=== Haftungsausschluss

Ich √ºbernehme keine Gew√§hrleistung und keine Garantie.
Der Kauf oder das Lesen dieses Textes stellt keine Vereinbarung √ºber Support dar.

Obwohl bei der Erstellung dieses Buches mit gr√∂√üter Sorgfalt vorgegangen wurde, √ºbernehme ich keine Verantwortung f√ºr Fehler oder Auslassungen sowie keine Haftung f√ºr Sch√§den, die aus der Nutzung des Codes oder der Inhalte entstehen.

Ich bin nicht beruflich mit den im Buch genannten Produkten verbunden und werde von den genannten Unternehmen nicht bezahlt.
Deren Urheberrechte, Marken und geistiges Eigentum geh√∂ren ihnen selbst.

Alle ge√§u√üerten Meinungen sind meine eigenen.

Ich beziehe mich in diesem Buch direkt auf viele Produkte und Unternehmen und teile meine konkreten, m√ºhsam gewonnenen Erkenntnisse √ºber ihre jeweiligen St√§rken und Schw√§chen.
Mein Ziel ist es, aufzukl√§ren und zu informieren.

Ich werde Abk√ºrzungen nehmen.
Ich beabsichtige nicht, jedes Thema vollst√§ndig und ersch√∂pfend zu behandeln.
Ich m√∂chte, dass du schnell zum Wesentlichen kommst ‚Äì und dann selbst entscheidest, ob, wann und wo du tiefer einsteigen m√∂chtest.

Wenn du Widerspr√ºche zu diesen Aussagen findest, gib mir bitte Bescheid.

Ich bin ein Mensch und mache Fehler.
Ich mache es dir leicht, Kontakt mit mir aufzunehmen, fehlende oder fehlerhafte Informationen zu melden ‚Äì und sie bei Interesse auch selbst zu verbessern.
Bitte tu das!
Siehe <<Weitere Ressourcen>> f√ºr Kontaktinformationen und Hinweise, wie du Verbesserungen teilen kannst.

=== Schreibstil

Textformattierung:

[cols="2,3",id=style]
.Typographical conventions
|===
|Styled example |Used for

|`zpool status -t` |Inline command, filename, username, password, or variable.
Longer snippets of console text use language-specific syntax highlighting.
|kbd:[Ctrl+c] |Key(s) pressed on the keyboard.
|https://example.com |Bare (un-named) link.
https scheme is assumed and omitted.
|https://example.com[Example domain] |Named link.
Full URL appears in print version.
|`\https://cloud.example.com` |Non-working example link.
Replace `.example.com` with your actual domain name.
|<<System Design>> |Cross-reference to another section or chapter.
|===

Hinweise:

NOTE: Hilfreiche oder erg√§nzende Informationen.

TIP: Hier ist ein praktischer Tip!

IMPORTANT: Etwas von besonderer Bedeutung.

CAUTION: Eine vorsorgliche Warnung.

WARNING: Eine konkrete Warnung vor m√∂glichen Problemen.

Seitenleisten:

****
Eigenst√§ndige oder erg√§nzende Inhalte werden visuell abgesetzt in einer Seitenleiste wie dieser dargestellt.
Seitenleisten k√∂nnen mit oder ohne Titel erscheinen.
****

Codeausschnitte:

.Beispiel-Codeausschnitt (üöÄ server)
[source#example-code-snippet,bash]
----
echo foo | sed s/foo/bar/
----

Titel von Codeausschnitten k√∂nnen angeben, wo der Code ausgef√ºhrt werden soll.
Wird kein Ort genannt, wird der oder die beabsichtigten Ausf√ºhrungsumgebungen im Text erkl√§rt.
In diesem Fall weist ‚ÄûüöÄ server‚Äú darauf hin, dass dieser Bash-Skript-Ausschnitt auf deinem Server ausgef√ºhrt werden soll.

== Hintergrund

Du denkst vielleicht: ‚ÄûDas ist aber ganz sch√∂n viel Hintergrundinformation!‚Äú
Und du hast recht.

Ich gehe hier absichtlich so ausf√ºhrlich auf den Hintergrund ein, weil ich beim Halten von Vortr√§gen √ºber Self-Hosting etwas Wichtiges festgestellt habe:
Menschen wissen, wie man lernt und unterscheidet ‚Äì aber sie w√ºnschen sich eine sinnvolle Motivation, sich wirklich auf das Lernen einzulassen.

Ich hoffe, dass du genau das hier findest.

=== Wer bin ich?

Ich bin Vater, Tech-Unternehmer und begeisterter Verfechter von FOSS (freier und quelloffener Software).
Ich liebe es, zu erziehen, zu sorgen, zu lachen, zu singen, zuzuh√∂ren, zu programmieren, zu bauen, zu gestalten, zu debuggen, zu entwerfen, zu f√ºhren, zu managen ‚Äì und noch mehr zu debuggen, zu lehren und zu schreiben.

Ich bin gut darin, Systeme und Prozesse zu verwalten und abzusichern, w√§hrend ich gleichzeitig Datenschutz, Compliance und Zuverl√§ssigkeit sicherstelle.

Am meisten stolz bin ich auf meine Familie, auf den Ausbau von https://mifos.org[Mifos], die Mitbegr√ºndung von https://seagl.org[SeaGL], den Verkauf von https://csats.com[C-SATS], und Buch geschrieben zu haben.

Ich betreibe seit Jahrzehnten meine eigenen Dienste.
Angefangen hat es mit einem Blog und einem Fotoalbum, die auf dem Rechner eines Freundes liefen.
Das Gef√ºhl von Freiheit und Kontrolle war elektrisierend ‚Äì und es unterst√ºtzte gleichzeitig meine Effektivit√§t bei der Arbeit.
Deshalb habe ich weitergemacht und viele meiner Dienste selbst betrieben ‚Äì wenn auch selten auf eigener Hardware.

Als ich eine Familie hatte, wuchsen unsere Anforderungen an Datenspeicherung und Funktionalit√§t.
Ein einfaches Netzlaufwerk und Datei-Synchronisation reichten nicht mehr aus.
Zu Beginn der Pandemie sa√üen wir alle zuhause fest ‚Äì und online.
Ich wurde skeptisch gegen√ºber Unternehmen, die aus dieser neuen Abh√§ngigkeit Kapital schlagen wollten.
Also begann ich, mehr zu Hause selbst zu hosten ‚Äì und stellte fest, wie √ºberraschend einfach, n√ºtzlich und unterhaltsam das sein kann.

Etwa zur gleichen Zeit entschloss ich mich, mich von Google zu l√∂sen (De-Googling).
Der Familienbedarf und mein Wunsch, Google zu meiden, passten hervorragend zusammen.
Self-Hosting war ein gl√ºcklicher Zufallstreffer.
Allein der Versuch, Google hinter sich zu lassen, war eine faszinierende und erf√ºllende Reise ‚Äì begleitet von zahlreichen Self-Hosting-Experimenten.

=== Warum habe ich dieses Buch geschrieben?

Ich habe dieses Buch geschrieben, um ((Datensouver√§nit√§t)) als prosoziales Verhalten zu f√∂rdern.
Dank Self-Hosting ist das heute einfacher denn je ‚Äì und ich wollte dieses Wissen in Buchform weitergeben.

Die bisherigen B√ºcher zu diesem Thema bieten keine gute, schnelle und g√ºnstige Methode, um Self-Hosting auf eigener Hardware ((Bare Metal)) umzusetzen.
Ich habe eine solche Methode gefunden ‚Äì und ich glaube, du wirst sie lieben.
Sie funktioniert √ºbrigens auch in der Cloud, kostet dort aber deutlich mehr (siehe <<Server>>).

Au√üerdem: Lernen macht Spa√ü.
Ich lerne beim Schreiben.
Als ich erforschte, wie mein Handy eigentlich funktioniert, wurde mir bewusst, wie wichtig es ist, zu verstehen, wie ‚Äûdie Cloud‚Äú funktioniert ‚Äì denn moderne Smartphones basieren stark auf Cloud-Diensten und -Daten.
Beim Versuch, mein Handy wirklich ‚Äûmein eigenes‚Äú zu machen (also so, dass es mir hilft, mein bestes Leben zu leben), kam mir die Idee, meine Daten in meiner eigenen Cloud zu hosten.

Fast alle Techies, die ich kenne, hosten irgendetwas selbst ‚Äì oft etwas, das ich noch nie geh√∂rt habe.
Es gibt immer einen neuen Self-Hosting-Dienst zum Ausprobieren, Lernen, Optimieren und Weiterempfehlen.

Ich wollte au√üerdem das Buch schreiben, das ich mir gew√ºnscht h√§tte, als ich mit Self-Hosting anfing.

Und: Es sollte einfach ein Buch dar√ºber geben.
Online findest du unz√§hlige Videos, Artikel und Code-Schnipsel, die alles in diesem Buch und mehr abdecken.
Viele davon sind gro√üartig.
Aber dieses Buch geh√∂rt dir ‚Äì zum Nachschlagen, Ausprobieren und Lernen.

Und: Es gibt eine auff√§llige L√ºcke zwischen einem n√ºtzlichen Einzelrechner und n√ºtzlichen ((Cloud-Diensten)).
Cloud ist leicht zu bezahlen ‚Äì aber die wahren Kosten sind verborgen: √úberwachung, Abh√§ngigkeit, Inflexibilit√§t.

Ich kann mir gut vorstellen, dass wir in Zukunft Datenger√§te f√ºr den privaten Haushalt besitzen werden, die Privatsph√§re wirklich respektieren ‚Äì so selbstverst√§ndlich wie heute ein K√ºhlschrank.
Solche Ger√§te wurden schon oft versucht und es wird immer wieder neue Versuche geben.
Bis sich ein solches Ger√§t durchsetzt, bleibt Self-Hosting ‚Äì also das Einrichten eines eigenen Servers und eigener Dienste ‚Äì eine hervorragende L√∂sung.


=== Warum dieser Titel?

==== Steadfast Self-Hosting

Ich mag das Wort _steadfast_ (_standhaft_).
Es erinnert mich an verl√§ssliche Dinge und Menschen.

(((Datensouver√§nit√§t)))
Der Schl√ºssel zu zuverl√§ssigem Self-Hosting ist Datensouver√§nit√§t.
Software wird sich √§ndern, Dienste werden sich √§ndern, du wirst dich √§ndern, und die Welt wird sich √§ndern.
Wenn deine Daten dir durch all diese Ver√§nderungen zuverl√§ssig dienen sollen, musst du die Kontrolle √ºber sie haben.

Es macht tats√§chlich einen Unterschied, eine eigene Kopie zu besitzen.
Du k√∂nntest den Zugriff auf etwas verlieren, das du vermeintlich ‚Äûgekauft‚Äú hast ‚Äì weil du es in Wahrheit nur gemietet hast.
Es k√∂nnte sich sogar direkt vor deinen Augen ver√§ndern.
Mehr dazu:

* https://kotaku.com/sony-ps4-ps5-discovery-mythbusters-tv-1851066164[PlayStation To Delete A Ton Of TV Shows Users Already Paid For] by Ethan Gach
* https://defectivebydesign.org/what_is_drm[What is DRM?] by the Free Software Foundation
* https://nytimes.com/2023/04/04/arts/dahl-christie-stine-kindle-edited.html[It's Their Content, You're Just Licensing it] by Reggie Ugwu

(((Quelleof truth)))
Das Speichern von Kopien von Daten, die jemand anderes f√ºr dich hostet, ist in Ordnung.
Self-Hosting geht einen Schritt weiter und verschafft dir weitreichende Kontrolle dar√ºber, wie deine Daten verwendet und geteilt werden.
Du erh√§ltst die Kontrolle √ºber autoritative Kopien deiner Dateien ‚Äì du wei√üt also, was die "Wahrheit" ist und kannst sie bestimmen.
Und das alles mit Zuverl√§ssigkeit und Flexibilit√§t zu einem vertretbaren Budget.

Self-Hosting bedeutet, Computerdienste von und f√ºr Einzelpersonen, Familien und Hobby-Anwender in SOHO-Umgebungen (Small Office / Home Office) bereitzustellen.

Vielleicht ist ‚ÄûHosting f√ºr kleine Gemeinschaften‚Äú sogar der treffendere Begriff.
Du liest auf jeden Fall das richtige Buch, wenn du Dienste f√ºr eine kleine Gemeinschaft bereitstellen m√∂chtest.

Zum Schluss noch ein Hinweis zur Terminologie:
In der Informatik ‚Äì insbesondere bei Compilern ‚Äì bezeichnet ‚ÄûSelf-Hosting‚Äú einen besonders sch√∂nen Meilenstein: n√§mlich wenn eine Programmiersprache sich selbst kompilieren kann.
An meine Freunde in den angrenzenden Disziplinen:
Es tut mir leid, dass ich den Begriff ‚ÄûSelf-Hosting‚Äú hier so frei √ºberlade, um ‚ÄûHosting f√ºr kleine Gemeinschaften‚Äú zu meinen.
Ihr hattet ihn zuerst ‚Äì ich leihe ihn mir nur aus und hoffe, dass unsere kontextuellen Fahrbahnmarkierungen Zusammenst√∂√üe verhindern.

==== Rapid-Rise Personal Cloud

_Rapid_ ist dazu da, dich zu motivieren, sofort einzusteigen und zu lernen
_Rapid_ bedeutet nicht gleich _r√ºcksichtslos_!
Ich setze mich entschieden f√ºr einen durchdachten und robusten Ansatz beim Self-Hosting ein.
Wenn du auf eine Herausforderung st√∂√üt, nimm dir Zeit ‚Äì so lernst du am Ende schneller.
Sobald du ein Konzept verstanden hast, √ºbe es.
Scheitere fr√ºh und oft ‚Äì mit schnellen Iterationen auf dem Weg zur Perfektion.

_Rapid-rise_ steht oft auf einer Packung Backhefe ‚Äì und ich liebe frisch gebackenes Brot.
Wenn dein Server also ein Laib Brot ist, dann ist dieses Buch deine Schnellhefe.

[#image-bread-server]
.Server in der Form eines Brots.
image::bread-server.png[align="center",scaledwidth=80%]

_Cloud_ bedeutet, dass es skalierbar und automatisierbar ist.
_Personal_ begrenzt diese Skalierbarkeit auf ein sinnvolles Ma√ü f√ºr eine kleine Gruppe.‚Äú
Ein ((Bare Metal)) Server kann innerhalb seiner eigenen Hardware bis zu einem gewissen Ma√ü skalieren
Es kann sich automatisch anpassen, indem es je nach ((Rechen-))Bedarf mehr oder weniger Leistung nutzt, und manuell, wenn man Hardware-Komponenten aufr√ºstet (zum Beispiel durch Hinzuf√ºgen einer weiteren Festplatte).‚Äù

Ich gebe zu, mein inneres Kind freut sich √ºber die Mehrdeutigkeiten des Begriffs _Personal Cloud_.

=== F√ºr wen ist dieses Buch??

Dieses Buch ist f√ºr Menschen, die freundlich zu anderen sind, mutig darin, Neues auszuprobieren, neugierig auf die M√∂glichkeiten des Self-Hostings und entweder unsicher, wie sie es angehen sollen, oder eifrig, ihr bestehendes Homelab (Self-Hosting-Setup) zu verbessern.

Dieses Buch ist f√ºr Menschen, die wissen wollen, wo ihre Daten leben, und in der Lage sein m√∂chten, allerlei Magie damit zu vollbringen.
Es ist ein ‚Äûvon Grund auf‚Äú oder ‚Äûder harte Weg‚Äú-Ansatz und h√§lt die T√ºren weit offen f√ºr viele M√∂glichkeiten mit einer prinzipientreuen Self-Hosting-Technik.
Manchmal berichte ich, was f√ºr mich funktioniert hat, anstatt konkret zu empfehlen, was du tun solltest.

Dieses Buch ist f√ºr Menschen, die neugierig auf FOSS sind oder diesem bereits zugeneigt sind.
Und ‚Äì so viel ich auch √ºber FOSS reden werde ‚Äì ich bin hier nicht, um zu urteilen.
Ich bin hier, um zu wachsen, vor allem durch Teilen und Lernen.

Dieses Buch ist f√ºr Studierende, insbesondere technikaffine oder techniknahe Studierende, die in Clubs und Teams aktiv sind.

Dieses Buch bietet Motivation f√ºr Self-Hosting und einen exzellenten Lernprozess daf√ºr.
Seine versionsspezifischen Inhalte werden voraussichtlich mit der Zeit veralten.
Seine Motivation und sein Lernprozess werden mit der Zeit immer relevanter.

Dieses Buch ist f√ºr diejenigen, die versuchen, mehr f√ºr andere und weniger f√ºr sich selbst zu leben; die selbstlos sind und dabei das ‚Äûselbstlos sein‚Äú genie√üen.
F√ºhrungskr√§fte, Eltern/Erziehungsberechtigte, Mitglieder einer Gemeinschaft oder einer kleinen Gruppe von Freunden.
Menschen, die Self-Hosting betreiben wollen, die auch andere lieben und neben der Systemadministration noch andere Dinge tun m√∂chten.
Ich werde dir wertvolle Zeit f√ºr diese anderen Dinge sparen, w√§hrend ich die Sysadmin-Anteile unterhaltsam gestalte.

√Ñhnlich wie bei ‚Äûsmall community hosting‚Äú w√§ren _Small Group Cloud_ passendere Bezeichnungen als _Personal Cloud_.
_Small group_ (Kleingruppe) ist eine gro√üartige Zielgr√∂√üe f√ºr das, was du erschaffen wirst.
Ich w√ºrde mir die M√ºhe nicht machen, das alles nur f√ºr mich selbst zu tun.

Dieses Buch richtet sich an Menschen, die sich f√ºr Self-Hosting interessieren oder daran interessiert sind, damit zu beginnen.
Es ist darauf ausgelegt, die n√ºtzliche, sichere und schnelle Einrichtung eines einzelnen Bare-Metal-Servers mit vielen Diensten zu unterst√ºtzen.

Dieses Buch ist f√ºr Menschen, die _de-Google_, _de-iTunes_, _de-OneDrive_, _de-Dropbox_, _de-Wasauchimmer_ machen m√∂chten.

=== Was ist dieses Buch _nicht_?

Dies ist kein umfassender Leitfaden zum Thema Self-Hosting.
Ich werde nicht versuchen, die endlosen M√∂glichkeiten aufzulisten, wie man Hardware, Betriebssysteme, Isolierungstechniken und Dienste kombinieren kann.
Dieses Buch richtet sich an den kleinen Ma√üstab.
Suchen Sie anderswo nach:

* Hochverf√ºgbarkeit
* Enterprise-Sicherheit
* N+1-Redundanz
* Verwaltung vieler Rechner
* Clustering
* Single Sign-On
* Erweiterte √úberwachung und Zentralisierung von Metriken
* Einhaltung gesetzlicher Vorschriften
* Erkennung und Abwehr von Eindringlingen/Bedrohungen
* Tiefgehende Sicherheitsh√§rtung
* Betrieb eines eigenen Container-Registrierung
* 100 % Offline- / autarkes Self-Hosting

TEs gibt einige Themen wie diese, die ich √ºberspringen oder nur kurz behandeln werde.
Jedes einzelne dieser Themen ist eine ganze Branche, ein weiteres St√ºck Hardware, eine Einstellung an deinem Heimrouter, eine potenzielle Karriere, keines oder alles davon ‚Äì und auf jeden Fall eine √úberlegung wert.
Du kannst und solltest dir ihrer bewusst sein.
Falls du das Gef√ºhl hast, dass ich etwas, das f√ºr meine Methode des Self-Hostings kritisch relevant ist, komplett ausgelassen habe, lass es mich bitte wissen.

Dieses Buch richtet sich nicht an diejenigen, die bereits mit umfangreichen Ressourcen alles umgesetzt haben.
Wenn du 50.000 Dollar und unbegrenzt Zeit hast, um deinen Betonbunker-Homelab einzurichten ‚Ä¶ nun, darf ich eine F√ºhrung haben?
Ich w√ºrde das wirklich gern sehen.
Wenn du eher neugierig als sicher bist, kannst du trotzdem Spa√ü daran haben, aus meinen Entscheidungen zu lernen.

Ich schreibe nicht, um es hartgesottenen Software-Patent- und Lizenz-Aktivisten recht zu machen.
Diese gro√üartigen Menschen werden meine absichtliche Verwendung des Wortes _open_ (_offen_) und das Weglassen des Wortes _libre_ (_frei_) sofort bemerken.
Ich liebe all diese Begriffe, ich stimme zu, dass Worte wichtig sind, und ich stehe auf der Seite der Inklusion ‚Äì auch wenn das Idealismus kosten kann (wobei ich hoffe, dass diese Konzepte sich nicht ausschlie√üen).
Ich danke den Aktivisten daf√ºr, dass sie geholfen haben, die Nadel in Richtung Freiheit zu bewegen ‚Äì zu unserem aller Nutzen.

Dieses Buch ist kein Manifest f√ºr immer und ausschlie√ülich Self-Hosting.
Es ist vollkommen in Ordnung, einige Dienste selbst zu hosten und f√ºr andere zu bezahlen.
Du wirst deine eigene Checkliste entwickeln, was du wann selbst hosten m√∂chtest.
Meine fokussiert darauf, mir und meiner Familie eine n√ºtzliche, verl√§ssliche und zukunftssichere Cloud bereitzustellen.

Dieses Buch ist nicht der schnellste Weg, um Webdienste auszuprobieren.
F√ºr viele Projekte findest du meist Demo-Instanzen im Netz.
Es gibt Cloud-Anbieter, die einen Dienst f√ºr dich betreiben und deine Daten hosten.

Siehe auch: <<Alternativen zu mario>>.

=== Wie Buch schreiben?

Wieso sprichst du wie ein H√∂hlenmensch?

(((Vim)))
Ich habe das Buch urspr√ºnglich in Markdown-Klartext in meinem zuverl√§ssigen Texteditor geschrieben, https://www.vim.org[Vim].
(((Pandoc)))
Ich habe gro√üz√ºgige Mengen an https://pandoc.org[Pandoc], Zeit, and Liebe angewandt.
Pandoc ist ein fantastisches FOSS-Tool, das es mir erm√∂glichte, diese einzelne Klartextdatei mit gut lesbarem Markdown Satzbau zu verwenden, um mehrere unterschiedliche, ansprechende Outputs zu erzeugen.
Beim √úberarbeiten bin ich auf das Build-System von https://github.com/progit/progit2[Pro Git 2] gesto√üen. (Danke an Scott und Ben!).
Kurz gesagt habe ich das Buch auf https://asciidoc.org[AsciiDoc] umgestellt und meinen Satzcode auf https://asciidoctor.org[Asciidoctor] portiert.
Das vereinfachte den Bucherstellungsprozess und erm√∂glichte mir mehr und bessere Output-Formate.

TIP: Schau dir den Quellcode an ‚Äì du bist herzlich eingeladen, ihn zu bearbeiten und anzupassen.
Siehe <<Weitere Ressourcen>>.

Ich habe versucht, so viel wie m√∂glich auf Standard-FOSS-Software zur√ºckzugreifen und nur minimal anzupassen.
Das hat mir geholfen, mich auf den Inhalt zu konzentrieren und das Buch einfach genug zu halten, um es selbst zu ver√∂ffentlichen.

==== Wann Buch schreiben?

Immer noch mit dem H√∂hlenmenschen.
Reicht jetzt aber.
Ich habe dieses Buch 2023 geschrieben.
Und h√∂r zu, selbst wir gesegneten H√∂hlenbewohner sollten dem Selbst-Hosting eine Chance geben.
Wir schaffen das!

==== Wo?

Seattle.

==== Hey.

Zugegeben, die letzten paar Abschnitte existieren nur, damit ich alle https://de.wikipedia.org/wiki/Fragetechnik#Offene_W-Fragen_in_der_Praxis[5 Ws] (wer, was, wann, wo, warum) abdecken und das ‚ÄöH√∂hlenmenschen‚Äò-Gimmick einbauen kann.

=== Eine Anmerkung zu FOSS

(((FOSS, author's bias towards)))

Ich bevorzuge FOSS gegen√ºber nicht-FOSS.
Das kann ein polarisierendes Thema sein.
Allein schon der Gebrauch des Begriffs FOSS statt anderer Varianten kann kontrovers sein.
Aber das alles sind nur Ablenkungen.
Gerade heute brauchen wir Kompromissbereitschaft, Geduld und Freundlichkeit.
Neugier statt Gewissheit.

Hier ist mein Versprechen an dich, lieber Leserin:

Ich werde versuchen, nicht zu sehr zu predigen.

Ich werde _praktische_ L√∂sungen _idealistischen_ vorziehen.
Manchmal werde ich das nicht schaffen ‚Äì besonders wenn es um FOSS geht.
Am deutlichsten zeigt sich das darin, dass ich in diesem Buch nicht-FOSS-Alternativen kaum erw√§hne.

Ich kenne die Spannung zwischen praktischen und idealistischen L√∂sungen, und ich glaube, dass diese Spannung etwas Gutes ist ‚Äì weil sie uns dazu bringt, kritisch zu √ºberlegen, welche ((Cloud))-Dienste wir nutzen sollten, und nicht nur, welche wir nutzen k√∂nnen.
Das ist eine kurze √úberlegung wert.

Unsere Daten sind wichtig, und unsere pers√∂nlichen Entscheidungen ebenso.
Ihre Auswirkungen betreffen auch die Gruppen, zu denen wir geh√∂ren ‚Äì ebenso wie die Chance auf Verbesserung.

Ich glaube, dass selbstgehostetes ((FOSS)) machbar ist und viele praktische Vorteile gegen√ºber nicht-FOSS bietet.

Halte durch und gib mir R√ºckmeldung.
Du wirst deinen eigenen Mittelweg zwischen Idealismus und Pragmatismus finden, und ich bin gespannt, wo du am Ende landest.

== Deine Reise

Die stetigen Fortschritte in Hard- und Software machen Self-Hosting heute einfacher und g√ºnstiger denn je.
Und in einem entscheidenden Punkt deutlich komplexer: F√ºr Einsteiger gibt es eine √ºberw√§ltigende Anzahl an Entscheidungen zu treffen.

Halte durch.
Ich helfe dir, die Auswahl einzugrenzen, indem ich dir gezielte und praxisnahe Empfehlungen gebe.

Mach dir nicht zu viele Sorgen √ºber einzelne Entscheidungen.
Deine pers√∂nliche Cloud ist formbar.
Tausche nach Belieben Komponenten aus.
Wenn du dich mal falsch entscheidest, triff einfach eine neue Entscheidung ‚Äì idealerweise basierend auf Metriken und tats√§chlichen Nutzerbed√ºrfnissen.

Du bist keine Versagerin, wenn du nicht gleich beim ersten Mal alles richtig machst.

Es ist v√∂llig in Ordnung, langsam von dem umzusteigen, was du derzeit nutzt.
Du musst nicht alles auf einmal umkrempeln.

Es ist auch v√∂llig in Ordnung, gar nicht umzusteigen und dieses Buch nur zur pers√∂nlichen Weiterbildung und zum Experimentieren zu nutzen.

Und es ist okay, wenn du nicht perfekt nach deinen oder den Idealen anderer lebst.
Halte an deinen Werten fest, w√§hrend du sie gleichzeitig hinterfragst und weiterentwickelst.
Genie√üe deine Reise.

=== Warum du deine Software selbst hosten solltest

Frag dich ruhig noch einmal ‚Äì wie man es tun sollte ‚Äì warum zur H√∂lle sollte √ºberhaupt jemand Software-Dienste selbst hosten?
Es gibt so viele gute Gr√ºnde!

* Flexibilit√§t
** nur die Dienste ausf√ºhren, die du und deine Nutzer*innen wollen
** mehrere Dienste nutzen, die denselben Datenspeicher verwenden
** automatisiere, was du willst, wann du willst
** unbegrenztes Teilen
** unbegrenztes Streaming
** unbegrenzte Auswahlm√∂glichkeiten
* Spa√ü!
** lernen und wachsen
** Self-Hosting ist eine machbare Herausforderung
** passende R√§tsel l√∂sen, w√§hrend du lernst und dich verbesserst
** Teil der florierenden Self-Hosting-Community sein
* Zukunftssicher sein
** deine Nutzer*innen von den unvorhersehbaren √Ñnderungen propriet√§rer Produktpreise, Serviceangebote und UI/UX abschirmen
** deine hart erarbeiteten Daten mit Freunden und Familie teilen ‚Äì f√ºr immer
** problemlos auf etwas anderes migrieren, wenn n√∂tig (zum Beispiel, wenn ein neuer/besserer Fotoserver verf√ºgbar wird)
** es sind wirklich die Daten, die gesch√ºtzt werden m√ºssen; die Frontends zu diesen Daten (Dateiviewer, Editoren usw.) werden sich √§ndern, wenn du es entscheidest
* Computing demokratisieren
** selbstgehostete Software (insbesondere FOSS) erm√∂glicht Daten- und Rechenautonomie
* Strom sparen
** der Energieverbrauch im Cloud-Backend pro Ger√§t sinkt drastisch bei wenigen Nutzern
** je mehr Nutzer, desto mehr Stromersparnis
** siehe verlinkte Artikel in <<Server>>
* Geld sparen
** selbstgehostete Hardware ist in der Regel g√ºnstiger als die Cloud (also gemietete Dienste)
** Einsparungen steigen, wenn der Speicherbedarf deiner Nutzer*innen in den Terabyte-Bereich geht
** spare mehr mit jedem weiteren Dienst, den du betreibst
** unerwartete Kosten bei Public-Cloud-Anbietern vermeiden
*** Egress-Geb√ºhren machen es teuer, deine Daten herunterzuladen und umzuziehen
*** vergisst man, eine VM (virtuelle Maschine) zu stoppen, kann es schnell teuer werden
*** du k√∂nntest √ºberm√§√üig viel Zeit und Geld damit verbringen, dich durch das verwirrende Service-Men√º der Public Cloud zu k√§mpfen
** unerwartete √Ñnderungen bei Public-Cloud-Anbietern vermeiden
*** √Ñnderungen bei Lizenzgeb√ºhren
*** √Ñnderungen bei Nutzungsgeb√ºhren
*** √Ñnderungen bei Supportkosten
*** √Ñnderungen im Serviceangebot
** nahezu keine zus√§tzlichen Kosten f√ºr weitere Nutzer und Dienste
* Geschwindigkeit / Zeit sparen
** ein lokaler Server kann deutlich bessere Reaktionszeiten haben, vorausgesetzt, die Hardware ist angemessen und die Dienste gut konfiguriert
** lokale Daten ("data locality") bedeuten, dass du keine Rundreisen zu Rechenzentren anderer machen musst, um zu experimentieren
** gemeinsamer Speicher erlaubt es dir, deine Daten √ºber mehrere Dienste bereitzustellen, mit sinnvoll definiertem Lese-/Schreibzugriff
* Vendor Lock-in vermeiden
** du kannst Softwarefunktionen nutzen, die Public-Cloud-Anbieter nicht anbieten oder die es dort noch nicht gibt, da du vollst√§ndigen Zugriff auf deine Rohdaten hast
** wenn du etwas mit DRM kaufst, besitzt du es nicht wirklich
** gibt es eine Integration, auf die du dich verl√§sst? Manchmal funktioniert ein Dienst nicht mehr mit einem anderen. Das passiert bei FOSS seltener, weil jeder ein Projekt einfach forken (kopieren, √§ndern und teilen) kann.
* Privatsph√§re
** den abschreckenden Effekt der Massen√ºberwachung vermeiden
** mit einer pers√∂nlichen Cloud kannst du GPS-Breitengrad und -L√§ngengrad sicher in deinen Fotometadaten behalten
** sobald du deine Standortdaten speicherst, kannst du kreative Dinge damit tun
** wenn du deine Position und dein Verhalten nicht st√§ndig mit Google teilen musst, warum tust du es?
** entferne dich aus der Gleichung der Nutzeranalyse ‚Äì wenn du ein Video √ºber einen fremden Dienst streamst, wissen sie und analysieren jedes Mal, wenn du (oder deine Kinder) ein Video, das du "besitzt", (erneut) ansiehst, zur√ºckspulst, vorspulst, pausierst... aber m√ºssen sie das wissen? warum?
* Neue M√∂glichkeiten erschlie√üen
** beliebige Workflows auf hochgeladene Dateien anwenden
** vertrauensw√ºrdige, offline-f√§hige generative KI-Modelle einsetzen
** Funktionen genie√üen, die es in √∂ffentlichen Diensten nicht gibt

=== Warum du deine Software nicht selbst hosten solltest

Self-Hosting ist komplexer und zeitaufwendiger als das Bezahlen f√ºr die gleiche Funktionalit√§t ‚Äì besonders am Anfang.
Es erfordert Disziplin und Geduld, wie das Erlernen eines neuen Instruments (aber dieses Instrument spielt irgendwann von selbst!).

Wenn etwas kaputtgeht, bist du die Person, die es repariert.
Manchmal bekommst du eine hilfreiche Fehlermeldung, manchmal findest du im Web eine schnelle L√∂sung.
Manchmal bekommst du keine ‚Äì und kannst auch keine finden.

CAUTION: Wenn dir Fehlersuche und Debugging keinen Spa√ü machen, ist Self-Hosting vielleicht nichts f√ºr dich.

Wenn du nicht sorgf√§ltig mit ((Backups)) und Sicherheit umgehst, riskierst du Zeit, Energie und das Vertrauen von Menschen, die dir wichtig sind.

(((HVAC)))
Self-Hosting vor Ort bringt zus√§tzliche physische √úberlegungen mit sich.
Du musst f√ºr ausreichende Stromversorgung, Konnektivit√§t, HVAC (Heizung, L√ºftung und Klimatisierung) und Sicherheit sorgen.
Stell deinen Server einfach nicht drau√üen ab.

== Praktische Beispiele

Ich verwende t√§glich viele verschiedene Softwaretools.
Ich muss etwas nachschlagen, eine Fahrt organisieren, Essen kaufen und so weiter.
Viel von dieser Software ist leider ziemlich nervig!
Sie scheint immer mehr von meiner Zeit, Aufmerksamkeit und meinem Geld zu wollen ‚Äì dabei will ich doch nur das praktische Ergebnis erreichen, bei dem sie mir angeblich helfen soll.
Deshalb vertraue ich ihr immer weniger und √ºberlege st√§ndig, wie ich sie durch etwas ersetzen kann, das ich lieber mag und dem ich mehr vertraue.

Hier sind ein paar Beispiele, bei denen ich einen √∂ffentlichen Dienst durch eine selbstgehostete L√∂sung verbessert habe ‚Äì gefolgt von einigen √úberraschungen, auf die ich dabei gesto√üen bin.

=== Criminal chickens

Meine Familie hat ein selbstgebautes Sicherheitssystem f√ºr unsere H√ºhner, und die Videos sind mir wichtig.
Fr√ºher habe ich sie einfach auf YouTube hochgeladen, weil hey, es ist kostenlos und es ‚Äûfunktioniert einfach‚Äú, oder?

Au√üer wenn es das nicht tut.
YouTube fand manchmal, dass meine H√ºhner Spam und/oder Betrug seien.

[#image-YT-censor]
.Screenshot einer E-Mail vom YouTube-Content-Team, welches mein Video von der H√ºhnerstall-Kamera entfernt hat.
image::YT-censor.png[align="center",scaledwidth=80%]

Nur f√ºrs Protokoll: Unsere H√ºhner sind _blitzsauber_.

[#image-squeaky-clean-chicken]
.Eine absolut rechtschaffene, flei√üige, gesetzestreue Henne.
image::squeaky-clean-chicken.png[align="center",scaledwidth=50%]

Als ich meine pers√∂nliche Cloud eingerichtet hatte, f√ºhlte ich Freiheit und Leichtigkeit beim Posten und Hosten dieser Videos.
Ich musste keine YouTube-Formulare mehr ausf√ºllen, nur um meine H√ºhner im Blick behalten zu k√∂nnen.
Ich kann deren Pr√ºfung und die f√§lschliche Behauptung eines Richtlinienversto√ües nun getrost ignorieren.

[#image-YT-audit]
.Screenshot einer YouTube-Rechtspr√ºfung f√ºr meinen alten API-Client.
image::YT-audit.png[align="center",scaledwidth=80%]

Ich muss auch nicht mehr mit der YouTube-API (Application Programming Interface) arbeiten, einschlie√ülich der Registrierung eines API-Clients und der Durchf√ºhrung regelm√§√üiger Pr√ºfungen.
Nachdem ich Nextcloud eingerichtet hatte, habe ich meinen YouTube-API-Client zum Hochladen von Videos gel√∂scht, meinen Code bereinigt und die Wartung vereinfacht.
Es stellt sich heraus, dass die Nextcloud Talk API sowieso einfacher ist, um Fotos und Videos von meinem H√ºhnerstall zu posten.

Mit meiner eigenen Cloud kann ich auch Quoten und Geschwindigkeitsbegrenzungen nach Belieben anpassen.
Volle Fahrt voraus!

=== Fotosuche nach Standort

Hier ist noch ein Beispiel, das f√ºr eine pers√∂nliche Cloud spricht.
Dieses hat funktioniert, weil ich es gewohnt bin, Standort-Metadaten in meinen selbstgehosteten Fotos zu speichern.

Vor einiger Zeit wollte ich bestimmte Fotos aus einem Haufen von Tausenden finden, die mehrere Terabyte Speicherplatz belegten.
Ich wusste, wo ich war, als ich die Fotos gemacht habe (auf etwa 10 Meilen genau), aber ich konnte mich nicht erinnern, wann sie aufgenommen wurden.

Meine Fotos sind einfach eine Sammlung von JPEG-Dateien.
Ich habe sie mit einem kleinen Python-Programm untersucht, das ich selbst geschrieben habe.
Ich suchte nach allen Fotos, die im Umkreis von 10 Meilen um den Punkt aufgenommen wurden, den ich kannte.
Der Schl√ºssel war, direkt und schnell auf die Daten zugreifen zu k√∂nnen.

Das ist nur ein (wahrscheinlich bald veraltetes) Beispiel.
Wenn du das hier liest, kannst du deine Fotos vielleicht schon mit einem Satz wie ‚ÄûZeig mir alle Fotos, die im Umkreis von 10 Meilen um Mexiko-Stadt aufgenommen wurden‚Äú abfragen ‚Äì und es funktioniert einfach.

Dann kannst du dich der Rettung der Welt widmen.
Stell nur sicher, dass du deine Daten hast!

=== √úberraschungen

Falls du dich entscheidest, weiterzumachen: gute Reise, Reisende*r.
Das hier macht wirklich Spa√ü.

Du wirst vielleicht √ºberrascht sein, wie schnell und einfach manche Dinge beim Self-Hosting funktionieren.
Ich w√ºrde zu gern erfahren, wie es bei dir l√§uft.

Du wirst vielleicht aber auch √ºberrascht sein, wie zeitaufwendig und schwierig manche Dinge sein k√∂nnen.
Vielleicht h√§ngst du an der Hardware fest (und deren Stromversorgung, Verkabelung, K√ºhlung, Ausf√§llen).
Vielleicht am Netzwerk.
Vielleicht am ‚ÄûChange Management‚Äú (deine Nutzer*innen davon zu √ºberzeugen, Nextcloud statt Dropbox zu verwenden).

Hier sind einige Dinge, die mich √ºberrascht haben ‚Äì im Positiven wie im Negativen.

==== Gute √úberraschungen

===== Hardware war gar nicht so schwierig

Mit Hilfe eines Freundes (danke, Rob!) habe ich einen zuverl√§ssigen und g√ºnstigen, general√ºberholten Server gekauft.
Ich dachte, ich m√ºsste an Kabeln, Karten und CMOS-Batterien herumbasteln.
Aber nein!
Ich habe das Geh√§use ge√∂ffnet, um einen Blick ins Innere zu werfen.
Ich konnte best√§tigen: ganz normale Server-Innereien ‚Äì oder zumindest nah genug dran.
Die CPUs und RAM-Riegel waren wie angek√ºndigt vorhanden.

Ich habe ihn eingesteckt ‚Äì und er hat funktioniert.

[#image-inside-chassis]
.Blick ins Innere des Servers mit zwei leeren PCI-E-Steckpl√§tzen.
image::inside-chassis.jpg[align="center",scaledwidth=80%]

===== Containers == happy

(((Docker)))
Ich war angenehm √ºberrascht von ((Container))s (erkl√§rt in <<Contained services>>), insbesondere nach meinen gemischten fr√ºheren Erfahrungen mit VMs.
VMs sind anfangs einfach, weil sie sich wie echte Hardware verhalten.
Linux in eine VM zu installieren ist genauso einfach wie auf ((Bare Metal)) (manchmal sogar einfacher).
Dann kann man einen oder mehrere Dienste in der VM einrichten.
Der eigentliche Haken liegt in der Wartung:
Das Pflegen einer VM kann genauso aufwendig sein wie die Wartung eines Bare-Metal-Servers.

Container verfolgen einen anderen Ansatz und simulieren deutlich weniger von einem Bare-Metal-Server.
Sie sind im Vergleich zu VMs schneller und ressourcenschonender, was eine h√∂here, konfliktfreie Dichte von Diensten erm√∂glicht.
Das hei√üt: Du kannst mehr Dienste pro Server betreiben, ohne dass sie sich gegenseitig st√∂ren (z.B. weil sie unterschiedliche Versionen von PHP ben√∂tigen).
Ein Container enth√§lt in der Regel genau einen Dienst.

(((Isolation)))
Die Isolierung von Containern ist im Vergleich zu VMs begrenzt.
Zum Beispiel wird der Kernel (der Teil des Betriebssystems, der direkt mit der zugrunde liegenden Hardware kommuniziert) gemeinsam genutzt.
Diese begrenzte Isolierung h√§lt jedoch die Ressourcen- und Wartungskosten bei containerbasierter Isolierung deutlich niedriger als bei VMs.

Container eignen sich hervorragend f√ºr eine konsistente und stabile pers√∂nliche Cloud.
Sie lassen sich leicht deklarieren (im Code), bauen, bereitstellen, testen und reproduzieren.
Container k√∂nnen auch zusammen mit VMs verwendet werden: Du k√∂nntest zum Beispiel eine VM als Server nutzen, anstelle von Bare Metal.

Ich habe mich f√ºr Docker zur Verwaltung von Containern entschieden, weil es weit verbreitet ist und ich Erfahrung damit habe.
Dein Server wird dabei auch als Host bezeichnet, da er die Docker-Container hostet.

Ein Nachteil von Docker ist, dass in Beispielcode und √∂ffentlichen Images oft Root-Zugriff vorausgesetzt wird.
Das Ausf√ºhren als `root` vereinfacht Container zwar, macht sie aber auch unsicherer.

===== Papierlos mit OCR

Eine weitere fortschrittliche Entwicklung, die ein L√§cheln wert ist, ist kostenlose OCR (optocal character recognition/ optische Zeichenerkennung).
Ich versuche immer wieder, ‚Äûpapierlos zu werden‚Äú, indem ich all meine Papierdokumente einscanne.
Nach dem Scannen bleibe ich ‚Äì wenig √ºberraschend ‚Äì mit einem Haufen PDF-Dateien voller Bilder zur√ºck.
(((Paperless-ngx)))
Diese lassen sich ganz einfach mit Tools wie https://docs.paperless-ngx.com/[Paperless-ngx] und https://apps.nextcloud.com/apps/fulltextsearch[Nextcloud Full text search]  per OCR verarbeiten und verwalten.

===== Jellyfin funktioniert gut

((Jellyfin)) ist ein pers√∂nlicher Streaming-Medienserver.
Ich war begeistert zu sehen, wie Jellyfin sich als ausgezeichnete und vollst√§ndige FOSS-Alternative zu ((Plex)) herausgestellt hat.

==== Schlechte √úberraschungen

===== Traefik-Lernkurve

Der ((Traefik))-Reverse-Proxy war √ºberraschend herausfordernd einzurichten, da meine Netzwerkgrundlagen etwas eingerostet waren.
Ich habe ihn nun zuverl√§ssig zum Laufen gebracht, muss aber mein grundlegendes Netzwerkwissen weiterhin verbessern.
Siehe <<Reverse-Proxy>> f√ºr mehr Informationen √ºber Traefik.

===== Nextcloud Bugs

(((Nextcloud, surprises with)))
Ich war frustriert √ºber einige Probleme in Nextcloud.
Diese f√ºhlten sich besonders dringend an, da ich stark darauf angewiesen bin.

Der Community-Support ist mal gut, mal weniger gut.
Nextcloud scheint au√üerhalb der USA popul√§rer zu sein.

Nicht alle Nextcloud-Apps sind schon ausgereift.
Mehr unter <<Personalisierung>>.

===== Jitsi and Ports

((Jitsi)) ist eine selbstgehostete FOSS-Videokonferenzplattform.
Ich habe aufgegeben, Jitsi in Docker zum Laufen zu bringen.
Ich erinnere mich, dass viele offene Ports oder Portbereiche ein Problem waren.
Dieser Dienst k√∂nnte leichter in einer virtuellen Maschine selbst gehostet werden.

Es gibt auch eine Umgehungsl√∂sung, bei der Portbereiche bestimmten IP-Adressen zugewiesen werden, aber das geht √ºber den Umfang dieses Buches hinaus.
Ich werde es irgendwann nochmal versuchen, weil https://jitsi.org/blog/authentication-on-meet-jit-si/[logging in is now required when using the free 8x8-hosted Jitsi service].

==== Nimm sie alle auf

Wenn es um √úberraschungen geht, versuche die schlechten zu verkraften, wenn sie deine Nutzer betreffen.
Im Idealfall _bevor_ sie deine Nutzer betreffen, durch Recherche, Planung und Tests, die du wahrscheinlich schon machst.

(((dogfooding)))
Nutze selbst, was du selbst hostest.

Gib dein Bestes, um alles attraktiv und n√ºtzlich zu gestalten, und warte dann ab.
Sei geduldig.
Versuche niemals, Menschen zu zwingen, das zu nutzen, was du selbst hostest.

Ich hoffe, dieses Buch inspiriert dich mit vielen positiven √úberraschungen und hilft dir und deinen Nutzern, viele negative zu vermeiden.

== Planung

Wir werden jetzt kurz die wichtigsten Punkte eines Selbsthosting-Plans durchgehen.
Ich liebe diesen Teil!
Ich freue mich auf das, was kommt, und ich wei√ü, dass ein solider Plan eine Vision Wirklichkeit werden l√§sst.

Mach _deinen_ Plan.
Pflege und verbessere deinen Plan gemeinsam mit deinem Server.
Teile den Plan mit anderen Administrator*innen.

Ja, anderen Administrator*innen.
Du brauchst jemanden, der dich vertreten kann, wenn du nicht verf√ºgbar bist, oder eine glasklare Erwartung, dass der Server mit dir stirbt.

=== Budget

Ber√ºcksichtige die Zeit und die Kosten des Selbsthostings ‚Äì f√ºr dich selbst _und deine Nutzer*innen_.
Wie viel hast du zur Verf√ºgung und wie viel m√∂chtest du ausgeben? Schreib eine Zahl auf und halte dich daran.

=== Ressourcen

Skizziere deine Gedanken zu den Ressourcen, die du ben√∂tigen wirst.
Einige Ideen:

Rechenleistung und Speicher::
Hauptprozessor und RAM sind die grundlegenden Ressourcen, die f√ºr die Berechnung notwendig sind.
Siehe <<Dienste Ressourcen zuordnen>> f√ºr Ideen, wie du Anforderungen basierend auf den Diensten, die du hosten wirst, absch√§tzen kannst.
Grafikprozessor-Arbeitslasten werden in diesem Buch nicht behandelt, obwohl <<_wie_gehts_weiter>> und <<√úbungen>> einige Dinge ansprechen, die du selbst ausprobieren kannst.

Datenspeicher::
Sch√§tze, wie viel Speicherplatz du ben√∂tigen wirst.
Mit jedem Sprung in der Einheit (zum Beispiel von GB (Gigabyte) zu TB (Terabyte)) steigt die Komplexit√§t und die Kosten deutlich an.
Dieses Buch ist f√ºr Datenspeicher bis etwa 10 TB geeignet.
Siehe <<Festplattenlaufwerke>> f√ºr Tipps, wie du beim Speicher durch Self-Hosting Geld sparen kannst.

Strom::
√úberpr√ºfe deine Stromrechnung auf die Kosten pro kWh und mache einige Berechnungen.
Siehe <<Server>> f√ºr ein Beispiel, wie viel Strom ein leistungsf√§higer Server verbraucht.

Support::
Wer hilft dir, wenn du mal nicht weiterkommst?
<<Support>> bietet einige Ideen.

Physischer Standort::
Wo soll der Server stehen?
Musst du neue Leitungen f√ºr Strom oder Netzwerk verlegen?
<<Networking>> beschreibt meine Heiminstallation.

=== Zeitlicher Ablauf

Skizziere grob wichtige Termine, damit du und deine Nutzer vorausplanen k√∂nnen.
Zum Beispiel:

28.{nbsp}April::
  Brainstorming, Planung.
30.{nbsp}April::
  Hardware bestellen.
3.{nbsp}Mai::
  Ethernet-Kabel vom Router in die Garage verlegen.
5.{nbsp}Mai::
  Server einrichten: Festplatten einbauen, einschalten, Betriebssystem installieren, Dienste starten.
9.{nbsp}Juni::
  Ergebnis im Vergleich zu den urspr√ºnglichen Zielen √ºberpr√ºfen.

Lade andere ein, mitzumachen, idealerweise schon zu Beginn beim Brainstorming und der Planung.
Das ist eine gro√üartige Gelegenheit, weitere Personen einzubeziehen, die bei der Betreuung des Servers helfen k√∂nnen.

=== Umstellung

(((change management)))
Ihre Benutzer haben ihre Daten bereits an einem anderen Ort.
√úberlegen Sie, wie Sie ihnen helfen k√∂nnen, ihre Daten auf den Server zu migrieren.

Der Schl√ºssel dazu ist ausgezeichnete Kommunikation.
Nehmen Sie dies in Ihren Plan auf und sorgen Sie f√ºr Zustimmung, da die Migrationskosten bei jeder Umstellung eine Realit√§t sind.

TIP: Um mehr dar√ºber zu erfahren, wie man Benutzer sanft zwischen Systemen √ºberf√ºhrt, besch√§ftigen Sie sich mit dem Thema _Change Management_.

=== Sysadmin Mindset

(((sysadmin, mindset of a Steadfast)))
Der Server existiert f√ºr die Nutzer.
Es ist wichtig, die richtige Einstellung zu haben, um eine hervorragende Nutzererfahrung bieten zu k√∂nnen.

Stelle sicher, dass deine selbstgehosteten Dienste gut f√ºr deine Nutzer funktionieren.
Bitte sie regelm√§√üig um Feedback und nimm es ernst.
Unterscheide sorgf√§ltig zwischen ihren _W√ºnschen_ und ihren _Bed√ºrfnissen_.

√úbersetze das Wort ‚ÄûNutzer‚Äú je nach Kontext passend.
Vielleicht: ‚Äûdie dir am meisten am Herzen liegen, die du √ºber alle anderen hinweg am meisten sch√§tzt, diejenigen, die dir Sinn und Zweck geben.‚Äú
Ja, das ist etwas √ºbertrieben.
Du verstehst den Punkt: Wir m√ºssen aufmerksam sein, was die Nutzer erleben, sonst wird es f√ºr alle frustrierend.

Ideal ist es, wenn du deine Nutzer bereits im echten Leben kennst.
Bleibe auch im echten Leben mit ihnen in Verbindung, um sie online besser unterst√ºtzen zu k√∂nnen.

== System Design

Tauchen wir ein in die Gestaltung eines _Steadfast_ Systems.

=== Dienst-Stack

Ein _Steadfast_ System l√§sst sich gut als vereinfachter Stapel farbiger K√§stchen darstellen.
Die vertikale Anordnung dieses Stacks richtet sich danach, wo und wie h√§ufig eine Systemadministratorin wahrscheinlich auf dieser Ebene agieren oder bei Support- oder Fehlersuche eingreifen wird (am h√§ufigsten oben), sowie danach, wie stark die jeweilige Ebene vom Bare Metal abstrahiert ist (am wenigsten unten).

[#image-service-stack]
.Schichten eines Steadfast systems. Von unten, Hardware: Bare Metal, Dateisystem: ext4 for / and optionally ZFS for /data, Betriebssystem: Ubuntu LTS 64-bit server, Containerlaufzeit: Docker, Container: Nextcloud Dateifreigabe, Jellyfin Medienserver, Wallabag Artikelleser.
image::service-stack.svg[align="center",scaledwidth=80%]

Am h√§ufigsten arbeite ich in den oberen Schichten ‚Äì zum Beispiel beim Hinzuf√ºgen oder Aktualisieren eines Containers.
Seltener aktualisiere ich Betriebssystempakete.
Noch seltener sehe ich mir Versionen einer Konfigurationsdatei an, die auf der Festplatte gespeichert sind ‚Äì dank automatischer Snapshots von ZFS.
Und schlie√ülich, wenn mein Server ausf√§llt, befinde ich mich ganz unten im Stack: Ich repariere oder ersetze die Hardware.
Hier findest du die entsprechenden Abschnitte mit Details zu jeder Ebene:

* Dienste in Containern:
** <<Nextcloud: Dateisynchronisation und -Freigabe>>
** <<Jellyfin: Audio- und Videostreaming>>
** <<Wallabag: Artikel speichern und lesen>>
* container runtime:
** <<Containers == happy>>
** <<Contained services>>
* OS: <<Betriebssystem>>
* filesystem: <<Dateisystem>>
* hardware: <<Server>>

Es gibt au√üerdem zwei Dienste in Containern, die sp√§ter behandelt werden und _nicht_ im Diagramm dargestellt sind:

* <<Watchtower: Dienst-Updates>>
* <<Scratch: visuelle Programmierung>>

=== Digitale Sicherheit

Lass uns die grundlegenden Werkzeuge kennenlernen, um deinen Server zu verstehen und abzusichern.

==== Categoriziere deine Daten

Zuerst solltest du deine Daten betrachten.
Es hilft, sie in zwei g√§ngige Kategorien aufzuteilen:

===== Sensible Daten

Beispiele: Passw√∂rter, Kreditkartennummern, staatliche Ausweisnummern.
Empfehlungen:

. Wenn m√∂glich, nur offline speichern.
. Falls jemals auf einem Computer gespeichert, dann verschl√ºsselt.
. Einfache L√∂sung: in einem ((Passwortmanager)) speichern.

===== Alles Andere

Beispiele: Notizen, Fotos, Dokumente, pers√∂nliche Informationen.
Empfehlungen:

. Auf verschl√ºsselten Medien speichern, einschlie√ülich Backups.
. Nur mit aktueller, vertrauensw√ºrdiger Software darauf zugreifen.
. WAN-Zugriff (Wide Area Network) auf diese Daten untersagen.

==== WAN-Zugriff

(((WAN-Zugriff)))
Sobald du deine Daten kategorisiert hast, √ºberlege dir, wie Menschen darauf zugreifen werden.
Zuhause kannst du im Allgemeinen direkt auf deinen Server zugreifen.
Wenn du jedoch unterwegs bist oder Daten mit jemand anderem teilen m√∂chtest, geht es um WAN-Zugriff (Wide Area Network).

(((Router)))
(((port forward)))
WAN-Zugriff ist ‚Äì informell gesagt ‚Äì der Fernzugriff auf Dienste und Daten, die in deinem lokalen Netzwerk (LAN) laufen.
Eine M√∂glichkeit, WAN-Zugriff auf einen Dienst zu erm√∂glichen, ist das Weiterleiten von HTTPS-Verkehr (Portweiterleitung) √ºber deinen Router oder deine Firewall.
Portweiterleitung ohne zus√§tzliche Sicherheitsma√ünahmen ist zugleich riskant und bequem.

NOTE: Ziehe Alternativen zur Portweiterleitung in Betracht, wie etwa die Verwendung einer VPN.

==== Bedrohungsmodell

(((threat model)))
Gehen wir einen Schritt zur√ºck und sprechen √ºber Bedrohungsmodellierung.
Dein Bedrohungsmodell beschreibt, wie du Bedrohungen f√ºr deine Daten einsch√§tzt und wie du ihnen entgegenwirken willst.
Mit einem klaren Bedrohungsmodell kannst du fundierte Entscheidungen treffen ‚Äì zum Beispiel dar√ºber, ob du den WAN-Zugriff auf deinen Server erlauben solltest oder nicht.

WARNING: Wenn du bereits wei√üt, dass du ein wertvolles Ziel bist (z.B. √∂ffentliche Person, hohes Verm√∂gen, Kriegsberichterstatter*in oder verantwortlich f√ºr einen Server mit Informationen √ºber viele Menschen), dann gilt: Mach dich auf eine l√§ngere Reise gefasst.
Dieses Buch allein reicht nicht aus, um deinem Bedrohungsmodell gerecht zu werden.

Lass uns ein einfaches Beispiel f√ºr ein Bedrohungsmodell f√ºr die Datenklasse "alles andere" erstellen.
√úberlege dir dabei folgende Punkte:

Anlagen::
  Daten, die du sch√ºtzen m√∂chtest.
Akteure / Bedrohungen / Angriffsvektoren::
  Menschen und Bots, die in b√∂ser Absicht handeln ‚Äì sowie deren Angriffsmethoden.
Auch unbeabsichtigte Fehler und Software-Bugs z√§hlen dazu.
Gegenma√ünahmen::
  Ma√ünahmen zur Risikominimierung, damit Angriffe weniger wahrscheinlich sind oder weniger Schaden anrichten.

F√ºg das alles zusammen, und du erh√§ltst mein absolut marketingfreundliches Akronym f√ºr ein Bedrohungsmodell: *A.A/B/A.G.* (jede Zeichensetzung wird mitgesprochen).
Geht einem wirklich leicht √ºber die Lippen!

==== Beispiel: WAN-Zugriff

Teste ((WAN-Zugriff)) mit diesem Bedrohungsmodell.

Anlagen::
  Dateien mit pers√∂nlichen Informationen, die in einem veralteten Dienst gespeichert sind (z.B. eine alte, verwundbare Version von Nextcloud).
Akteure / Bedrohungen / Angriffsvektoren::
  Ein Bot durchsucht Websites und findet eine URL zu einem Dienst in einem √∂ffentlich zug√§nglichen Mailinglisten-Archiv.
Der Bot versucht automatisch, eine bekannte Schwachstelle im Dienst auszunutzen.
Der Angriff gelingt, und der Bot-Betreiber erh√§lt Zugriff auf Rechenressourcen und pers√∂nliche Informationen.
Gegenma√ünahmen::
  Halte den Dienst aktuell.
Sichere die WAN-Grenze: √ºberwache die Verkehrsdaten, setze ein ((IPS)) (Intrusion Prevention System (Einbruchsschutzsystem)) ein, und lasse den Zugriff ins ((LAN)) nur √ºber ein VPN (Virtual Private Network) zu.
Schlie√üe die WAN-Grenze: erlaube keinen eingehenden WAN-Zugriff.

Solltest du dich entscheiden, einen Dienst √∂ffentlich zug√§nglich zu machen, helfen diese Ma√ünahmen, ihn zu sichern.
‚Äû√ñffentliche Mailinglisten vermeiden‚Äú ist nicht als Ma√ünahme aufgef√ºhrt, da es nur die URL zum veralteten Dienst verschleiert und man sich nicht auf ‚ÄûSicherheit durch Verschleierung‚Äú verlassen sollte.

[%unbreakable]
TIP: Die Absicherung auf mehreren Ebenen (Betriebssystem-Firewall, Dienst, WAN-Grenze) zeigt das Prinzip der ‚ÄûVerteidigung in der Tiefe‚Äú (‚Äûdefense in depth‚Äú), eine g√§ngige und sinnvolle Sicherheitsstrategie.

==== VPN

Ein ((VPN)) kann deine WAN-Grenze absichern, indem es nur authentifizierte Benutzer zul√§sst und eine Verschl√ºsselungsschicht hinzuf√ºgt.
So kannst du dich sicher in dein ((LAN)) ‚Äûteleportieren‚Äú, w√§hrend du remote bist.

Wenn alle deine Nutzer ein VPN verwenden k√∂nnen, kannst du die Ports f√ºr HTTP/S-Verkehr geschlossen halten und stattdessen nur VPN-Verkehr erlauben.
Vorausgesetzt, dein VPN-Server ist gut konfiguriert und aktuell, ist dies eine hervorragende M√∂glichkeit, deine ((Angriffsfl√§che)) zu reduzieren.

Die VPN-Technologie erhielt ein gro√ües Upgrade durch https://www.wireguard.com[Wireguard].
Aus Nutzersicht gibt es keinen schweren Login-Prozess mehr, wie bei √§lteren VPNs.
((Wireguard)) ist schnell, einfach und sicher.

==== Full-disk Verschl√ºsselung

(((verschl√ºsselung, full-disk)))
Das Verschl√ºsseln verhindert, dass ein Angreifer Daten wiederherstellen kann.
Beim Hochfahren musst du allerdings ein Passwort eingeben.
Das ist unpraktisch, wenn es zu Stromausf√§llen kommt und/oder keine Fernverwaltung m√∂glich ist.
Au√üerdem wird zu Recht argumentiert, dass Vollplattenverschl√ºsselung f√ºr einen st√§ndig eingeschalteten Server wenig bringt: Im Normalbetrieb hast du den Entschl√ºsselungsschl√ºssel ja bereits eingegeben.

Wenn du dich f√ºr Vollplattenverschl√ºsselung entscheidest, w√§hle sie w√§hrend der <<OS-Installation>> aus.
Sieh dir die vorherigen Abschnitte dieses Kapitels an, falls du bei der Entscheidung Unterst√ºtzung m√∂chtest.

==== Mehr Tips

[#self-hoster-security-tips]
.Self-hoster Sicherheitstips
****
* Pflege n√ºtzliche, verschl√ºsselte Backups.
F√ºhre Test-Wiederherstellungen durch, um deren N√ºtzlichkeit zu best√§tigen.
Siehe <<Backups>>.
* Vermeide es, Befehle als root-Benutzer auszuf√ºhren.
* Nutze Multi-Faktor-Authentifizierung.
* Setze Firewalls ein.
* Verwende starke Passw√∂rter.
* Sei sehr vorsichtig beim Port-Forwarding oder lasse es am besten ganz weg.
* Sei wachsam bei all den √ºblichen Dingen: Phishing, Malware, SMS-Spoofing und Social-Engineering-Angriffen.
** Sei vorsichtig mit Links und Anh√§ngen in E-Mails.
** Installiere keine nicht vertrauensw√ºrdige Software. Always use HTTPS.
** Nutze bei deinem Mobilfunkanbieter eine spezielle Passphrase als zus√§tzliche Authentifizierungsebene.
** Hinterfrage Dringlichkeit und verd√§chtige Anfragen kritisch.
* Leite unbekannte Anrufe auf die Mailbox um.
* Achte auf Datenpannen und sch√ºtze deine Identit√§t.
** Sperre deine Kreditinformationen nach einem Datenleak.
* Informiere dich √ºber Kompartimentierung (Isolation) und das Prinzip der geringsten Privilegien.
****

Zus√§tzliche Lekt√ºre:

* https://oreilly.com/library/view/personal-cybersecurity-how/9781484224304/[Personal Cybersecurity: How to Avoid and Recover from Cybercrime] by Marvin Waschke
* https://modernprivatelife.com/how-to-choose-privacy-threat-model/[Personal Privacy Threat Modeling (With LOTS Of Examples)] by Eliza
* https://arstechnica.com/information-technology/2017/07/how-i-learned-to-stop-worrying-mostly-and-love-my-threat-model/[How I learned to stop worrying (mostly) and love my threat model] by Sean Gallagher

=== Dateisystem

(((ZFS)))
Ich empfehle (und werde demonstrieren), mit einem einzigen ((ext4))-Dateisystem zu beginnen und optional einem ZFS-Dateisystem.
ext4 ist das stabile, einfache und standardm√§√üige Dateisystem f√ºr Ubuntu.
ZFS (urspr√ºnglich: Zettabyte File System) bietet Verschl√ºsselung, leichte Snapshots und ((RAID)) (redundante Anordnung kosteng√ºnstiger Festplatten).

Optional kannst du ZFS f√ºr den Speicher (`/data`) auf deinem Server verwenden, wie unter <<ZFS Setup>> beschrieben.
F√ºr die Root-Partition (`/`) empfehle ich stattdessen ext4 zu verwenden, um:

* So nah wie m√∂glich an der Standard-Ubuntu-Installation bleiben
* Docker-Dateisystem-M√ºll vermeiden
** Wenn `/var/lib/docker` auf ZFS liegt, werden viele Docker-bezogene Dateisysteme erstellt, die die Ausgabe von `zfs list` etwas un√ºbersichtlich machen
* ZFS-Snapshots des Betriebssystems vermeiden, da
** wir sie nicht brauchen
** das Betriebssystem au√üerhalb der ZFS-Verzeichnisse liegt
** wir das Betriebssystem nicht ver√§ndern werden ‚Äì √Ñnderungen werden upstream verwaltet (z. B. bei Paketupdates oder √ºber mario)

Docker-Volumes (nachhaltige Container-Daten) werden auf ZFS gespeichert.
Das Dateisystem des ((Container)) ‚Äì also alles au√üer den gemounteten Volumes mit nachhaltigen Daten ‚Äì ist fl√ºchtig (ephemeral) und liegt auf ext4 unter `/var/lib/docker`.
Um mehr √ºber ZFS zu erfahren, siehe:

* https://arstechnica.com/information-technology/2014/01/bitrot-and-atomic-cows-inside-next-gen-filesystems/[Bitrot and atomic COWs: Inside ‚Äûnext-gen‚Äú filesystems] by Jim Salter
* https://arstechnica.com/information-technology/2020/05/zfs-101-understanding-zfs-storage-and-performance/[ZFS 101‚ÄîUnderstanding ZFS storage and performance] by Jim Salter
* https://wiki.debian.org/ZFS[ZFS (Debian wiki page)] by various authors

Weitere ZFS-Konzepte, die es sich zu lernen lohnt: Fragmentierung, ARC (Adaptive Replacement Cache), Resilvering, Scrubbing, `ashift` und `recordsize`.

=== Betriebssystem

(((Betriebssystem)))
(((Ubuntu)))
((Linux)) ist eine beliebte und vern√ºnftige Wahl f√ºr Self-Hosting. Ich empfehle einen 64-Bit-Ubuntu-Linux-Server mit mindestens 2 GB Arbeitsspeicher und 30 GB Speicherplatz.
Ubuntu ((LTS)) (Long-Term Support)-Versionen sind am stabilsten, und ich empfehle genau diese.
Steadfast bezieht sich speziell auf 24.04, die LTS-Version von April 2024.
Version 24.04 ist heute stabil und https://ubuntu.com/about/release-cycle[wird bis April 2034 Updates] erhalten, was viele weitere Jahre Stabilit√§t verspricht, bevor Steadfast √ºberarbeitet werden muss.
Die Installation des Betriebssystems ist im Allgemeinen schnell und schmerzlos, siehe <<OS-Installation>>.

==== Personalisierung

Es ist gute Praxis, Anpassungen am Betriebssystem m√∂glichst gering zu halten und sorgf√§ltig zu dokumentieren, wenn man von einer Standardinstallation ausgeht.
Das erleichtert die Wartung, einschlie√ülich eventueller Neuinstallationen.
Nicht st√§ndig am Server herumzubasteln erfordert Disziplin, besonders f√ºr altgediente, hands-on Systemadministratoren wie mich.

Versuche, es zu vermeiden, dich per SSH direkt auf den Server einzuloggen und dort Einzel√§nderungen vorzunehmen.
Du wirst lernen, stattdessen die Konfigurationsdateien von mario zu bearbeiten und den Server neu zu provisionieren (siehe <<_mario>>).

Nat√ºrlich kannst und solltest du dich weiterhin per ((SSH)) auf den Server verbinden, aber versuche dann, nur Lesezugriffe oder nur ausnahmsweise Schreibzugriffe auszuf√ºhren.
Ich mache oft erst etwas manuell, mache es r√ºckg√§ngig und erledige dann denselben Schritt mit mario, um sicherzustellen, dass das Ergebnis wie erwartet ist.

****
Beispiele f√ºr serverseitige Leseoperationen:

* Ressourcenverbrauch pro Container anzeigen: `sudo docker stats`
* Container-Logmeldungen verfolgen (ausf√ºhren im Verzeichnis mit einer `compose.yml`-Datei): `sudo docker compose logs -f`
* Server-Gesundheit pr√ºfen: `date; tail /proc/pressure/*`

Beispiele f√ºr serverseitige Schreiboperationen:

* Betriebssystem-Pakete aktualisieren: `sudo apt full-upgrade`
* Berechtigungen f√ºr einen Ordner √§ndern: `chmod 0700 ~/bin/`
****

Beginne mit einer Checkliste f√ºr die ‚Äûmonatliche Wartung‚Äú, wie sie in <<Serverwartung>> zu finden ist.
Nimm diese schreibenden (read-write) Operationen in deine Checkliste auf.
F√ºhre schreibende Operationen nach M√∂glichkeit mit mario durch.

Verwende stets `sudo`, um privilegierte Befehle auszuf√ºhren, anstatt dich direkt als `root` anzumelden.
So wird jeder Befehl zusammen mit Zeitpunkt und ausf√ºhrender Person in `/var/log/auth.log` protokolliert.

Upgrades k√∂nnen automatisiert werden.
Das ist sinnvoll, sobald man eine gewisse Skalierung erreicht hat ‚Äì vorausgesetzt, man hat Vertrauen in und Kontrolle √ºber die Quelle der Updates.
Ich pers√∂nlich f√ºhre Betriebssystem-Upgrades meist manuell durch, da ich nur wenige Systeme betreue. Der Aufwand ist dadurch gering und selten, und das Aktualisieren eines Pakets kann Tests oder manuelle Eingriffe (z.B. einen Neustart) erfordern.
Aus √§hnlichen Gr√ºnden installiere ich auch das Betriebssystem selbst von Hand.

Mein Betriebssystem ist eher ein Haustier als ein Nutztier (siehe ‚Äûcattle vs. pets‚Äú im <<Glossary>>).
Vielleicht ist es sogar ein Haustier-Ph√∂nix:
Wenn es stirbt, l√§sst es sich relativ leicht aus der Asche wiederbeleben.
Es wird regelm√§√üig gesichert, es gibt nur wenige manuelle Schritte ‚Äì und alle manuellen Schritte sind sorgf√§ltig dokumentiert.

=== Contained services

mario nutzt ((Docker)) um Dienste in Containern zu betreiben.
Docker ist bur eine von vielen Wegen um Dienste isoliert zu betreiben.
((VM))s werden auch oftmals fur diese Zwecke genutzt.
Siehe <<Containers == happy>> fur einen Vergleich dieser zwei Optionen.
Falls du weiteres Interesse VMs hast (als Alternative oder im Zusammenhang mit Containern), schaue bei https://proxmox.com[Proxmox] vorbei.

((Kubernetes)) funktionieren auch gut um Dienste zu betreiben.
Probiere Kubernetes aus (vorallem eine der interessanten Micro-Versionen) falls du vertrauter oder interessierter an dieser Version bist.
Ich persoenlich fand es zu viel.
Falls ich aber hohe Verf√ºgbarkeit fur Clustering ben√∂tigte wurde ich eher Kubernetes nutzen.
Falls einer der Computer des Kubernetes ((Cluster)) defekt ist k√∂nnen Dienste automatisch auf intakte Hardware im Cluster √ºbertreten.
Unabh√§ngig von deiner Wahl solltest du mit deinen Nutzern klare Erwartungen dar√ºber setzten, wie lange dein Server im Falle eines Defektes eventuell ausfallen kann.

(((isolation)))
Docker schafft eine gute Balance zwischen Eigenschaften und Benutzerfreundlichkeit, weshalb es einfach ist einen Deinst in Isolation zu betreiben.
((Docker Compose)) Docker Compose erweitert Docker um die F√§higkeit, Gruppen von Prozessen zu definieren und auszuf√ºhren, die zusammen einen vollst√§ndigen Dienst bereitstellen (z.B. einen Webserver und dessen Datenbank).
Kubernetes kann das auch ‚Äì und noch viel mehr, das du _nicht_ lernen musst, solange du _kein_ virtuelles Rechenzentrum aufbauen willst.
F√ºr ein einzelnes Serversystem ist Docker Compose meist die passendere Wahl.

Es ist au√üerdem ratsam, Dienste und deren Abh√§ngigkeiten _nicht_ mit allem anderen auf dem prim√§ren Speicher des Servers zu vermischen.
Anfangs erscheint es einfach, alles auf einem einzigen Dateisystem zu betreiben ‚Äì besonders, wenn es nur einen Dienst gibt.
Doch je mehr Dienste hinzukommen, desto komplizierter wird es.
https://en.wikipedia.org/wiki/Dependency_hell[Doch je mehr Dienste hinzukommen, desto komplizierter wird es].

Viele der verzweifelten Supportanfragen von Self-Hostern, die ich in FOSS-Communities sehe, betreffen Inkompatibilit√§ten zwischen bestimmten PHP-Versionen oder relationalen Datenbankversionen, die von zwei verschiedenen Diensten ben√∂tigt werden.
Docker mildert dieses Problem, indem es Abh√§ngigkeiten b√ºndelt.
Jedes Docker-Image ist im Grunde ein vollst√§ndiges Dateisystem (ohne Kernel), sodass ein Service-Image immer die passende PHP-Version enth√§lt.
Ein anderes Image wird bei Bedarf f√ºr die Datenbank verwendet.

Es lohnt sich, einen Moment bei den geb√ºndelten Abh√§ngigkeiten zu verweilen.
Wenn Abh√§ngigkeiten Kleidung w√§ren, dann ist ein Docker ((Container)) ein robuster und g√ºnstiger Koffer mit allem, was man f√ºr eine Woche Reise braucht.
Man gibt seinen Koffer ab, steigt in den Zug und kann beruhigt sein, dass der Koffer ordentlich und getrennt neben den anderen verstaut ist.
Docker-Container sind Koffer ‚Äì w√§hrend die alte Herangehensweise einem riesigen W√§schehaufen im letzten Waggon entspricht, in dem alle ihre ungefaltete Kleidung einfach hineingeworfen haben.

(((image)))
Container werden aus Images erstellt.
Ein Image ist der Bauplan, mit dem sich ein neuer Koffer (Container) wie durch Magie erschaffen l√§sst ‚Äì fix und fertig gepackt mit der passenden Kleidung f√ºr deine Reise.
Ein Image wird einmal erstellt, mit einer eindeutigen Kennung versehen und weitergegeben.
Es dient dann als Grundlage f√ºr unz√§hlige Container, die sich zuverl√§ssig gleich verhalten.

Images werden √ºber eine Datei namens `Dockerfile` definiert.
Die `Dockerfile` sollte in der Versionskontrolle (z.B. Git) verfolgt werden.
Da mario Docker-Compose verwendet, ist eine weitere wichtige Datei `compose.yml`.
Jeder Dienst hat seine eigene `compose.yml` Datei, die ebenfalls unter Versionskontrolle stehen sollte.
F√ºr Systemadministratoren bieten diese Konventionen ((reproduzierbare)) Images und Container.
F√ºr Benutzer bedeutet das: verl√§ssliche, vorhersehbare Dienste.

(((cattle vs. pets)))
√úbe den Umgang mit Containern als tempor√§re Objekte.
Du gewinnst Vertrauen in dein System, indem du Container regelm√§√üig erstellst und wieder entfernst ‚Äì und du wirst die Geschwindigkeit und Einfachheit dieses Vorgehens sch√§tzen lernen.
Denke so:

* Kurzlebig
** Container sind tempor√§r
** Tempor√§re Container erm√∂glichen robuste, reproduzierbare Dienste
* Nutztiere, keine Haustiere
** Von Hand verwaltete virtuelle Maschinen sind aufwendige Haustiere
** Entschuldigung an das Vieh ‚Äì in diesem Vergleich sind sie entbehrlich
* Zustandslos
** Permanente Daten m√ºssen explizit definiert und verwaltet werden
* Ph√∂nix-Server
** Ein Begriff von Kornelis Sietsma f√ºr Server, die regelm√§√üig zerst√∂rt und neu erschaffen werden

=== Reverse-Proxy

Ein ((Reverse-Proxy)) sitzt vor den Containern und leitet den Datenverkehr anhand beliebiger Regeln an den richtigen Dienst weiter.

Angenommen, du hast die Domain example.com gekauft und m√∂chtest Nextcloud unter cloud.example.com und Jellyfin unter jellyfin.example.com betreiben.

Dein Server verwendet dann einen Reverse-Proxy und eine einzige IP-Adresse, um den eingehenden Datenverkehr je nach Hostnamen an den jeweiligen Dienst weiterzuleiten.

mario verwendet Traefik als Reverse-Proxy.

==== Traefik Architektur

Hier ein √úberblick dar√ºber, wie ((Traefik)) funktioniert und wie es mit Nextcloud und anderen selbstgehosteten Webdiensten zusammenarbeitet:

Wir m√∂chten, dass ((HTTPS))-Anfragen an Port 443, die f√ºr cloud.example.com bestimmt sind, beim Nextcloud-Dienst ankommen.
Um diesen Vorgang zu verstehen, hilft es, das mitgelieferte Traefik-Architekturdiagramm zu studieren ‚Äì ebenso wie die Quelltexte von mario.

[#image-traefik-architecture]
.Traefik-Architekturdiagramm, das zeigt, wie eine Anfrage einen Dienst erreicht.Aus dem MIT-lizenzierten Quellcode von Traefik. Danke an Peka f√ºr das Gopher-Logo, lizenziert unter CC-BY-3.0.
image::traefik-architecture.png[]

(((router, Traefik)))
In den mario-Quelltexten (oder in den sp√§ter gezeigten Codeausschnitten) lohnt sich ein Blick in die compose.yml-Dateien f√ºr Traefik und Nextcloud, in denen unter anderem Folgendes enthalten ist:

* Der websecure-Eintrittspunkt, √ºber den HTTPS-Verkehr auf Port 443 empfangen wird
* Die App-Service-Definition f√ºr Nextcloud, die Traefik-Routing-Labels enth√§lt
* Die Host(‚Ä¶)-Regel im nc-https-Router, mit der eingehender Verkehr basierend auf dem Hostnamen weitergeleitet wird

[%unbreakable]
NOTE: Die Symbole `app`, `websecure` und `nc-https` sind willk√ºrlich gew√§hlt.
Ich habe kurze Namen verwendet, damit sie nicht √ºber Zeilen umbrechen.
Du kannst stattdessen auch l√§ngere, beschreibendere Namen verwenden.

Die Routing-Labels verkn√ºpfen den Entrypoint und den Router mit dem Dienst, unter dem sie definiert sind.
Konkret hei√üt das: `websecure` ‚Üí `nc-https` ‚Üí `app`.

Die folgenden beiden Snippets aus dem Mario-Quellcode zeigen, wie wir Traefik f√ºr Nextcloud einrichten.

.Traefik-Konfigurationsausschnitt (üè† Admincomputer)
[source#traefik-config,yaml]
----
# from traefik/compose.yml
services:
  reverse-proxy:
    command:
      - --entrypoints.websecure.address=:443 <1>
----

<1> Definiere den Entrypoint `websecure` im Dienst `reverse-proxy`, der Datenverkehr √ºber Port 443 entgegennimmt.

.Nextcloud-Konfigurationsausschnitt (üè† Admincomputer)
[source#nextcloud-config,yaml]
----
# from nextcloud/compose.yml
services:
  app:
    labels:
      - "traefik.http.routers.nc-https.entrypoints=websecure" <1>
      - "traefik.http.routers.nc-https.rule=Host(`cloud.example.com`)" <2>
----

<1> Verbinde den Entrypoint `websecure` mit dem Router `nc-https` im Dienst `app`.

<2> Verwende die Hostnamen-Regel mit dem Router `nc-https`.

Jeder selbst gehostete Dienst wird √ºber einen eigenen Router verf√ºgen.
Auch andere Webdienste verwenden den `websecure`-Zugang.

Die HTTPS-Verschl√ºsselung wird √ºber weitere Labels am Traefik-Container konfiguriert.
Siehe <<Verschl√ºsselungszertifikate>> f√ºr Details.

== Implementierung

Nun sind wir bereit, die ersten drei Schichten im <<Dienst-Stack>> bereitzustellen: Hardware, Dateisystem und Betriebssystem.
Ich beginne damit, Werkzeuge zur Bewertung von Diensten bereitzustellen und fahre dann mit der Installation des Betriebssystems und der Serverwartung fort.

=== Dienstplan

Als Dienste bezeichnet man die dauerhaft laufenden Softwareprogramme auf deinem Server.
Einige bieten eine Benutzeroberfl√§che, andere laufen im Hintergrund nach einem Zeitplan.
‚ÄûWebdienste‚Äú sind jene, auf die du √ºber einen Webbrowser oder ein anderes Tool, das HTTP verwendet, zugreifen kannst.

==== Dienstwahl

Beginne damit, deine bisherigen Anforderungen und Pl√§ne zu √ºberpr√ºfen, und nutze das folgende Material, um fundierte Entscheidungen dar√ºber zu treffen, welche Dienste du betreiben m√∂chtest.
Du kannst auch direkt zu <<Hardware vorbereiten>> springen, um dem vorgeschlagenen Pfad zu folgen und zun√§chst die Dienste zu verwenden, die mario standardm√§√üig installiert. Sp√§ter kannst du zu diesem Abschnitt zur√ºckkehren, wenn du weitere Dienste hinzuf√ºgen m√∂chtest.

===== Geeignet f√ºrs Self-Hosting

Du wirst feststellen, dass sich manche Dienste deutlich besser f√ºrs Self-Hosting eignen als andere.
Die guten Dienste weisen in der Regel zumindest einige der folgenden Merkmale auf:

.Merkmale eines guten selbstgehosteten Dienst
[#Merkmale-guter-Dienste]
****
* Einfach zu installieren, mit vorhandenen Anleitungen f√ºr das Selbst-Hosting
* Kompatibel mit deiner bevorzugten Bereitstellungsmethode (z.B. gut gepflegtes Docker-Image, Anleitungen f√ºr Docker Compose und Traefik)
* Aktive Community mit moderierten Chats, Foren, Mailinglisten, News und Meetups
* Aktuelle Entwicklung sichtbar (z.B. neue Releases, Commits, Ank√ºndigungen)
* Nutzung einer FOSS-Lizenz (Freie und Open-Source-Software)
* Transparente Angaben zu Eigent√ºmern und Sponsoren
* √ñffentliche Roadmap, Issue-Tracking, Continuous Integration, √∂ffentliches Demo, Build-Skripte, Bug-/Security-Bounties
* Bei Problemen lassen sich √ºber Websuche leicht Informationen finden (z.B. bekannte Issues oder Problemumgehung)
* Gut strukturierter, sauberer Code
* N√ºtzliche und aktuelle Dokumentation
* Vergleicht sich offen mit √§hnlichen Projekten
* Vollst√§ndig dokumentierte, n√ºtzliche API
* Flexibel und erweiterbar (z.B. √ºber Plugins oder Konfigurationsoptionen)

****

Siehe auch <<solution-viability-checklist>> in <<Alternativen zu mario>>.

Diese Merkmale basieren sowohl auf g√§ngigen Branchenstandards als auch auf meinen pers√∂nlichen Werten und Vorlieben.
Deine eigene Liste kann sich davon unterscheiden ‚Äì zum Beispiel, wenn du FOSS-Lizenzen weniger bevorzugst oder eine bestimmte Programmiersprache bevorzugst.

===== Ungeeignet f√ºrs Self-Hosting

Hier sind einige Hinweise darauf, dass ein selbst gehosteter Dienst m√∂glicherweise vermieden werden sollte.

.Merkmale eines schlechten selbstgehosteten Dienst
[#Merkmale-schlechter-Dienste]
****
* Unbeliebt, inaktiv oder schlecht gepflegt:
** Wenige Maintainer oder Beitragende
* Maintainer reagieren kaum auf Beitr√§ge der Community
* Enth√§lt Telemetrie (verbindet sich nach Hause, sammelt Statistiken oder Nutzungsdaten) ‚Äì besonders ohne deine Zustimmung und/oder standardm√§√üig aktiviert
* Hat bekannte Sicherheitsl√ºcken
* Verwirrende oder undurchsichtige Organisation: Governance, Entwicklungsplan, Lizenzierung, Versionskontrolle, Beitragseinreichung, Fehlerverfolgung
* √úberm√§√üig komplex
* Schwer zu forken (weiterzuentwickeln)
* Nur auf Unternehmen ausgelegt: Selbsthosting-Anleitungen fehlen oder sind sehr kompliziert
* H√§ufige, st√∂rende Werbung oder Kaufaufforderungen
* Bewusste Herstellerbindung (Vendor Lock-in)
* Abh√§ngigkeit von geschlossenen/propriet√§ren Standards oder Diensten
* https://en.wikipedia.org/wiki/Open-core_model[Open-Core-Modell]

****

(((Nextcloud)))
Ich werde hier Nextcloud ein wenig kritisieren.
Nextcloud hat deutlich mehr positive als negative Eigenschaften ‚Äì aber diese Punkte sind trotzdem erw√§hnenswert.

(((fork)))
Zun√§chst ihr offenbar nicht-FOSS-kompatibles Build-Skript.
https://help.nextcloud.com/t/build-bzip-and-package-from-git/58341/2[Nicks Erkl√§rung] daf√ºr ist nachvollziehbar:
Es ist f√ºr sie bequemer, Geheimnisse direkt im Build-Skript zu hinterlegen und das gesamte Skript geheim zu halten.
Aber: Hardcodierte Geheimnisse sind schlechte Praxis, das Verstecken eines Build-Skripts k√∂nnte ein Versto√ü gegen die AGPL-Lizenz sein,
und es erschwert das Forken.
Es ist gute Praxis, die Nachfolge zu visualisieren ‚Äì also vorbereitet zu sein auf ein Forking und einen m√∂glichen Eigent√ºmerwechsel.
Nextcloud selbst ist schlie√ülich ein Fork von ((ownCloud)) (siehe <<Nextcloud vs. ownCloud>>).

Zweitens: die ausufernde Komplexit√§t.
‚ÄûNextcloud‚Äú ist kein einzelnes Projekt, sondern eine Sammlung von _vielen_ Softwareprojekten und Diensten,
die in unterschiedlichem Ma√üe von einem einzigen Unternehmen kontrolliert werden.
Diese Komplexit√§t macht einen Fork teuer und zeitaufwendig.
Selbst der Wechsel zwischen bestehenden Forks (zum Beispiel die R√ºckkehr von Nextcloud zu ownCloud) kann kompliziert sein.
Es ist offensichtlich, dass sie _nicht_ versuchen, Nutzer absichtlich an sich zu binden ‚Äì
aber die Komplexit√§t an sich kann letztlich genau diesen Effekt haben.

==== Dienste Ressourcen zuordnen

Hier ist eine fr√ºhe, grobe Tabelle zur Ressourcenplanung, die ich verwendet habe.
Du kannst dieses Schema nutzen, um deinen eigenen Ressourcenbedarf abzusch√§tzen.
Einige dieser Dienste werden sp√§ter im Buch noch im Detail behandelt.

[%unbreakable,cols="4,4,3,2,2",id=example-tally]
.Beispielhafte Aufstellung von Diensten und ben√∂tigten Hardware-Ressourcen
|===
|Dienst |Zweck |Isolation |Cores |RAM

|jellyfin |Musik Streaming |Docker |2 |2 GB
|kahoot-clone |Quizspiele |Docker |0 |0 GB
|poller |Umfragen |Docker |0 |0 GB
|backuppc |Backups |none |0 |0 GB
|taskd |Aufgabenmanagement |Docker |0 |0 GB
|sftp |Datei√ºbertragung |none |0 |0 GB
|syncthing |Dateisynchronisation |none |1 |1 GB
|nextcloud |Dateifreigabe |Docker |2 |2 GB
|minetest |Spieleserver |Docker |4 |8 GB
|irssi |Chatprogramm |none |0 |0 GB
|jitsi |Videoanrufe |Docker |2 |2 GB
|wallabag |Artikelspeicher |Docker |1 |1 GB
|===

‚ÄûCores‚Äú steht f√ºr den relativen Spitzenbedarf an Rechenleistung.
RAM bezeichnet den maximalen Speicherbedarf.
Diese Werte waren grobe Sch√§tzungen, basierend auf ver√∂ffentlichter Dokumentation.
Die Sch√§tzungen erwiesen sich als hinreichend genau.
Mir wurde schnell klar, dass ich etwas Leistungsf√§higeres brauchen w√ºrde als den damals neuesten verf√ºgbaren Raspberry Pi.
Siehe <<Server>> f√ºr weitere Erkenntnisse zu den Anforderungen an Ressourcen.

=== Hardware vorbereiten

Es hei√üt __Hard__ ware, weil diese Probleme _hard_ (schwierig) sind.
Das klingt zwar lustig, entspricht aber meiner Erfahrung nach nicht der Wahrheit.
Auch wenn es eine gewisse Lernkurve beim Verstehen der grundlegenden Computerhardware gibt und Hardware durchaus ausfallen kann, hat sie viele wunderbare, positive Seiten. Zum Beispiel:

* Hardware ist greifbar und verh√§lt sich in der Regel konsistent.
* Einfach einstecken, einschalten ‚Äì und es funktioniert h√∂chstwahrscheinlich.
* Wenn es funktioniert, ist das sehr befriedigend.

==== Server

Du brauchst einen Server.

(((compute)))
Du kannst zwar jederzeit Rechenleistung in der Cloud eines anderen mieten, aber auf lange Sicht wird das teurer.

Wenn du es eilig hast, kannst du mit fast jedem alten Desktop oder Laptop anfangen ‚Äì oder mit deiner eigenen VM, die irgendwo l√§uft.
Verwende aber besser etwas Leistungsf√§higeres und Erweiterbareres als einen Raspberry Pi.
Was, wenn deine Nutzer begeistert sind?
Wie wirst du den Speicherplatz erweitern?
Was passiert bei pl√∂tzlichen Lastspitzen?
Wenn du mit etwas zu Kleinem startest, fehlt es dir schnell an Geschwindigkeit und Erweiterbarkeit.

Ich habe bereits mit vielen verschiedenen Servern gearbeitet und mich f√ºr dieses Self-Hosting-Abenteuer gr√ºndlich vorbereitet. Daher hatte ich eine ziemlich klare Vorstellung davon, was ich wollte.
Ich habe mich f√ºr etwas entschieden, das leistungsstark, g√ºnstig und schnell ist ‚Äì mit viel Speicherplatz und Raum f√ºr Erweiterungen.
Ich habe gezielt nach professioneller Standardhardware gesucht, weil sie im Fall eines Defekts leichter austauschbar ist.
Der Server sollte mit pl√∂tzlichen Lastspitzen gut zurechtkommen, z.B. beim Bauen von Docker-Images, bei kurzfristig hoher Benutzeraktivit√§t oder auch bei etwas generativer ((KI)) ‚Äì selbst ohne Grafikprozessor.

Ich habe auf eBay einen gebrauchten, general√ºberholten 1HE-Geh√§usestapel f√ºr etwa 1.000USD gefunden.
Solche Ger√§te werden oft als ‚Äûoff-lease enterprise hardware‚Äú bezeichnet ‚Äì also Leasing-R√ºckl√§ufer aus dem Unternehmensbereich.
Ein 1HE-Server ist eine https://de.wikipedia.org/wiki/H%C3%B6heneinheit[H√∂heneinheit] hoch ‚Äì etwa so gro√ü wie eine lange Pizzaschachtel.
Technologiekonzerne sto√üen diese Ger√§te massenweise ab, sodass man oft ein gutes Angebot findet.
Mein Server hat zwei 24-Kern-CPUs und 128GB RAM.

[#image-racked-server]
.Selbstgebauter Geh√§usestapel-Server, an der Garagendecke montiert. Macht Spa√ü, ihn anzuschauen, und er ist aus dem Weg ‚Äì aber f√ºr Wartungsarbeiten brauche ich eine Leiter, und er wiegt etwa 23kg.
image::racked-server.jpg[align="center"]

Die L√ºfter sind viel lauter als bei einem Desktop-PC, besonders unter Last.
Der Server soll eigentlich eine gute Bel√ºftung sowie Temperatur- und Feuchtigkeitsregulierung haben,
hat sich aber bisher auch bei l√§ngeren Zeitr√§umen unter dem Gefrierpunkt und √ºber 38¬∞C als √§u√üerst robust erwiesen.
(((IPMI)))
Er verf√ºgt √ºber mehrere Enterprise-Funktionen, die die Wartung erleichtern ‚Äì wie redundante Netzteile, Hot-Swap-Festplatteneinsch√ºbe, zahlreiche Sensoren und Fernwartung √ºber einen Webbrowser oder IPMI.

Der durchschnittliche Stromverbrauch liegt bei 130W, also etwa 1.140kWh pro Jahr ‚Äì das entspricht ungef√§hr 138,15$ in Seattle.
Das ist in etwa so viel wie eine helle Gl√ºhlampe verbraucht, und f√ºr eine einzelne Person etwas verschwenderisch.
Aber bei f√ºnf Nutzer*innen? Etwa 228kWh pro Jahr und Person.
Das ist _weniger_ als der Stromverbrauch der Cloud-Server-Infrastruktur, die n√∂tig ist, um ein einziges mobiles Ger√§t √ºber Googles oder Apples Cloud-Dienste zu versorgen.
Weitere Literatur zu diesem Thema:

* https://science.time.com/2013/08/14/power-drain-the-digital-cloud-is-using-more-energy-than-you-think/[The Surprisingly Large Energy Footprint of the Digital Economy] by Bryan Walsh
* https://theguardian.com/sustainable-business/2014/sep/10/energy-consumption-behind-smart-phone[The spiralling energy consumption behind your smart phone] by Betsy Reed
* https://increment.com/energy-environment/the-secret-energy-impact-of-your-phone/[The secret energy impact of your phone] by Owen Williams

Ein Geh√§usestapel-Server wie meiner kann weit mehr als f√ºnf Nutzer*innen bedienen ‚Äì
vorausgesetzt, sie versuchen nicht alle gleichzeitig, Videos zu transkodieren.

Au√üerdem eignet er sich hervorragend als beheizte Sitzstange.

[#image-bird-on-server]
.Vogel auf einem Server sitzend.
image::bird-on-server.jpg[align="center",scaledwidth=50%]

==== Admincomputer

(((Admincomputer)))
Es ist hilfreich, einen separaten Computer vom Server zu haben, um √Ñnderungen vorzunehmen.
Ich verwende normalerweise ein Laptop als Admincomputer, um mario zu betreiben.

==== Testger√§te

Deine Nutzer*innen werden ihre eigenen Computer und Mobilger√§te (ihre _Clients_) verwenden.
Halte ein paar verschiedene Clients bereit, damit du vergleichbare Umgebungen hast und deinen Nutzer*innen besser helfen kannst.

(((dogfooding)))
TIP: Sei selbst Nutzer*in der Dienste, die du betreibst.
Das nennt man _Dogfooding_.
Dogfooding sorgt daf√ºr, dass du ehrlich mit dir selbst bleibst und dich besser in andere hineinversetzen kannst.

==== Festplattenlaufwerke

(((ZFS, snapshots and)))
Ich verwende Festplattenlaufwerke (Hard Disk Drives ((HDDs))) zur Datenspeicherung ‚Äì haupts√§chlich, um Kosten gegen√ºber √∂ffentlichem Cloud-Speicher oder ((SSD))s (Solid-State-Laufwerken) zu sparen.
Die Kosten f√ºr ((Blockspeicher)) in der Public Cloud √ºbersteigen bei Weitem die Gigabyte-Stunden-Kosten meiner Festplattenlaufwerke.
Ich habe den Preis f√ºr einen 5TB Blockspeicher bei AWS auf 228,10 $ pro Monat gesch√§tzt.
Mit ZFS erstelle ich au√üerdem alle 15 Minuten einen Snapshot (im Grunde ein vollst√§ndiges lokales Backup).
Der monatliche Preis f√ºr st√ºndliche Snapshots (das n√§chstvergleichbare Angebot, das ich finden konnte) kostet weitere 310,68$ bei AWS.
Das ergibt 535,67$ gesamt ‚Äì also etwa so viel, wie ich f√ºr meine Festplatten ausgegeben habe.
Ich hatte meine Ausgaben also nach einem Monat wieder drin ‚Äì und die Festplatten sollten _jahrelang_ halten.

(((RAID)))
Zur Redundanz empfehle ich, zwei identische Festplatten im Spiegelmodus (RAID 1) zu verwenden.
Das bietet nicht nur Datensicherheit bei Ausfall einer Festplatte, sondern auch bessere Leseleistung (bei den meisten Lesezugriffen).
Beachte aber: Die nutzbare Speicherkapazit√§t wird dabei halbiert.

((HDDs)) sind v√∂llig ausreichend schnell, wenn man die Antwortzeiten selbstgehosteter Dienste als Ma√üstab nimmt. Das Betriebssystem und die Dienste arbeiten effizient mit Daten-Caching, sofern der Server √ºber ausreichend RAM verf√ºgt.
Remote-Backups k√∂nnen l√§nger dauern ‚Äì das ist in Ordnung.

Ich verwende eine SSD f√ºr das Betriebssystem und alles au√üerhalb meiner Fotos/Dokumente usw., da die Startzeit des Betriebssystems entscheidend ist und dieses beim Booten nur wenig von Dateisystem-Caching profitiert.

(((data sovereignty)))
Eine interessante Alternative zu Festplatten f√ºr bestimmte Anwendungsf√§lle ist Objektspeicher.
Dabei handelt es sich um einen skalierbaren, cloudbasierten, unstrukturierten Key-Value-Speicher,
den das Betriebssystem nicht direkt nutzen kann ‚Äì Nextcloud allerdings schon.

Bei der Entscheidung zwischen beiden Optionen gibt es viele Faktoren zu beachten, zum Beispiel:

* Kosten f√ºr Speicherung und Egress (Downloads)
* Kontrolle, Autonomie und Datenhoheit
* Softwareunterst√ºtzung f√ºr Objektspeicher
* Direkter Zugriff auf die Daten
* Zugriffsgeschwindigkeit und -methoden
* Netzwerkverf√ºgbarkeit
* Backups, Versionierung und Sicherheit

Ich habe mich f√ºr HDDs entschieden, um direkten, lokalen Zugriff auf meine Daten zu haben.
Ich wollte ganz genau wissen, wo sie gespeichert sind, und maximale Flexibilit√§t haben, wenn ich Dienste wechsle oder neue ausprobiere.
Au√üerdem ben√∂tigen die meisten meiner Dienste ohnehin direkten Zugriff auf die Daten.

==== Networking

Wenn du zu Hause hostest und auch von anderen Orten als deinem lokalen Netzwerk (LAN) aus auf deinen Server zugreifen m√∂chtest, brauchst du eine zuverl√§ssige WAN-Verbindung (Wide Area Network).
Verwende f√ºr deinen Server unbedingt kabelgebundenes Ethernet statt WLAN.
Ein verkabeltes LAN ist zuverl√§ssiger und deutlich einfacher zu warten und zu diagnostizieren.

===== Mindestanforderungen

(((ISP)))
Hier sind einige typische Mindestanforderungen f√ºr das Self-Hosting zu Hause:

* 100 Mbit/s Upload / 100 Mbit/s Download bei deinem Internetanbieter
* Cat-5-Ethernetkabel (f√ºr die Verbindung deines Servers)
* 802.11ac-WLAN (f√ºr deine Client-Ger√§te)

Ich habe diese Werte auf Grundlage meiner eigenen Erfahrungen zusammengestellt ‚Äì und dann verdoppelt, damit du etwas Spielraum f√ºr Wachstum hast.

===== Konfiguration des Heimrouters

Lerne, wie du deinen ((Router)) richtig konfigurierst.
Halte seine Firmware aktuell und pflege eine strikte ((Firewall)): √ñffne bzw. leite nur die Ports weiter, die wirklich n√∂tig sind.

[%unbreakable]
CAUTION: Portweiterleitung erm√∂glicht eingehende Verbindungen durch deine WAN-Grenze zu deinem Server.
Lies unbedingt <<Digitale Sicherheit>>, bevor du irgendwelche Ports weiterleitest.

Erstelle eine Skizze, um dein Netzwerk besser zu verstehen.
Hier ist ein einfaches Diagramm, das ich mit https://asciiflow.com erstellt habe, um die Verkabelung zu planen und den Datenfluss durch meine Netzwerkger√§te zu visualisieren:

ifdef::backend-html5,backend-pdf[]
[#image-WAN-to-LAN-traffic]
.WAN into LAN traffic flow diagram.
image::WAN-to-LAN-traffic.svg[align="center",scaledwidth=80%]
endif::[]
ifdef::backend-epub3[]
[#image-WAN-to-LAN-traffic]
.WAN into LAN traffic flow diagram.
image::WAN-to-LAN-traffic.png[,472,320,align="center"]
endif::[]

(((IPMI)))
Pfeile stellen Ethernet-Kabel dar.
Der Router versorgt den Mini-Switch √ºber PoE (Power over Ethernet) mit Strom.
Der Server verf√ºgt √ºber zwei Netzwerkkarten (NICs ‚Äì Network Interface Cards): eine f√ºr das Betriebssystem und alle darauf laufenden Dienste, und eine f√ºr die Netzwerkverbindung zum eingebetteten OOB-Remote-Management-Computer mit IPMI (Intelligent Platform Management Interface).
WAN-Verkehr darf zur Haupt-NIC flie√üen, jedoch _nicht_ zur IPMI-NIC.

==== Stromversorgung

Verwende eine Steckdosenleiste mit √úberspannungsschutz.
Falls deine Stromversorgung zu Hause unzuverl√§ssig ist, solltest du eine USV (unterbrechungsfreie Stromversorgung) in Betracht ziehen.

==== Physische Sicherheit

Sch√ºtze deinen Server wie andere Wertsachen in deinem Zuhause.
Mindestens solltest du den physischen Zugang einschr√§nken.

=== OS-Installation

Hier ist eine Anleitung zur Einrichtung deines Servers.
Die Installation des Betriebssystems dauert etwa f√ºnf Minuten, wenn alles reibungslos verl√§uft.
Schritte werden der K√ºrze halber weggelassen, wenn die Voreinstellung ausreicht.

NOTE: W√§hrend du das Betriebssystem installierst, denke bereits an die Notfallwiederherstellung.
Mache dir Notizen und stelle dir vor, wie du den Vorgang exakt wiederholst.
Bei jedem Schritt im interaktiven Ubuntu-Installer: Akzeptiere entweder die Voreinstellung oder notiere dir deine Auswahl.

. *Installiere Ubuntu* 24.04 LTS server.
Siehe https://ubuntu.com/tutorials/install-ubuntu-server[this tutorial] f√ºr eine Schritt-f√ºr-Schritt Anleitung.
. Verwende beim Konfigurieren des Netzwerks eine *statische LAN-IP-Adress*.
YDu kannst dies m√∂glicherweise auch auf dem Standardwert belassen (DHCP/dynamisch) und stattdessen deinen LAN-Router so konfigurieren, dass er dem Server eine feste IP-Adresse zuweist, die sich nicht √§ndert.
. Optional: Verwende eine vollst√§ndige Festplattenverschl√ºsselung.
Siehe <<Full-disk Verschl√ºsselung>>.
. *Notiere Username und Passwort* wenn du deinen Nutzeraccount ("Profile") erstells. Du wirst sie bald brauchen.
. *Installiere den OpenSSH Server* wenn du dazu aufgerufen wirst.
. *Installiere kein Nextcloud oder Docker*, lasse mario diese sp√§ter installieren.

Gl√ºckwunsch, du hast soeben Linux installiert!
Der n√§chste Schritt:

. Optional: Nachdem du Ubuntu installiert hast, f√ºge zwei weitere Festplattenlaufwerke hinzu und formatiere sie mit ZFS.
Siehe <<ZFS Setup>>.
. Lade mario auf deinen Admincomputer herunter. Siehe <<Weitere Ressourcen>>.
. nutze mario auf deinem Admincomouter um deinen Server bereitzustellen. Siehe <<_mario>>.

==== ZFS Setup

(((ZFS, setting up)))
Das Betriebssystem k√ºmmert sich im Allgemeinen gut um sich selbst.
F√ºr eine robustere Datenspeicherung kannst du ein paar HDDs hinzuf√ºgen und sie mit **ZFS** verwalten.

ZFS bietet viele Funktionen und etwas zus√§tzliche Komplexit√§t.
Die Lernkurve lohnt sich.

Die folgende Anleitung zeigt dir, wie du einen einfachen Pool aus zwei gespiegelten Festplatten erstellst, sichtbar unter `/data`.
Das ist ein sinnvoller Ausgangspunkt: Du erh√§ltst damit bessere Fehlertoleranz und schnellere Leseleistung als mit nur einer einzelnen Festplatte.

Auf dem Server f√ºhrst du diese Befehle als `root` aus (Tipp: zuerst `sudo su -` eingeben).
Der Code unten geht davon aus, dass du mit einer Festplatte f√ºr das Betriebssystem angefangen hast, und dass das Betriebssystem diese als `/dev/sda` erkannt hat,
und dass du zwei weitere Festplatten hinzugef√ºgt hast, die als `/dev/sdb` und `/dev/sdc` erkannt wurden.
Passe das bei Bedarf an ‚Äî verwende `lsblk`, um deine Laufwerke zu identifizieren.

// Dieser Codeausschnitt ist von Vim mit `textwidth=75` umgebrochen, da das zuf√§llig den aktuellen Seitenr√§ndern des gedruckten Buchs entspricht.üò¨

.ZFS Setup (üöÄ server)
[source#zfs-setup,bash]
----
# Create partition tables.
parted /dev/sdb mklabel gpt
parted /dev/sdc mklabel gpt

# Create ZFS main mirrored pool and set attributes (for all future datasets
# in this pool).
zpool create -O mountpoint=none main mirror /dev/sdb /dev/sdc
# For performance.
zfs set atime=off main
# To save space.
zfs set compression=on main
# For security.
zfs set exec=off main
zfs set setuid=off main
zfs set canmount=off main

# Create encrypted dataset in "main" pool. This is the "parent" dataset, we
# can easily add more later and they'll all be encrypted.
openssl rand -base64 32 > /root/secure-dataset-key
zfs create -o encryption=on -o keyformat=passphrase \
    -o keylocation=file:///root/secure-dataset-key main/secure
zfs set canmount=off main/secure

# Create usable (mount-able) dataset.
zfs create -o mountpoint=/data main/secure/data

# This might not be necessary if you _never_ want to execute anything in
# /data. I found I needed it for something within a container (ffmpeg, I
# think). You can start with exec=off and turn it on later if you want.
zfs set exec=on main/secure/data
----

Hier sind einige Befehle, mit denen du Details zu dem anzeigen kannst, was du gerade erstellt hast.
Daf√ºr sind keine Root-Rechte erforderlich.

.show ZFS details (üöÄ server)
[source#zfs-details,bash]
----
# Examine pools.
zpool status
zpool list

# Examine datasets.
zfs list
----

Unter Ubuntu 24.04 LTS sind weitere Schritte erforderlich, damit dieses neue Dateisystem beim Serverstart automatisch eingebunden wird.
Die folgenden Anweisungen stammen aus der Handbuchseite zfs-mount-generator(8) ‚Äî mit einigen Korrekturen.
Diese Befehle m√ºssen mit Root-Rechten ausgef√ºhrt werden.

.ZFS mount on boot setup (üöÄ server)
[source#zfs-mount-on-boot,bash]
----
# enable tracking for the pool
mkdir /etc/zfs/zfs-list.cache
touch /etc/zfs/zfs-list.cache/main

# enable the tracking ZEDLET
systemctl enable zfs-zed.service
systemctl restart zfs-zed.service

# trigger cache refresh
zfs set relatime=off main/secure
zfs inherit relatime main/secure

# re-run systemd generators and reboot
systemctl daemon-reload
reboot
----

=== Serverwartung

(((maintenance, server)))
Ich verwende kurze monatliche und j√§hrliche Wartungs-Checklisten.
Ich aktualisiere meine Checklisten ungef√§hr so oft, wie ich sie benutze.
Hier sind Beispiele, die du als Ausgangspunkt verwenden kannst.

.Checkliste: Monatliche Wartung
[%unbreakable#monthly-maintenance]
****
* [ ] Betriebssystempakete aktualisieren.
* [ ] Verf√ºgbaren Speicherplatz √ºberpr√ºfen.
* [ ] Router-Konfiguration sichern.
****

Beachte, dass Ubuntu Server standardm√§√üig das Paket `unattended-upgrades` enth√§lt, das Sicherheitsupdates automatisch installiert.
Du m√∂chtest stattdessen vielleicht den Punkt ‚ÄûBest√§tigen, dass Betriebssystem-Updates erfolgreich waren‚Äú in deine Checkliste aufnehmen.

J√§hrliche Aufgaben sind in der Regel aufw√§ndiger und betreffen Teile des Systems und seiner Abh√§ngigkeiten, die sich idealerweise seltener √§ndern.

.Checkliste: J√§hrliche Wartung
[%unbreakable#yearly-maintenance]
****
* [ ] Backups wiederherstellen testen.
* [ ] Threat Model √ºberpr√ºfen und verbessern.
* [ ] Servergeh√§use √∂ffnen und tote Spinnen wegsaugen.
****

Die folgenden Abschnitte enthalten spezifische Wartungstipps und -tricks.

==== Hardware-Ausfall

Plane mit Hardware-Ausf√§llen.
Wenn du es dir leisten kannst, ist der einfachste Weg, einen Server zuverl√§ssig zu betreiben, _zwei identische Server zu kaufen_.
Verwende den zweiten als Ersatzteilspender oder als sofort einsatzbereiten Ersatz (auch ‚ÄûCold Spare‚Äú genannt).

==== SSoftware-Updates

Halte deinen Server auf dem neuesten Stand.
F√ºr das Betriebssystem:

.upgrade packages (üöÄ server)
[source#upgrade-packages,bash]
----
sudo apt update && sudo apt full-upgrade
----

Dies aktualisiert die lokalen Paketinformationen und ‚Äì falls erfolgreich ‚Äì das Betriebssystem.
Root-Zugriff ist erforderlich, daher sudo.
Das ist relativ sicher und erfordert in der Regel wenig bis keine Interaktion au√üer einer Best√§tigung zum Fortfahren.
Ein Neustart kann anschlie√üend n√∂tig sein (z.B. bei Kernel-Updates).
Beim Einloggen zeigt der Server an, ob ein Neustart erforderlich ist.

Jeder Dienst in <<Dienste>> enth√§lt einen Abschnitt ‚ÄûWartungshinweise‚Äú mit Update-Anleitungen.
Container-Images lassen sich manuell mit ((Docker Compose)) oder automatisch mit ((Watchtower)) aktualisieren.
Siehe <<Watchtower: Dienst-Updates>> f√ºr Details.

==== √úberwachung

Behalte die Server-Gesundheit im Blick.
Pr√ºfe den freien Speicherplatz mit df -h.
Wenn sich der Server tr√§ge anf√ºhlt, √ºberpr√ºfe die PSI (Pressure Stall Information) mit:

.check PSI (üöÄ server)
[source#check-psi,bash]
----
tail /proc/pressure/*
----

atop zeigt ebenfalls PSI-Werte an.
Wenn dein PSI-Check hohe Ressourcennutzung anzeigt, versuche docker stats, um die Ressourcennutzung pro Container zu sehen.
Das sollte dir helfen, das Problem auf bestimmte Dienste einzugrenzen.

Wenn du ZFS verwendest, kannst du zpool iostat verwenden, um Ein-/Ausgabe-Statistiken f√ºr deine Speicherpools zu sehen.

Auf Host-Ebene kannst du htop -d 100 verwenden, um Statistiken f√ºr alle Prozesse und Threads zu sehen.
Verfolge alle protokollierten Ereignisse f√ºr den Host mit journalctl -f.

==== Backups

N√ºtzliche Backups zu haben ist eine entscheidend wichtige Praxis, f√ºr die man selten Anerkennung bekommt, wenn sie gut gemacht ist ‚Äì aber immer Schuld, wenn sie schlecht gemacht ist.

√úberpr√ºfe regelm√§√üig deine Backups, um sicherzustellen, dass sie funktionieren.

(((ZFS, snapshots and)))
Erstelle konsistente Backups von allem auf deinem Server, sodass die laufenden Dienste nicht einmal bemerken, dass sie gesichert werden.
Beispiel: Erstelle einen ZFS-Snapshot und sichere diesen.

Backups mithilfe von ZFS-Snapshots k√∂nnen trotzdem Probleme verursachen.
ZFS garantiert beispielsweise keinen konsistenten Zustand der gesicherten Daten f√ºr laufende Programme.
Angenommen, du stellst eine MariaDB-Datenbank aus einem Backup wieder her.
Wenn du die Tabellen vor dem Erstellen des ZFS-Snapshots nicht geleert und gesperrt hast, k√∂nnte MariaDB gerade dabei gewesen sein, einen Schreibvorgang durchzuf√ºhren, mit Daten im Speicher, die noch nicht auf die Festplatte geschrieben wurden.
Sie m√ºsste sich dann selbst wiederherstellen, und die Daten, die MariaDB zu schreiben versuchte, k√∂nnten verloren gehen.
Diese Art von Datenverlust ist selten, und das Risiko ist f√ºr ein typisches Homelab akzeptabel.

[%unbreakable]
TIP: Erstelle ((Backups)) nach der 3-2-1-Faustregel:
Erstelle *3* Backups. Bewahre mindestens *2* lokale Kopien auf unterschiedlichen Medien auf.
Habe *1* externes (remote) Backup.

(((backups, using restic for)))
(((backups, using Borg for)))
(((Borg)))
(((restic)))
Ich empfehle eine Backup-Strategie, die ZFS-Snapshots mit entweder https://restic.net[restic] oder https://borgbackup.org[Borg] kombiniert, um die Daten extern zu sichern.
https://reddit.com/r/BorgBackup/comments/v3bwfg/[Hier ist ein guter Vergleich zwischen restic und Borg].

Hier sind einige Beispielbefehle, die zeigen, wie man ein ZFS-Dateisystem sichert.
Du kannst sie als Ausgangspunkt f√ºr dein eigenes Backup-Skript verwenden.

.example backup script (üöÄ server)
[source%unbreakable#example-backup-script,bash]
----
snapName=$(date -I)-backup

sudo zfs snapshot main/secure/data@$snapName <1>

sudo restic backup /data/.zfs/snapshot/$snapName <2>

sudo zfs destroy -R main/secure/data@$snapName
----

<1> Das Ausf√ºhren dieses Befehls zum Erstellen eines Snapshots dauert auf meinem Server 0,040 Sekunden.
Sobald er abgeschlossen ist, erscheint ein neuer schreibgesch√ºtzter Ordner unter /data/.zfs/snapshot, der den Snapshot enth√§lt.

<2> Diese Zeile setzt voraus, dass du restic installiert und konfiguriert hast.
Es kann deinen Snapshot extern sichern ‚Äì gem√§√ü der 3-2-1-Regel.

== mario

(((Ansible)))
((mario)) ist ein Tool, das ich entwickelt habe, um dir beim Einrichten und Warten eines Servers zu helfen.
Es ist im Wesentlichen ein Wrapper um das bew√§hrte https://ansible.com[Ansible-Systembereitstellungstool].
Alles, was ich mit mario mache, l√§sst sich auch manuell direkt auf dem Server erledigen.
Der Vorteil bei der Verwendung von mario ist jedoch, dass jede √Ñnderung (z.B. die Installation eines Pakets) konsistent und mit Pr√ºfprotokoll durchgef√ºhrt wird.
Der wahre Nutzen dieser Praxis zeigt sich vor allem bei der Zusammenarbeit mit anderen ‚Äì einschlie√ülich deinem zuk√ºnftigen Ich.
Es ist oft nicht leicht, sich ein Jahr sp√§ter noch zu erinnern, was man getan hat und warum.

Sobald dein Server online ist, wie unter <<OS-Installation>> beschrieben, kannst du mario verwenden, um Dienste zu konfigurieren und zu starten.

Bitte lade den Quellcode herunter (siehe <<Weitere Ressourcen>>).
Es ist hilfreich, ihn griffbereit zu haben, um beim Lesen mitverfolgen zu k√∂nnen.

mario befindet sich zusammen mit diesem Buch im Ordner `mario/`.
Das Skript `provision.sh` befindet sich im Verzeichnis `ansible/`.

=== mario-Philosophie

mario ist ein praktisches Lernwerkzeug.
Es bringt sinnvolle, getestete Standardwerte mit.
Es automatisiert einige der m√ºhsamen und verwirrenden Schritte beim Einrichten von Diensten auf einem Server.
mario ist kein unterst√ºtztes und produktionsreifes Softwareprodukt.
Es bringt dich an den Start, das ist alles.
Mach damit weiter, wenn du m√∂chtest ‚Äì oder nutze es einfach, um den Aufbau deiner pers√∂nlichen Cloud zu beschleunigen.
Etwas anderes erf√ºllt seine Aufgabe besser oder wird es in Zukunft tun.
Hier sind einige Vorschl√§ge, wie du das Beste aus mario herausholen kannst:

Beim ersten Ausf√ºhren von mario solltest du die Anweisungen so genau wie m√∂glich befolgen.
Es werden viele Annahmen getroffen, damit es ‚Äûout of the box‚Äú funktioniert, und es ist leicht anpassbar gedacht.

Die Konfigurationsdateien von mario sind deklarativ:
Sie enthalten den Zustand, in dem sich dein Server am Ende befinden soll ‚Äì nicht all die einzelnen Befehle, die du manuell ausf√ºhren w√ºrdest, um denselben Zustand zu erreichen.
marios `provision.sh` f√ºhrt Ansible aus, und Ansible f√ºhrt die Befehle f√ºr dich auf dem Server aus (z.B. ein chmod auf eine Datei) ‚Äì auf vorhersehbare und wiederholbare Weise.
Der gew√ºnschte Endzustand, wie in den Konfigurationsdateien deklariert, wird durch Ansible erreicht und best√§tigt.

(((idempotent)))
(((provision)))
Nachdem mario einmal erfolgreich eingerichtet wurde, solltest du es direkt nochmal ausf√ºhren!
Das Provisionieren mit mario ist beruhigend idempotent:
Das System √§ndert sich nicht mehr in bedeutender Weise, sobald der gew√ºnschte Zustand erreicht ist.
Sobald `provision.sh` erfolgreich abgeschlossen ist, kannst du es erneut ausf√ºhren, um zu best√§tigen, dass sich der Server weiterhin im gew√ºnschten Zustand befindet.
Dann kannst du anfangen zu experimentieren.
Einige Ideen findest du unter <<√úbungen>>.

Wenn du dich mit VMs auskennst und lieber damit arbeitest, kannst du zun√§chst eine VM erstellen und mario darauf ausf√ºhren, bis du bereit bist, mario auf deinen echten Server loszulassen.
Oder vielleicht _ist_ dein echter Server eine VM ‚Äì das funktioniert ebenso gut.

=== SSH Setup

mario l√§uft auf deinem ((Admin-Computer)) und erwartet, direkt per SSH eine Verbindung zu deinem Server herstellen zu k√∂nnen.
So bringst du das zum Laufen.

Weise zuerst der IP-Adresse deines Servers einen leicht zu merkenden Namen zu.
F√ºge mit der IP-Adresse aus <<OS-Installation>> eine Zeile wie diese in deine Hosts-Datei ein (z.B. /etc/hosts):

.line to add to hosts file (üè† Admincomputer)
[source%unbreakable#line-for-hosts,text]
----
192.168.1.100	mario_server
----

Best√§tige, dass du den Server unter dem Namen mario_server anpingen kannst.
So sieht es aus, wenn es funktioniert:

.test ping server (üè† Admincomputer)
[source%unbreakable#test-ping-server,text]
----
$ ping mario_server
PING mario_server (192.168.1.100) 56(84) bytes of data.
64 bytes from mario_server (192.168.1.100): icmp_seq=1 ttl=64 time=0.316 ms
64 bytes from mario_server (192.168.1.100): icmp_seq=2 ttl=64 time=0.535 ms
64 bytes from mario_server (192.168.1.100): icmp_seq=3 ttl=64 time=0.178 ms
^C
--- mario_server ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2041ms
rtt min/avg/max/mdev = 0.178/0.343/0.535/0.146 ms
----

Als N√§chstes soll dein SSH-Client beim Ausf√ºhren von ssh mario_server den richtigen Benutzernamen √ºbermitteln.
Hier ist eine Beispielkonfigurationsvorlage f√ºr den ((OpenSSH))-Client.
Ersetze your-username durch den Benutzernamen deines Serverkontos.

.customize OpenSSH client configuration (üè† Admincomputer)
[source%unbreakable#customize-openssh-client,text]
----
Host mario_server
  User your-username
----

Du kannst das in ~/.ssh/config einf√ºgen und bei Bedarf an deinen verwendeten SSH-Client anpassen.
Teste die Verbindung mit ssh mario_server.
Du wirst m√∂glicherweise so etwas sehen:

.SSH host fingerprint prompt (üè† Admincomputer)
[source%unbreakable#ssh-host-fing,text]
----
Die Echtheit des Hosts ¬ªmario\_server (192.168.1.100)¬´ kann nicht festgestellt werden.
Der ECDSA-Schl√ºssel-Fingerabdruck ist SHA256\:o2kUkvSP3JG9PTt/Ju11FWKkCpTJCB4rY3jQvImtRNw.
M√∂chten Sie die Verbindung wirklich herstellen (yes/no/\[fingerprint])?
----

Wenn die IP-Adresse korrekt ist, kannst du davon ausgehen, dass der Server im LAN, den du gerade erstellt hast, derselbe ist, mit dem du dich jetzt verbinden m√∂chtest.
Fahre fort mit `yes` und `Enter`.
Wenn du ganz sicher gehen willst, f√ºhre einen der folgenden Befehle auf dem Server aus und √ºberpr√ºfe, ob die Fingerabdr√ºcke √ºbereinstimmen:

.show SSH host public key (üöÄ server)
[source#show-ssh-host-pubkey,bash]
----
# use this if you saw "ECDSA key fingerprint..." earlier
ssh-keygen -lf /etc/ssh/ssh_host_ecdsa_key.pub

# use this if you saw "ED25519 key fingerprint..." earlier
ssh-keygen -lf /etc/ssh/ssh_host_ed25519_key.pub

# use this if you saw "RSA key fingerprint..." earlier
ssh-keygen -lf /etc/ssh/ssh_host_rsa_key.pub
----

Als N√§chstes richte die Authentifizierung mit √∂ffentlichem Schl√ºssel ein.
Wenn du ein Schl√ºsselpaar ben√∂tigst, erstelle eines mit `ssh-keygen` oder einem √§hnlichen Befehl auf deinem Admin-Computer.
Wenn du bereits ein Schl√ºsselpaar hast, verwende dieses.
Kopiere den √∂ffentlichen Schl√ºssel mit `ssh-copy-id` oder einem √§hnlichen Tool auf den Server.
Zum Beispiel:

.install SSH key on server (üè† Admincomputer)
[source%unbreakable#install-ssh-pubkey,text]
----
$ ssh-copy-id mario_server
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 2 key(s) remain to be installed -- if you are prompted now it is to install the new keys
mario2024@mario_server's password:

Number of key(s) added: 2

Now try logging into the machine, with:   "ssh 'mario_server'"
and check to make sure that only the key(s) you wanted were added.
----

Teste, ob bisher alles funktioniert, indem du `ssh mario_server` ausf√ºhrst.
Du solltest etwa Folgendes sehen:

.successful SSH to server (üè† Admincomputer)
[source#successful-ssh-to-server,text]
----
$ ssh mario_server
Welcome to Ubuntu 24.04 LTS (GNU/Linux 6.8.0-31-generic x86_64)

... snip ...

Last login: Fri May  3 16:44:52 2024 from 192.168.1.225
user@server:~$
----

=== Server bereitstellen

F√ºhre `provision.sh` auf deinem ((Admin-Computer)) aus (*nicht* auf deinem Server):

.mario first run (üè† Admincomputer)
[source%unbreakable#mario-first-run,bash]
----
cd mario/ansible
./provision.sh
----

Beim ersten Aufruf √ºberpr√ºft mario die Voraussetzungen und fordert dich auf, server¬≠spezifische Werte in eine Konfigurationsdatei einzugeben.

.mario first run output (üè† Admincomputer)
[source%unbreakable#mario-first-output,text]
----
You don't have a config file. I'll create one for you now.

Please edit 'config' and re-run this script.
----

Hier ist eine Anleitung zu den Einstellungen in deiner `config`, die du gegen√ºber den Standardwerten √§ndern musst. Lies dir auch unbedingt die Kommentare in dieser Datei durch. Ich gehe davon aus, dass du einen Domainnamen und einen DNS-Anbieter mit API-Zugang hast. Siehe <<Server-Domainname>> f√ºr Details, wie du diesen erh√§ltst.

`DNS_API_PROVIDER`::
Trage hier den Namen deines DNS-Anbieters ein (also des Anbieters, bei dem deine DNS-Eintr√§ge verwaltet werden).
mario konfiguriert Traefik so, dass es direkt mit deinem DNS-Server kommuniziert, um Let's-Encrypt-Zertifikate auszustellen.
Dein Domain-Registrar (wo du die Domain gekauft hast) ist nur relevant, wenn er auch dein DNS-Anbieter ist.
`NAMECHEAP_*`, `DUCKDNS_*`, `R53_DNS_*`, `DO_*`...::
Trage hier die Zugangsdaten *nur eines* Anbieters ein ‚Äì und zwar desselben Anbieters, den du in `DNS_API_PROVIDER` angegeben hast.
`DNS_RESOLVER_EMAIL`::
Gib hier eine E-Mail-Adresse an, die zu deinem DNS-API-Anbieter passt.
Unter dieser Adresse wirst du m√∂glicherweise von Let's Encrypt kontaktiert.
`MARIO_DOMAIN_NAME`::
Das ist ein Name wie `beispiel.duckdns.org` oder `beispiel.com`.
Einzelne Dienste werden darauf basierend benannt, z.B. `jellyfin.beispiel.com`.

Beende das Bearbeiten von `config` und f√ºhre anschlie√üend `provision.sh` erneut aus.
Dieser Durchlauf fragt dich nach dem Passwort, das du w√§hrend der <<OS-Installation>> festgelegt hast. Bei weiteren Durchl√§ufen ist das nicht mehr n√∂tig.
Die Ausgabe sollte in etwa so aussehen:

.mario second run output (üè† Admincomputer)
[source#mario-second-run,text]
----
BECOME password:

PLAY [all] *********************************************************************

TASK [base : Configure apt cache] **********************************************
ok: [mario_server]

TASK [base : Install packages] *************************************************
changed: [mario_server]

... snip ...

PLAY RECAP *********************************************************************
mario_server               : ok=21   changed=0    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0
----

Bei mir dauert der Vorgang ungef√§hr zehn Sekunden.
Im **Recap** werden bei einem vollst√§ndig eingerichteten System alle Aufgaben als `ok` angezeigt.
Einige Aufgaben werden mit `skipped` √ºbersprungen, bis Nextcloud zum ersten Mal gestartet wurde ‚Äì das kannst du vorerst ignorieren.

Wenn `provision.sh` ohne Fehler abgeschlossen wurde, konnte mario deinen Server und die Dienste erfolgreich einrichten.
Fahre direkt fort mit <<Dienste starten>>.

=== Server-Domainname

(((DNS)))
Dein Server braucht einen Namen.
Du erh√§ltst einen Domainnamen von einem Registrar und gibst diesen Hostnamen w√§hrend der <<OS-Installation>> ein.
Ich empfehle, einen einzigen Domainnamen zu verwenden und alle Dienste √ºber Subdomains zu benennen (z.B. `cloud.example.com`).
Du kannst entweder einen kostenlosen Domainnamen verwenden oder einen bei einem Registrar kaufen.
mario ben√∂tigt den Domainnamen, um einen DNS-Anbieter mit API zur Einrichtung der HTTPS-Verschl√ºsselung f√ºr den Webverkehr verwenden zu k√∂nnen.
Beachte, dass sich Registrar und DNS-Anbieter unterscheiden k√∂nnen.

Du m√∂chtest deinen Server vielleicht auch von unterwegs per Namen erreichen k√∂nnen, falls du WAN-Zugriff erlaubst und/oder eine dynamische WAN-IP-Adresse hast.
Frage bei deinem DNS-Anbieter nach, wie du entsprechende Eintr√§ge (z.B. `A`- und `CNAME`-Eintr√§ge) hinzuf√ºgen kannst.

==== √ñffentlicher DNS

Duck DNS bietet einen kostenlosen Domainnamen- und DNS-Dienst an.
mario funktioniert auch mit kostenpflichtigen Diensten wie Namecheap, DigitalOcean und Route 53.
Ich empfehle eine der kostenpflichtigen Optionen gegen√ºber Duck DNS.
Die Unterst√ºtzung weiterer DNS-Anbieter (hust, insbesondere selbstgehosteter!) k√∂nnte sp√§ter hinzugef√ºgt werden.

NOTE: √ñffentliche DNS-Eintr√§ge setzen keinen WAN-Zugriff voraus.
<<Digitale Sicherheit>> behandelt den WAN-Zugriff im Detail.

===== Duck DNS

Wenn du einen kostenlosen Domainnamen von einem Anbieter mit API m√∂chtest, kannst du dein Gl√ºck mit Duck DNS versuchen.

. Starte auf [https://duckdns.org](https://duckdns.org).
. Melde dich an und f√ºge eine Domain hinzu.

Deine Domain wird etwa so hei√üen: `blah.duckdns.org`.
Verwende dies anstelle von `example.com`, wo es passt ‚Äì z.B. `cloud.blah.duckdns.org` anstelle von `cloud.example.com`.

===== Amazon Route 53

Wenn du dich f√ºr Route 53 entscheidest, erstelle eine neue ‚ÄûHosted Zone‚Äú mit dem Domainnamen, den du besitzt.
Notiere dir die Route 53-Nameserver.
Gehe zur√ºck zu deinem Domain-Registrar und trage dort diese Nameserver ein.

Erstelle bei Amazon IAM einen Benutzer mit der Berechtigung, diese Hosted Zone zu aktualisieren.
Hier ist eine Richtlinie mit viel zu vielen Rechten, die aber dennoch funktioniert:

.naive Route 53 policy
[source%unbreakable#naive-r53-policy,json]
----
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "route53:*",
      "Resource": "*"
    }
  ]
}
----

==== Dynamisches DNS

Wenn du WAN-Zugriff m√∂chtest und sich deine IP-Adresse regelm√§√üig √§ndert, ist es praktisch, diese automatisch in den DNS-Eintr√§gen zu aktualisieren.
√Ñhnlich wie Traefik HTTPS-Zertifikate einrichtet, nutzt auch dieser Vorgang eine API deines DNS-Anbieters.
Es gibt verschiedene M√∂glichkeiten ‚Äì alle als √úbungen f√ºr die Leserin oder den Leser gedacht:
Eine M√∂glichkeit ist, einen dynamischen DNS-Client in einem Docker-Container bereitzustellen.
Solche Dienste sind in der Regel sehr einfach einzurichten.
Eine andere Idee ist, zu pr√ºfen, ob dein Router dynamische DNS-Updates direkt durchf√ºhren kann.

==== Interner DNS

Es ist praktisch, einen internen DNS-Server zu haben, um deinen Server per Namen ansprechen zu k√∂nnen.
Diese internen Namen sollten den √∂ffentlichen Namen entsprechen und auf ausschlie√ülich im LAN erreichbare, private IP-Adressen zeigen.
So kannst du innerhalb und au√üerhalb deines LAN dieselben Namen verwenden ‚Äì und deine Let's-Encrypt-Zertifikate funktionieren weiterhin.
Dein LAN-Router hat wahrscheinlich einen integrierten DNS-Server und erlaubt dir m√∂glicherweise, IP-Adressen Namen zuzuweisen.

Falls du keinen internen DNS-Server hast, kannst du weitere Hostnamen-zu-IP-Adressen-Zuordnungen anlegen ‚Äì so wie bereits im Abschnitt <<SSH Setup>> gezeigt.
Hier ist noch einmal die `hosts`-Datei:

// Das k√∂nnte auch eine einzelne Zeile mit einer IP-Adresse und mehreren Hostnamen sein.

.hosts file with service names (üè† Admincomputer)
[source%unbreakable#hosts-file-with-service-names,text]
----
# for provisioning from Admincomputer
192.168.1.100	mario_server

# for accessing services from Admincomputer
192.168.1.100	traefik.example.com
192.168.1.100	cloud.example.com
192.168.1.100	jellyfin.example.com
192.168.1.100	wallabag.example.com
192.168.1.100	scratch.example.com
----

Das manuelle Zuordnen von IP-Adressen zu Hostnamen mit einer Hosts-Datei ist hilfreich f√ºr die erste Einrichtung und Wartung, wenn dein interner DNS-Server ausf√§llt.
Denk daran, dass nur der Computer mit diesen spezifischen Zuordnungen die Namen verwenden kann.
Teste die Zuordnungen mit `ping` auf deinem Admin-Computer.

TIP: Ich habe Beispiele f√ºr zwei Arten von Dienst-Dom√§nennamen gezeigt.
`cloud.example.com` gibt die Funktion des Dienstes an, nicht den Markennamen des Dienstes.
`nextcloud.example.com` w√ºrde genauso gut funktionieren.
Die Wahl liegt bei dir.

=== Dienste starten

mario hat deinen Server so vorbereitet, dass er eine Handvoll Dienste ausf√ºhren kann.
Docker und Docker Compose sind installiert.
Docker-Konfigurationsdateien befinden sich in Verzeichnissen unter `/root/ops`.
Daten f√ºr Dienste befinden sich in Verzeichnissen unter `/data`.

Keiner der Dienste l√§uft bisher.
Gleich werden wir sehen, wie man sie einschaltet und benutzt.

Zuerst nehmen wir einen kleinen Schritt, um uns viel Tipperei zu ersparen.
Dienste werden mit Docker Compose gestartet und gestoppt, das immer mit `docker compose` aufgerufen wird.
Wenn du `docker compose` ausf√ºhrst, musst du dich zuerst in einem Ordner befinden, der eine Datei `compose.yml` enth√§lt.
Der Name dieses Ordners entspricht √ºblicherweise dem Namen des Dienstes.
Ein typisches Nutzungsmuster sieht so aus:

.start a service in its folder (üöÄ server)
[source%unbreakable#start-service-in-folder,bash]
----
sudo su -
cd /root/ops/traefik
docker compose up -d
----

Versuchen Sie, diese Methode zu vermeiden.
Je weniger Befehle Sie direkt als `root` ausf√ºhren, desto besser.
Ich empfehle stattdessen Folgendes:

.start a service, explicit configuration file (üöÄ server)
[source#start-service-explicit-config,bash]
----
sudo docker compose --file /root/ops/traefik/compose.yml up -d
----

mario installs a program called `dc` on the server to save you some typing:

.start a service with dc (üöÄ server)
[source%unbreakable#start-service-with-dc,bash]
----
# equivalent to
# sudo docker compose --file /root/ops/traefik/compose.yml up -d
dc traefik up -d
----

TIP: F√ºr einige Befehle, darunter `docker compose`, ist `sudo` erforderlich.
Das Skript `dc` f√ºhrt `sudo` automatisch f√ºr Sie aus.

==== Reverse-Proxy starten

(((Traefik)))
Richten Sie zuerst den ((Reverse-Proxy)) ein.
Starten Sie auf Ihrem Server Traefik mit `dc traefik up -d`.
Wenn das funktioniert hat, warten Sie ein bis zwei Minuten und besuchen Sie `\https://traefik.example.com` in einem Webbrowser, um das Traefik-Dashboard zu sehen.
W√§hrend Sie auf das Dashboard warten, k√∂nnen Sie die Logs mit `dc traefik logs -f` mitverfolgen.

Es kann ein bis zwei Minuten dauern, bis Traefik die Let's Encrypt-Zertifikate f√ºr die HTTPS-Verschl√ºsselung eingerichtet hat, also machen Sie sich keine Sorgen, wenn Sie anfangs Warnungen √ºber ung√ºltige Zertifikate sehen.
F√ºr einen funktionierenden Traefik-Dienst sollte in etwa Folgendes erscheinen:

// Das waren ziemlich lange Zeilen.
// Ich habe den Servicenamen gek√ºrzt, das Datum und "INF" (Info-Loglevel) entfernt und `https://acme-v02.api.letsencrypt.org/directory` durch eine Ellipse ersetzt.
// Au√üerdem habe ich diese Zeilen weggelassen:
//
// reverse-proxy-1  | 2024-05-04T10:03:01Z INF
// reverse-proxy-1  | Stats collection is disabled.
// reverse-proxy-1  | Help us improve Traefik by turning this feature on :)
// reverse-proxy-1  | More details on: https://doc.traefik.io/traefik/contributing/data-collection/
// reverse-proxy-1  |

.typical Traefik logs, edited for brevity (üöÄ server)
[source#typical-traefik-logs,text]
----
+ sudo docker compose --file /root/ops/traefik/compose.yml logs -f
rp-1 | Traefik version 3.0.0 built on 2024-04-29T14:25:59Z version=3.0.0
rp-1 | Starting provider aggregator aggregator.ProviderAggregator
rp-1 | Starting provider *traefik.Provider
rp-1 | Starting provider *docker.Provider
rp-1 | Starting provider *acme.ChallengeTLSALPN
rp-1 | Starting provider *acme.Provider
rp-1 | Testing certificate renew... acmeCA=... providerName=myresolver.acme
^Ccanceled
----

Wenn du eine Weile gewartet, die Seite neu geladen hast und dein Browser immer noch ung√ºltige Zertifikatswarnungen zeigt, wenn du versuchst, `https://traefik.example.com` zu besuchen, lies die Traefik-Logmeldungen sorgf√§ltig durch und sieh dir auch <<Verschl√ºsselungszertifikate>> f√ºr Schritte zur Fehlerbehebung an.
Sobald du das Dashboard sehen kannst, beende das Verfolgen der Traefik-Logs mit kbd:\[Strg+c].

==== Andere Dienste starten

Das Starten eines mario-Dienstes erfolgt immer mit dc SERVICE up -d, genau wie wir es mit Traefik gemacht haben.
Um alles auf einmal hochzufahren, kannst du dieses Shell-Skript verwenden:

.start all services ad-hoc Bash script (üöÄ server)
[source%unbreakable#start-other-services,bash]
----
for service in $(sudo ls /root/ops); do
    dc $service up -d
done
----

Dies wird auch Images abrufen und erstellen sowie Container bei Bedarf aktualisieren.
Dienste, die nicht mit ihrer compose.yml-Datei √ºbereinstimmen, werden neu gestartet.
Dies ist idempotent: Bereits laufende und aktuelle Dienste bleiben unver√§ndert.

=== Verschl√ºsselungszertifikate

(((HTTPS)))
(((encryption, HTTPS)))
Traefik installiert automatisch ((Let's Encrypt))‚Äì((Zertifikate)), um den HTTP-Datenverkehr zu verschl√ºsseln.
Die Zertifikate werden √ºber eine DNS-Challenge ausgestellt.
Diese Methode zur Authentifizierung einer Zertifikatsanfrage ist besonders praktisch f√ºr Server ohne √∂ffentlich erreichbare eingehende Ports und erm√∂glicht so bequemes HTTPS selbst in geschlossenen LANs.
Die DNS-Challenge wird √ºber Labels in der compose.yml-Konfigurationsdatei von Traefik eingerichtet.

(((SSL termination)))
Traefik kann HTTPS-Verbindungen annehmen, entschl√ºsseln und als unverschl√ºsseltes HTTP an Webdienste weiterleiten.
Dies nennt man *SSL-Termination* und wird in Traefiks `compose.yml` √ºber Zeilen mit `acme` konfiguriert.

Schau dir einmal die `compose.yml`-Datei eines beliebigen mit mario gelieferten Dienstes an.
Jeder Dienst hat im Router-Abschnitt eine `tls`-Sektion definiert, um HTTPS-Verschl√ºsselung und SSL-Terminierung zu aktivieren.

Falls beim Aufruf deiner Webdienste Zertifikatswarnungen erscheinen, pr√ºfe zuerst die Traefik-Logs wie in <<Reverse-Proxy starten>> beschrieben.
Um die Protokollausgabe von Traefik zu erweitern, √§ndere in der `compose.yml` von Traefik den Eintrag
`--log.level=INFO` zu `--log.level=DEBUG`, f√ºhre die Provisionierung erneut aus und starte Traefik neu.
Falls das Problem weiterhin besteht, √ºberpr√ºfe, ob DNS-Abfragen erfolgreich sind, da dies die DNS-Challenge beeinflusst.

.example DNS tests
[source#example-dns-tests,bash]
----
####
# Try these commands on both the Admincomputer and server.
# Replace dig (and its arguments) with your favorite DNS tool.
# Replace traefik.example.com with your Traefik service name.
####

# Look up Traefik on default DNS server.
# Should quickly return a LAN private IP address.
dig traefik.example.com

# Look up Traefik server name on Quad9 DNS.
# - @9.9.9.9 forces Quad9's DNS service.
# - +short uses terse output
# Should return nothing--we didn't set an IP address.
dig @9.9.9.9 +short traefik.example.com

# Fetch TXT record for Traefik.
# Contains a long unique string while Traefik is executing a
# DNS challenge and is otherwise not set.
dig traefik.example.com TXT
----

=== Kleiner Testdienst

Falls du bis hierher gekommen bist, probiere, einen Testdienst zu starten.
Das ist n√ºtzlich, um zu best√§tigen, dass das Netzwerk f√ºr Docker-Container auf deinem Host korrekt funktioniert.
Wenn Traefik bereits l√§uft, haben wir diese Best√§tigung eigentlich schon (weil Traefik f√ºr die DNS-Challenge Netzwerkzugriff ben√∂tigt),
aber es kann trotzdem ein praktisches Werkzeug f√ºr sp√§ter sein ‚Äì oder zumindest ein positiver Schritt in Richtung eigener n√ºtzlicher Dienste.

Dieser Testdienst demonstriert das Pingen eines √∂ffentlichen Servers.
Erstelle _auf deinem_ Server den Ordner: `~/ping/`.
Lege in diesem Ordner eine Datei `compose.yml` mit folgendem Inhalt an:

.tiny test service config (üöÄ server)
[source%unbreakable#tiny-test-service-config,yaml]
----
version: '3'

services:
  test:
    image: alpine
    command: ping example.com
----

Im Ordner `~/ping/` f√ºhre Befehl `sudo docker compose up` aus.
Dr√ºcke nach ein paar Sekunden kbd:[Strg+C].
Du solltest dann ungef√§hr so etwas sehen:

.start tiny test service (üöÄ server)
[source%unbreakable#start-tiny-test-service,text]
-----
$ cd ~/ping/
$ sudo docker compose up
[+] Running 2/2
 ‚úî Network ping_default   Created                                      0.1s
 ‚úî Container ping-test-1  Created                                      0.1s

Attaching to ping-test-1
ping-test-1  | PING example.com (93.184.216.34): 56 data bytes
ping-test-1  | 64 bytes from 93.184.216.34: seq=0 ttl=55 time=3.477 ms
ping-test-1  | 64 bytes from 93.184.216.34: seq=1 ttl=55 time=3.236 ms
ping-test-1  | 64 bytes from 93.184.216.34: seq=2 ttl=55 time=3.363 ms
^CGracefully stopping... (press Ctrl+C again to force)
Aborting on container exit...
[+] Stopping 1/1
 ‚úî Container ping-test-1  Stopped                                     10.4s
canceled
-----

[%unbreakable]
TIP: F√ºr Bonuspunkte kannst du deinen kleinen Testdienst in mario integrieren.

Das ist auch die Grundlage, um sp√§ter spannendere Dienste hinzuzuf√ºgen.
Nur ein paar zus√§tzliche Zeilen Code und Konfiguration reichen, um einen kleinen ((API))- oder Webdienst zu erstellen ‚Äì und mit ein paar weiteren Zeilen kannst du ihn √ºber deinen Reverse-Proxy ver√∂ffentlichen.

== Dienste

Jetzt kannst du die von mario bereitgestellten Dienste ausprobieren.
Dieses Kapitel behandelt, was sie bieten und wie du sie verwaltest.

[#purposes-of-default-mario-services]
.Verwendungszwecke der standardm√§√üigen mario-Dienste
|===
|Verwendungszweck |Siehe

|Dateien synchronisieren und freigeben, Groupware |<<Nextcloud: Dateisynchronisation und -Freigabe>>
|Musik und Heimvideos streamen |<<Jellyfin: Audio- und Videostreaming>>
|Artikel offline und ohne Ablenkung lesen |<<Wallabag: Artikel speichern und lesen>>
|Andere Dienste auf dem neuesten Stand halten |<<Watchtower: Dienst-Updates>>
|Programmieren mit visuellen Werkzeugen lernen |<<Scratch: visuelle Programmierung>>
|===

Diese speziellen Dienste sind nur ein kleiner Bruchteil derjenigen, die f√ºr das Self-Hosting verf√ºgbar sind.
Sie spiegeln die Vorlieben meiner Nutzerinnen wider (einschlie√ülich ‚Äì und √ºberproportional ‚Äì meiner eigenen) in den Bereichen Lesen, Teilen, Medien usw.
Wenn Sie diese Dienste zum Laufen bringen, bieten sie Ihren Nutzerinnen bereits n√ºtzliche Funktionen und dienen als guter Ausgangspunkt, um alles M√∂gliche selbst zu hosten.

Zu jedem Dienst finden Sie meine pers√∂nlichen Kommentare und Probleme, auf die ich gesto√üen bin.
Falls ich eine Funktion erw√§hne, die ich gern hinzugef√ºgt sehen w√ºrde, habe ich auch schon dar√ºber nachgedacht, sie selbst zu implementieren (oder jemanden davon zu √ºberzeugen, sie hinzuzuf√ºgen, oder Geld zu sammeln, um jemanden f√ºr die Umsetzung zu bezahlen).
Wenn ich auf einen geschlossenen Bug im Issue-Tracker verweise, liegt das daran, dass ich den Fehler getestet habe und er ‚Äì zum Zeitpunkt des Schreibens ‚Äì in einer offiziellen bzw. unterst√ºtzten Version, die angeblich die Korrektur enth√§lt, weiterhin auftritt.

Die mobile Nutzung ist bei den von mir betreuten Nutzer*innen hoch, daher war dies ebenfalls ein Auswahlkriterium.
Nextcloud, Jellyfin und Wallabag verf√ºgen √ºber mobile Apps und Integrationen, die ich h√§ufig verwende.

Die serverseitigen Befehle zur Verwaltung von Diensten sind standardisiert: Sie werden das Muster dc: SERVICE ACTION ARGS immer wieder sehen.

// this forced page break was originally just to improve the print PDF layout, but I find it doesn't hurt the screen PDF layout so I don't use an ifdef::shb-printPDF[]

<<<

=== Nextcloud: Dateisynchronisation und -Freigabe

(((Nextcloud)))
Eine Steadfast Personal Cloud ben√∂tigt bequeme Dateifreigabe und Synchronisierung.
Nextcloud ist aufgrund seiner Stabilit√§t und Popularit√§t eine ausgezeichnete Wahl.
Das Selbst-Hosting kann entmutigend wirken, aber mario macht es einfach und sogar spa√üig.

[#image-screenshot-nextcloud]
.Nextcloud Files-App-Screenshot mit Dateien, Ordnern und Teilen-Schaltfl√§chen.
image::nextcloud.png[align="center",scaledwidth=80%]

Ein gut gepflegter Nextcloud-Server bietet eine solide Grundlage f√ºr das ‚ÄûDe-Googlen‚Äú.
Nextcloud kann kostenlos selbst gehostet werden, wenn es √ºber mario installiert wird.
Sobald Sie Nextcloud zum Laufen gebracht haben, finden Sie unter <<Mehr √ºber Nextcloud>> viele meiner Gedanken dar√ºber, wie man es am besten anpasst.

[#nextcloud_quick_start]
==== Schnellstart

. Provisionieren Sie mit mario von Ihrem Admin-Computer.
. Starten Sie Nextcloud mit `dc nextcloud up -d` auf Ihrem Server.
. Rufen Sie `\https://cloud.example.com` auf Ihrem Admin-Computer auf.
. Folgen Sie der webbasierten Setup-Seite, um ein Admin-Konto zu erstellen.
. √úberspringen Sie die Installation der empfohlenen Apps.

==== MWartungshinweise

F√ºhren Sie `dc nextcloud pull && dc nextcloud up -d` auf Ihrem Server aus, um die Nextcloud-Service-Container zu aktualisieren und zu ersetzen.

==== Probleme

Siehe <<Verschiedene Probleme>>.

<<<

=== Jellyfin: Audio- und Videostreaming

(((Jellyfin)))
https://jellyfin.org[Jellyfin] ist ein pers√∂nlicher Streaming-Medienserver.
mario richtet einen grundlegenden Jellyfin-Server ein.

[#image-screenshot-jellyfin]
.Jellyfin-Screenshot mit Metadaten zu einem Film. Big Buck Bunny ist unter der Lizenz CC BY-3.0 von der Blender Foundation ver√∂ffentlicht.
image::jellyfin.png[align="center",scaledwidth=80%]

==== Schnellstart

. Provisioniere mit mario vom Admin-Computer aus.
. Starte Jellyfin mit `dc jellyfin up -d` auf dem Server.
. Navigieren zu `\https://jellyfin.example.com` auf dem Admin-Computer.
. Folgen den webbasierten Einrichtungsschritten.

(((Jellyfin, using a Grafikprozessor with)))
Wenn Sie √ºber eine Grafikprozessor verf√ºgen, sollten Sie sich die Hardwarebeschleunigung ansehen.
Wenn Sie √ºber eine Grafikprozessor verf√ºgen, sollten Sie sich die https://jellyfin.org/docs/general/administration/hardware-acceleration/[Hardwarebeschleunigung ansehen].
Diese ist n√ºtzlich, wenn Videos nicht direkt von einem Client abgespielt werden k√∂nnen und daher on the fly transkodiert werden m√ºssen.
Jellyfin kann zwar auch nur mit der Hauptprozessor transkodieren, mit einer Grafikprozessor geht es jedoch deutlich schneller.

[%unbreakable]
TIP: Jellyfin kann auch bestimmte CPUs mit integrierter Hardware-Transkodierung nutzen,
zum Beispiel Intel Quick Sync Video.

==== Wartungshinweise

F√ºhren Sie `dc jellyfin pull && dc jellyfin up -d` auf Ihrem Server aus, um den Jellyfin-Dienstcontainer zu aktualisieren und zu ersetzen.

==== Probleme

Hier sind einige Funktionen, die ich gerne in Jellyfin implementiert sehen w√ºrde.

===== Funktion: Geteilte Playlists

https://github.com/jellyfin/jellyfin/issues/6264#issuecomment-1338518980[Playlists sind automatisch privat].
https://features.jellyfin.org/posts/173/share-playlists[Ich mag die M√∂glichkeit sie zu teilen].

===== Funktion: Clips

Ich m√∂chte oft einen bestimmten Teil eines Mediums teilen, anh√∂ren oder erneut ansehen.
Es w√§re gro√üartig, wenn man https://features.jellyfin.org/posts/1036/bookmark-audio-video-segments[Clips] erstellen k√∂nnte, ohne tats√§chlich neue Mediendateien erstellen zu m√ºssen.

===== Funktion: Offline Medien mobil schauen

Ich m√∂chte eine Jellyfin-Mobile-App, die Medien automatisch zwischenspeichert und https://features.jellyfin.org/posts/218/support-offline-mode-on-android-mobile[Offline-Wiedergabe erm√∂glicht].

Workaround: Es gibt zwei separate Mobile-Apps, die Medien f√ºr die Offline-Wiedergabe herunterladen und zwischenspeichern k√∂nnen https://github.com/jmshrv/finamp[Finamp] f√ºr Musik und https://github.com/jarnedemeulemeester/findroid[Findroid]f√ºr Videos

==== Jellyfin-Medien mit Nextcloud verwalten

Jellyfin und Nextcloud laufen beide auf demselben Server.
Du kannst diese Tatsache nutzen, um ihre individuellen St√§rken als Dienste zu kombinieren, w√§hrend sie auf denselben Daten arbeiten, der eine als Media-Streamer und der andere als Medien-Dateimanager.
mario erstellt spezielle Musik- und Videoordner auf dem Server und stellt sie beiden Diensten zur Verf√ºgung.
Nextclouds ‚ÄûExternal Storages‚Äú erm√∂glicht es dir, Dateien in diese Ordner hochzuladen, und Jellyfin wird die hochgeladenen Dateien automatisch erkennen und das Streamen erm√∂glichen.

Nextclouds `compose.yml`-Datei hat den Eintrag `/data/shared/media/video:/data/video:rw` in volumes.
`/data/shared/media/video` ist der Pfad auf dem Server, der die eigentlichen Videodateien enth√§lt, `/data/video` ist der Ort, an dem sie im Container erscheinen, und `rw` bedeutet, dass Nextcloud Lese- und Schreibzugriff auf dieses Volume hat.
Es gibt einen weiteren √§hnlichen Ordner f√ºr Musikdateien.
Siehe <<Detailed setup>>, um zu erfahren, wie man sie in Nextcloud als ‚ÄûExternal Storages‚Äú hinzuf√ºgt.

In Jellyfins `compose.yml`-Datei findest du √§hnliche Zeilen zum Hinzuf√ºgen von Musik- und Video-Volumes, aber mit `ro` (f√ºr Read-Only) statt `rw`.
Jellyfin ben√∂tigt nur Lesezugriff auf die Ordner, um die darin enthaltenen Dateien streamen zu k√∂nnen.

Um die von Nextcloud verwalteten Mediendateien in Jellyfin anzuzeigen, f√ºge zwei Medienbibliotheken hinzu:

W√§hle den Inhaltstyp ‚ÄûMovies‚Äú, klicke auf das ‚Äû+‚Äú-Symbol neben ‚ÄûFolders‚Äú und w√§hle `/data/video`.

W√§hle den Inhaltstyp ‚ÄûMusic‚Äú, klicke auf das ‚Äû+‚Äú-Symbol neben ‚ÄûFolders‚Äú und w√§hle `/data/music`.

<<<

=== Wallabag: Artikel speichern und lesen

(((Wallabag)))
https://wallabag.org[Wallabag] speichert Artikel f√ºr offline Lesen ohne Ablenkungen. 

[#image-screenshot-wallabag]
.Wallabag screenshot der ungelesene Artikel in der Sammlung zeigt.
image::wallabag.png[align="center",scaledwidth=80%]

==== Schnellstart

. Mit mario von deinem Admincomputer bereitstellen.
. Starte Wallabag mit `dc wallabag up -d` auf deinem Server.
. Gehe auf `\https://wallabag.example.com` auf deinem Admincomputer.
. Melde dich als Benutzer wallabag mit dem Passwort wallabag an.
. Aktualisiere das Passwort f√ºr den Benutzer wallabag.

==== Wartungshinweise

F√ºhre auf deinem Server `dc wallabag pull && dc wallabag up -d` aus, um die Wallabag-Dienstcontainer zu aktualisieren und zu ersetzen.
Wenn Probleme auftreten, versuche, Datenbank-Upgrades manuell anzuwenden (siehe <<Bug: Upgrades machen alles kaputt>>).

==== Probleme

Hier ist ein Problem, das ich mit Wallabag habe, und eine Funktion, die ich mir w√ºnsche.

===== Bug: Upgrades machen alles kaputt

https://github.com/wallabag/wallabag/issues/6649[Datenbankmigrationen werden nicht (immer?) automatisch angewandt].
Es k√∂nnte noch andere doppelte oder verwandte Bugberichte f√ºr dasselbe Problem geben, das ist nur ein Beispiel.
Zum Gl√ºck kann man https://github.com/wallabag/docker#upgrading[das Problem einfach umgehen].

Wenden die Problemumgehung in einem mario system wie folgt an:

.force Wallabag database migration (üöÄ server)
[source%unbreakable#force-wallabage-db-migration,bash]
----
dc wallabag exec app /var/www/wallabag/bin/console \
  doctrine:migrations:migrate --env=prod --no-interaction
----

Der Befehl `exec` bedeutet, dass wir etwas in einem Container ausf√ºhren wollen.
Dies f√ºhrt das Dienstprogramm `console` im app-Service-Container aus.
Die zweite Zeile gibt an, dass notwendige Datenbankmigrationen (Schema- und Datenaktualisierungen) mit den `prod`-Einstellungen ohne interaktive Eingabeaufforderungen ausgef√ºhrt werden sollen.

Dies ist idempotent, wie Datenbankmigrationen sein sollten.
Nach dem ersten Durchlauf geben nachfolgende Durchl√§ufe aus: [OK] Already at the latest version.

Es ist unklar, warum diese Migration nicht automatisch w√§hrend eines Upgrades durchgef√ºhrt wird.
Vielleicht ist sie nur in speziellen F√§llen notwendig ‚Äì ich musste sie in den letzten Jahren nur zweimal ausf√ºhren.

===== Funktion: Inhalte mit anderen Nutzern teilen

I m√∂chte die M√∂glichkeit haben, https://github.com/wallabag/wallabag/issues/679[Inhalte mit anderen Wallabag Nutzern in Rahmen des Wallabag programs zu teilen].

<<<

=== Watchtower: Dienst-Updates

((Watchtower)) ist praktisch, um Ihre Docker-Container auf dem neuesten Stand zu halten.
Es erkennt und √ºberpr√ºft veraltete Container, l√§dt neue Images herunter und startet Dienste neu, um neue Container zu erstellen.

// Quelle: https://containrrr.dev/watchtower/images/logo-450px.png
// Erscheint an: https://containrrr.dev/watchtower/
// Die Lizenz der anderen watchtower teile ist Apache 2.0
// Dieses logo hat keinen Lizenztext.
// Dieses Logo-Bild besteht nur aus einfachen geometrischen Formen oder Text. Es erreicht nicht die n√∂tige Sch√∂pfungsh√∂he f√ºr einen urheberrechtlichen Schutz und ist daher gemeinfrei.
// Siehe https://commons.wikimedia.org/wiki/Commons:Threshold_of_originality
// und https://en.wikipedia.org/wiki/Public_domain

image::watchtower.png[align="center",scaledwidth=40%]

Wenn du niemals m√∂chtest, dass Container automatisch aktualisiert werden, f√ºhre Watchtower nicht aus.
Oder verwende die https://containrrr.dev/watchtower/arguments/[Konfigurationseinstellungen], um automatische Updates f√ºr bestimmte Container zu erlauben oder zu blockieren.
mario verwendet zum Beispiel ein Container-Label, um zu verhindern, dass Watchtower Scratch aktualisiert.

==== Schnellstart

. Provisioniere mit mario vom Admincomputer.
. Starte Watchtower mit `dc watchtower up -d` von deinem server.

From now on it'll run in the background, automatically upgrading containers whenever possible, on a reasonable schedule (every 24 hours by default).
You can forget about it until it breaks (or breaks something else).

==== Wartungshinweise

F√ºhre auf deinem Server `dc watchtower pull && dc watchtower up -d` aus, um den Watchtower-Service-Container zu aktualisieren und zu ersetzen.

==== Probleme

Es https://github.com/containrrr/watchtower/issues/90[f√ºhrt kein automatisches Rollback durch, wenn ein Container-Upgrade fehlschl√§gt].
Zugegeben, das w√§re schwierig umzusetzen.
Ein Dienst k√∂nnte zum Beispiel nur unidirektionale Datenbankmigrationen haben.
Ich denke, die Watchtower-Maintainer haben die richtige Entscheidung getroffen, automatische Rollbacks wegzulassen (wahrscheinlich, um Watchtower einfach zu halten).

Es kann passieren, dass ein Dienst durch Watchtower besch√§digt wird.
Wenn du den Verdacht hast und wei√üt, wann der Dienst kaputtging, versuche dies mit den Upgrades in `dc watchtower logs` zu korrelieren.
Ich vermeide das, indem ich Watchtower nur f√ºr nicht-kritische Dienste nutze.
Zum Beispiel lasse ich Watchtower meinen Nextcloud-Dienst nicht automatisch upgraden.

<<<

=== Scratch: visuelle Programmierung

((Scratch)) ist eine beliebte und sehr zug√§ngliche visuelle Programmiersprache, die auf interaktive Multimedia-Anwendungen und Lernen ausgelegt ist.
Die bekannteste https://scratch.mit.edu[√∂ffentliche Online-Version] bietet Teilen, Studios, Kommentare, Sterne, Herzen, endlose Memes und Spiele.
Diese ‚Äûsozialen‚Äú Funktionen k√∂nnen genau das sein, was ein Nutzer will/ben√∂tigt (z.B. ein bestehendes Projekt remixen und daraus lernen), oder sie k√∂nnen einen Nutzer unbeabsichtigt von produktiver Erstellung hin zu gedankenlosem Konsum umleiten (z.B. Doomscrolling).

Hier kommt deine neue Steadfast-Macht ins Spiel: Scratch kann selbst gehostet werden, ohne die sozialen Funktionen.
Tats√§chlich ist das die einfachste Art, es selbst zu hosten.
Dies ist eine gro√üartige Option, wenn deine Nutzer sich auf das Erstellen in Scratch konzentrieren und pers√∂nlich sozial interagieren m√∂chten. üòâ

[#image-screenshot-scratch]
.Scratch Screenshot eines neuen Projektes.
image::scratch.png[align="center",scaledwidth=80%]

Scratch ben√∂tigt keine persistenten Daten, keine Einrichtung und keine Authentifizierung.

==== Schnellstart

. Mit mario vom Admincomputer bereitstellen.
. Scratch auf deinem Server mit `dc scratch up -d` starten.
. Auf deinem Admincomputer zu `\https://scratch.example.com` navigieren.

==== Wartungshinweise

Scratch verwendet ein benutzerdefiniertes Docker-Image, daher ist der Upgrade-Prozess deutlich komplexer als bei anderen Diensten.
√ñffne zun√§chst das Scratch-`custom/Dockerfile` auf deinem Admincomputer.
Dieses `Dockerfile` befindet sich in einem Unterordner von `mario/ansible` im mario-Quellcode.

Wenn du das Image auf einer neueren Version von Node.js basieren lassen willst, besuche die https://hub.docker.com/_/node[Node.js-Seite auf Docker Hub] und w√§hle eine Version f√ºr die `FROM`-Zeile im `Dockerfile`.
Wenn du Scratch aktualisieren m√∂chtest, besuche die https://github.com/scratchfoundation/scratch-gui/releases[Releases-Seite] und w√§hle eine Version f√ºr `SCRATCH_VERSION` im `Dockerfile`.

F√ºhre `provision.sh` erneut auf dem Admincomputer aus.
Baue das Image auf dem Server mit `dc scratch build --pull` neu.
Schlie√ülich ersetze den Scratch-Dienstcontainer, indem du `dc scratch up -d` auf dem Server ausf√ºhrst.

== Wie geht‚Äôs weiter?

An diesem Punkt gehe ich davon aus, dass dein Server l√§uft und bereits einige Dienste eingerichtet sind.
Hier findest du ein paar Ideen, was du als N√§chstes ausprobieren kannst.

=== Mehr erfahren

Wenn dir dieses Buch gef√§llt und du mehr lernen und ausprobieren willst ‚Äì mach es.
Reite die Welle der Inspiration.
Suche sowohl nach Breite als auch nach Tiefe.

F√ºr die Breite solltest du nach einem umfassenden Buch √ºber Linux Ausschau halten, denn mario setzt Linux voraus, und ein besseres Verst√§ndnis von Linux hilft dir, deinen Server mit mehr Sicherheit anzupassen.
Es gibt keine spezifischen Abh√§ngigkeiten von Ubuntu, aber Ubuntu ist die einzige Linux-Variante, mit der mario zum Zeitpunkt des Schreibens ausf√ºhrlich getestet wurde.

Eines meiner ersten K√§ufe, als ich Linux endlich ‚Äûverstehen‚Äú wollte, war _UNIX: The Complete Reference, ein tausendseitiges Monstrum, das viele, viele Konzepte abdeckt.
Ich habe es in Abschnitten durchgearbeitet, oft als Nachschlagewerk benutzt, und niemals von vorne bis hinten gelesen.
Wenn ich heute noch einmal von Grund auf lernen w√ºrde, h√§tte ich immer noch ein solches Buch zur Hand ‚Äì zus√§tzlich zu Online-Ressourcen und Experimenten zu Hause.

F√ºr tieferes Wissen, tauche in die Grundlagen ein.
Lerne, wie ein Computer funktioniert.
Gehe √ºber Abstraktionen hinaus und arbeite dich Schritt f√ºr Schritt zu den ersten Prinzipien vor.
Besuche eine Informatik-Vorlesung in einem Bereich, der etwas unterst√ºtzt, das du ohnehin tun m√∂chtest.
Wenn du z. B. deine eigenen Webdienste programmieren willst, nimm an einer Veranstaltung zur Webprogrammierung teil.
Wenn du verstehen m√∂chtest, wie Quellcode den Computer dazu bringt, Dinge zu tun, belege eine Vorlesung √ºber Compiler.

Arbeite dieses Buch in einem Kurs oder einer kleinen Lerngruppe durch.
Siehe <<Diskussionsthemen>> und <<√úbungen>>.

Beteilige dich an ((FOSS))-Gemeinschaften, um von anderen zu lernen und Wissen weiterzugeben.
Gib das Gelernte weiter.
Melde einen Bug.
Schreibe in einem Forum.
Es macht Spa√ü!

(((SeaGL)))
Konferenzen wie https://seagl.org[SeaGL] bringen kluge K√∂pfe zu vielen Themen zusammen, auch zum Thema Self-Hosting.
Wenn du etwas Cooles gemacht hast, teile es!

=== Nutze einen Grafikprozessor

(((Grafikprozessor)))
Ein Grafikprozessor erm√∂glicht effizienteres Videotranscoding mit Jellyfin, reduziert die Hauptprozessor-Auslastung des Servers und beschleunigt das Videostreaming √ºber das Internet.

Auch ein FOSS-Sprachassistent w√ºrde von einem Grafikprozessor profitieren.

Eine Grafikprozessor kann au√üerdem Videotranscoding und Gesichtserkennung beschleunigen.

Moderne generative KI-Workloads wie Chat mit gro√üen Sprachmodellen oder Bildgenerierung laufen mit einem Grafikprozessor deutlich schneller.

=== KI

(((AI)))
KI ist mal wieder der letzte Schrei.
Man kann seine eigenen Bildgeneratoren und LLMs (Large Language Models) zu Hause laufen lassen.
Daf√ºr ist keine Grafikprozessor n√∂tig.
Hier ist ein compose.yml, das mit mario funktioniert, um https://localai.io[LocalAI] zu nutzen.

.Beispiel der LocalAI Dienst Konfiguration
[source#example-localai-svc,yaml]
----
version: '3.6'

services:
  api:
    image: quay.io/go-skynet/local-ai:latest
    environment:
      MODELS_PATH: /models
    volumes:
      - /data/localai/models:/models:cached
    command: ["/usr/bin/local-ai" ]
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.localai-https.entrypoints=websecure"
      - "traefik.http.routers.localai-https.rule=Host(`localai.example.com`)"
      - "traefik.http.routers.localai-https.tls.certresolver=myresolver"
      - "traefik.http.routers.localai-https.middlewares=lan-only"
    networks:
      - traefik_default
    restart: unless-stopped
networks:
  traefik_default:
    external: true
----

Beachte das Middleware-Setup, um nur Traffic aus deinem LAN zuzulassen.
Dabei wird angenommen, dass dein LAN Adressen im Bereich 192.168.1.* nutzt.
Au√üerdem wird ein entsprechendes Label am Traefik-Container erwartet, um die ((Middleware)) einzurichten, zum Beispiel:

.label from Traefik configuration allowing only LAN access
[source#lan-only-traefik-conf-line,yaml]
----
"traefik.http.middlewares.lan-only.ipallowlist.sourcerange=192.168.1.0/24"
----

TIP: Nutze mario um deinen LocalAI Dienst bereitzustellen.

Siehe die https://localai.io[LocalAI-Dokumentation] f√ºr weitere Hilfe beim Einrichten.
Sobald das l√§uft, kannst du die https://apps.nextcloud.com/apps/integration_openai[Nextcloud-AI-Integrations-App] als praktisches Frontend nutzen.

=== Pi-hole

(((Pi-hole)))
(((DNS)))
Ein https://pi-hole.net[Pi-hole]-Dienst im LAN hilft, Werbung, Tracker und b√∂sartige Akteure mithilfe von DNS-Blocklisten zu blockieren.

Clients (Laptops, Handys usw.) im Netzwerk verwenden den Pi-hole als ihren DNS-Server, meist √ºber die automatische DHCP- (Dynamic Host Configuration Protocol) Konfiguration durch den Router oder durch Pi-hole selbst (falls Pi-hole als DHCP-Server genutzt wird).

Der Pi-hole √ºbersetzt Domainnamen in IP-Adressen.
Wenn ein Domainname auf einer Blockliste steht, liefert er eine falsche IP-Adresse wie 0.0.0.0 zur√ºck.

Die Technik ist nicht perfekt, aber einfach und wirkungsvoll.

Mein Pi-hole-Server sitzt zwischen dem DNS-Server meines Routers und allen Clients.

ifdef::backend-html5,backend-pdf[]
[#image-DNS-traffic-diagram]
.Pi-hole DNS traffic flow diagram.
image::DNS-traffic-diagram.svg[align="center",scaledwidth=80%]
endif::[]
ifdef::backend-epub3[]
[#image-DNS-traffic-diagram]
.Pi-hole DNS traffic flow diagram.
image::DNS-traffic-diagram.png[,571,651,align="center"]
endif::[]

Abfragen f√ºr Domainnamen, die auf keiner Blockliste stehen, werden direkt beantwortet oder nach ‚Äûoben‚Äú weitergeleitet.
Ich habe meinen Pi-hole so eingerichtet, dass er Anfragen an meinen Heimrouter weitergibt, der seinerseits bei Bedarf einen DNS-Server au√üerhalb meines LAN befragt.

Es ist einfach, einzelne Domainnamen oder ganze Listen nach Bedarf zu blockieren.
Ich habe das als eine Art ‚ÄûImpuls-Blocker‚Äú genutzt, um den Kindern w√§hrend des Fernunterrichts Ablenkungen zu ersparen.

Der Pi-hole verwaltet au√üerdem eine Liste lokaler DNS-Eintr√§ge.
Ich f√ºge dort ein paar Domainnamen f√ºr Server innerhalb meines LAN hinzu.

Beachte, dass manche Clients standardm√§√üig einen automatisch konfigurierten DNS-Server wie Pi-hole umgehen.
Ein Beispiel ist https://support.mozilla.org/kb/firefox-dns-over-https[DNS anstatt HTTPS in Firefox].

=== Einmalanmeldung

(((Single sign-on)))
Es w√§re f√ºr Benutzer sehr praktisch, sich nur einmal einloggen zu m√ºssen, um Zugriff auf alle selbstgehosteten Dienste √ºber einen gemeinsamen, konsistenten und gut gestalteten Mechanismus zu erhalten (Single Sign-On).
F√ºr Systemadministratoren w√§re es ebenso hilfreich, alle Benutzer und Gruppen zentral an einer Stelle verwalten zu k√∂nnen (zentrale Identit√§tsverwaltung).

https://goauthentik.io[Authentik] ist ein Dienst, der dies bereitstellt und offenbar alle gew√ºnschten Funktionen bietet (Einmalanmeldung, eigene Benutzerdatenbank, Integration mit allen meinen selbstgehosteten Diensten).
Ich m√∂chte ihn ausprobieren und √ºber eine Weile stabil laufen sehen, bevor ich ihn in mario aufnehme.

Einige der anderen in <<Alternativen zu mario>> erw√§hnten Self-Hosting-L√∂sungen beinhalten bereits FOSS-L√∂sungen f√ºr zentrale Identit√§tsverwaltung.

=== Erzwinge SSH-Authentifizierung mit √∂ffentlichem Schl√ºssel

Manche Systemadministratoren entscheiden sich daf√ºr, f√ºr ((SSH))-Logins ausschlie√ülich die Authentifizierung mit √∂ffentlichen Schl√ºsseln zuzulassen.
Ich denke, https://security.stackexchange.com/q/3887[dass das eine gute Idee ist], wollte es dir aber nicht aufzwingen und habe es deshalb nicht in mario integriert.

Ich nutze dies hier als Gelegenheit, dir zu zeigen, wie man mario erweitert.
F√ºge diese Ansible-Task zu roles/base/tasks/main.yml hinzu:

.erzwinge SSH-Authentifizierung mit √∂ffentlichem Schl√ºssel (üè† Admincomputer)
[source#enforce-ssh-pubkey-auth,yaml]
----
# This does not affect logging in from a console (e.g. directly connected
# keyboard and monitor, or a virtual console).
- name: Disable tunneled clear text passwords
  copy:
    src: pka-only.conf
    dest: /etc/ssh/sshd_config.d/
    owner: root
    group: root
    mode: 0400
  notify:
    - restart sshd
----

F√ºge dies zu `roles/base/handlers/main.yml` hinzu:

.Ansible handler to restart SSH (üè† Admincomputer)
[source%unbreakable#ansible-ssh-restarter,yaml]
----
- name: restart sshd
  service:
    name: sshd.service
    state: restarted
----

Erschaffe `roles/base/files/pka-only.conf` mit:

.SSH server config lines (üè† Admincomputer)
[source%unbreakable#ssh-server-config,text]
----
PasswordAuthentication no
AuthenticationMethods publickey
----

F√ºhre abschlie√üend `provision.sh` erneut aus.
Ab jetzt erfordert dein Server f√ºr SSH-Logins die Authentifizierung per √∂ffentlichem Schl√ºssel

=== Erlaube Wan-Zugriff

mario blockiert ((Wan-Zugriff)) automatisch.
Lese <<Digitale Sicherheit>> und entscheide, ob du diese Funktion m√∂chtest oder nicht.
Du kannst diesen Schutz entfernen, indem du das `lan-only` ((middleware)) aus dem entsprechenden Traefik-Label des Routers entfernst.
Um zum Beispiel WAN-Zugriff auf Nextcloud zu erm√∂glichen, nimm diese √Ñnderung in der `compose.yml` von Nextcloud vor:

.patch for Wan-Zugriff to Nextcloud (üè† Admincomputer)
[source%unbreakable#open-wan-access,diff]
----
- traefik.http.routers.nc-https.middlewares=nc-head,nc-redir,lan-only
+ traefik.http.routers.nc-https.middlewares=nc-head,nc-redir
----

Bei Jellyfin kannst du ebenfalls die gesamte Zeile mit dem Verweis auf das `lan-only` ((middleware)) in der `compose.yml` von Jellyfin l√∂schen, wenn du diesen Dienst in deinem WAN verf√ºgbar machen m√∂chtest.

=== Mehr zu Nextcloud

Nextcloud ist ein zentraler Bestandteil meines Self-Hosting-Setups.
Ich wollte viele zus√§tzliche Details einf√ºgen, ohne <<Dienste>> zu √ºberladen, daher findest du diese zus√§tzlichen Abschnitte hier.

==== Grundinstallierung

(((Nextcloud, installing)))
Eine grundlegende (Standard-, nicht angepasste) Nextcloud-Installation bietet Fernspeicherung, -Organisation und -Freigabe von Dateien.
Sie verwaltet die tats√§chlichen Dateien und Ordner, die irgendwo gespeichert sind (lokal, remote, in der Cloud, wo auch immer), und verfolgt zus√§tzliche Metadaten √ºber diese Dateien und Ordner in einer Datenbank.
Du greifst √ºber einen Webbrowser darauf zu, und es gibt einen Desktop-Client, um Dateien lokal zu synchronisieren ‚Äì √§hnlich wie bei Dropbox, Google Drive und OneDrive.

Ich habe angefangen, der Dateisynchronisation mit der Nextcloud-Desktop-App wirklich zu vertrauen.
Wenn ich ein H√§kchen in meiner Desktop-App sehe, wei√ü ich, dass alles ordnungsgem√§√ü mit dem Server synchronisiert ist.
Ich erstelle und bearbeite st√§ndig Inhalte lokal und verlasse mich darauf, dass die Synchronisierung funktioniert (normalerweise auf meinem Desktop-Computer) oder erstelle und bearbeite Inhalte direkt in Nextcloud √ºber die Web-Oberfl√§che.

Es gibt auch Apps f√ºr mobile Ger√§te.
Darauf komme ich in den folgenden Abschnitten noch einmal zur√ºck.

==== Objektspeicher

Nextcloud kann ((Objektspeicher)) f√ºr die prim√§re Datenspeicherung verwenden.
Dies ist ein fortgeschrittenes Thema, das als √úbung f√ºr den Leser gedacht ist.
Ich gehe von einer prim√§ren Speicherung auf einer lokalen Festplatte aus, die von mario eingerichtet wurde.

==== Sicherheit

(((Nextcloud, security and)))
Eine grundlegende Nextcloud-Installation scheint √ºber eine hervorragende Sicherheit zu verf√ºgen.
Der Quellcode wird intensiv genutzt und wird von einem soliden Unternehmen unterst√ºtzt, dessen Ruf von seinem Engagement f√ºr Sicherheit abh√§ngt.
Sie machen es einfach, alles abzusichern und zu √ºberpr√ºfen (es ist schlie√ülich FOSS).
Die Standardeinstellungen scheinen sicher zu sein.
Sie befolgen Best Practices.
Sie haben ein √∂ffentliches Bug-Bounty-Programm und ein Bedrohungsmodell.

==== Detaillierte Einrichtung

Um die Reproduzierbarkeit deines Nextcloud-Servers zu best√§tigen, zerst√∂re ihn und erstelle ihn erneut (bevor du ihn wirklich verwendest).
Nachdem du ihn einmal zum Laufen gebracht hast, stoppe ihn mit `dc nextcloud down`.
Zerst√∂re alle persistenten Daten mit `sudo rm -rf /data/nextcloud`.
Das l√∂scht wirklich alles.
Stelle mit mario neu bereit (f√ºhre `provision.sh` erneut aus).
Folge erneut den Einrichtungsschritten, siehe <<nextcloud_quick_start>>.

Lese das offizielle Docs unter `/settings/help` oder https://docs.nextcloud.com.

F√ºge Apps unter `/settings/apps` hinzu.
Siehe <<Customization>> f√ºr Tipps, wie man Apps sinnvoll einf√ºhrt und welche sich lohnen.

Teste die Konfiguration eines Mailservers und das Versenden einer E-Mail unter `/settings/admin` (Basiseinstellungen).

F√ºge Benutzer unter `/settings/users` hinzu.

Pr√ºfe die Protokolle aller Container, die zu Nextcloud geh√∂ren, mit `dc nextcloud logs -f`.

√úberpr√ºfe die internen Nextcloud-Protokolle unter `/settings/admin/logging` in der Web-UI oder unter `/data/nextcloud/root/data/nextcloud.log` auf dem Server.
Diese enthalten spezifische interne Servermeldungen von Nextcloud und sind f√ºr mich oft n√ºtzlicher als die Container-Protokolle.

Wenn du unter `/settings/admin/logging` eine Warnung wie ‚Äû1 error in the logs since DATE‚Äú (oder vielleicht ein paar) siehst, kannst du sie wahrscheinlich ignorieren.
Diese anf√§nglichen Protokollfehler scheinen harmlos zu sein, m√∂glicherweise verursacht durch Race-Conditions w√§hrend der Installation.
Es ist trotzdem eine gute Idee, alle protokollierten Fehler zu √ºberpr√ºfen.

√úberpr√ºfe ‚ÄûSicherheits- & Einrichtungswarnungen‚Äú unter `/settings/admin/overview`.
Du kannst die Warnung ‚ÄûCould not check for JavaScript support. Please check manually if your webserver serves .mjs files using the JavaScript MIME type.‚Äú ignorieren, wenn dies auf deinem Admincomputer erfolgreich ist:

.JavaScript fetch test (üè† Admincomputer)
[source%unbreakable#js-fetch-admin,bash]
----
curl -I https://cloud.example.com/apps/settings/js/esm-test.mjs
----

Die Warnung tritt auf, weil der Nextcloud-`app`-Container https://github.com/nextcloud/server/issues/42989[bei einem Test fehlschl√§gt], bei dem versucht wird, eine JavaScript-Testdatei anzufordern ‚Äì vermutlich aufgrund eines DNS-Problems.
Um dies zu beheben, muss die Anfrage innerhalb des Nextcloud-`app`-Containers erfolgreich sein.

Mit anderen Worten: Folgendes muss erfolgreich sein (einen erfolgreichen HTTP-Response-Code zur√ºckgeben und den Header `content-type: text/javascript` enthalten):

.JavaScript fetch test (üöÄ server)
[source%unbreakable#js-fetch-server,bash]
----
dc nextcloud exec app \
  curl -I https://cloud.example.com/apps/settings/js/esm-test.mjs
----

Einige Wartungsarbeiten erfordern das tool `occ` (kurz f√ºr ‚ÄûownCloud command‚Äú).
F√ºhren Sie es mit `dc nextcloud exec --user www-data app php occ` aus.

F√ºgen Sie `/data/video` als externen Speicher hinzu.
Medien, die dort hochgeladen werden, erscheinen automatisch in Jellyfin.
Besuchen Sie zuerst `/settings/apps/featured` und installieren Sie die App ‚ÄûExternal storage support‚Äú.
Besuchen Sie anschlie√üend `/settings/admin/externalstorages` und installieren Sie die App ‚ÄûExternal storage support‚Äú.

* Ordnername: Video
* Externer Speicher: Local
* Authentifizierung: None
* Konfiguration: `/data/video`
* Legen Sie Benutzer, Vorschauen, Freigaben und die restlichen Optionen nach Wunsch fest.

F√ºgen Sie `/data/music` als externen Speicher hinzu, √§hnlich wie `/data/video`.

==== Weitere Wartungstipps

Besuchen Sie regelm√§√üig `/settings/admin/overview`, um nach System- und Sicherheitsproblemen zu suchen, die m√∂glicherweise manuelles Eingreifen erfordern.
F√ºhren Sie alle auf dieser Seite empfohlenen Wartungsma√ünahmen durch.
Ignorieren Sie den Abschnitt ‚ÄûUpdate‚Äú, er kann von Docker Hub abweichen.
Besuchen Sie regelm√§√üig `/settings/admin/logging`, um alle serverseitigen Protokollmeldungen zu √ºberpr√ºfen.

Das Ausf√ºhren von `dc nextcloud pull && dc nextcloud up -d` (auf dem Server) l√§dt das neueste Image von https://github.com/nextcloud/docker mit dem `stable`-Release-Tag herunter.
Die Verwendung dieses Tags ist f√ºr Sie und Ihre Benutzer wahrscheinlich stabil genug.
`stable` entspricht im Allgemeinen der Version, die unter https://docs.nextcloud.com/ als _previous_ bezeichnet wird.

Sie k√∂nnen Ihre Nextcloud auf eine spezifischere Version wie `27.1.5-apache` ‚Äûfixieren‚Äú.
Das gibt Ihnen die M√∂glichkeit, jedes Upgrade zu √ºberpr√ºfen und zu testen.
Sie k√∂nnen einen Release-Tag in der `compose.yml` von Nextcloud festlegen, indem Sie dort, wo der Image-Name erscheint, einfach `stable` durch den gew√ºnschten Tag ersetzen.
Alle verf√ºgbaren Tags sind auf https://hub.docker.com/\_/nextcloud\[Docker Hub aufgelistet].

NOTE: Die Blogposts und Marketingmaterialien von Nextcloud verwenden andere Versionsnamen als die Release-Versionen aus dem Quellcode.
‚ÄûHub 6‚Äú im Blog bezieht sich auf Versionen `27.\_._` im Quellcode, ‚ÄûHub 7‚Äú auf `28.\_._` und so weiter.

===== Ver√∂ffentlichungsrhythmus

(((Nextcloud, release cadence of)))
https://docs.nextcloud.com/server/stable/admin_manual/release_schedule.html[Eine Hauptversion wird alle vier Monate ver√∂ffentlicht].
Die Nextcloud-Apps, die f√ºr mich wichtig sind, scheinen mit diesem Tempo Schritt zu halten, aber es kommt mir etwas ehrgeizig vor.
Entwickler m√ºssen ihre Apps bei jeder Version zumindest leicht anpassen, oder stark, wenn es zu API-√Ñnderungen kommt, die nicht abw√§rtskompatibel sind.
Zum Gl√ºck https://help.nextcloud.com/t/new-process-for-documenting-core-code-changes-that-affect-app-developers/149828/1[dokumentiert das Nextcloud-Team √Ñnderungen sorgf√§ltig], um die Wartung der Apps f√ºr Entwickler zu erleichtern.

Als _Steadfast_-Sysadmin solltest du unbedingt vor einem Upgrade von Nextcloud die Seite `/settings/admin/overview` pr√ºfen, um sicherzustellen, dass alle von dir genutzten Apps mit der neuen Version kompatibel sind.
Du kannst eine veraltete App mit der Option ‚ÄûNicht getestete App aktivieren‚Äú unter `/settings/apps` trotzdem freischalten.
Manchmal funktioniert das.

Da mir vier Monate wie ein kurzer Zeitraum f√ºr Hauptversionen vorkamen, habe ich dazu einen https://help.nextcloud.com/t/major-release-cadence/161685[Thread gestartet].
Pr√ºfe den https://github.com/nextcloud/server/wiki/Maintenance-and-Release-Schedule[Wartungs- und Ver√∂ffentlichungsplan], um sicherzustellen, dass deine aktuelle Version noch unterst√ºtzt wird.

====Performance

Wenn du mario verwendest, um Nextcloud bereitzustellen, startest du mit einem nominal leistungsf√§higen Server, der f√ºr eine kleine Anzahl von Nutzern geeignet ist ‚Äì vorausgesetzt, du hast ausreichende Hardware-Ressourcen.
mario enth√§lt eine vom Autor gepr√ºfte Auswahl der https://docs.nextcloud.com/server/stable/admin_manual/installation/server_tuning.html[empfohlenen Server-Tuning-Schritte].

In all den Jahren, in denen ich Nextcloud gehostet habe, hatte ich nur ein einziges Performance-Problem (Toi,toi,toi!), das ich hier erw√§hnen m√∂chte.
Ich bemerkte langsame Webanfragen zusammen mit https://github.com/nextcloud/server/issues/35311[viel Datenbankaktivit√§t].
Dadurch musste ich mich eine Weile intensiver mit MariaDB besch√§ftigen.
https://github.com/nextcloud/server/pull/33540[Die Ursache wurde inzwischen behoben], sodass dies f√ºr neue Installationen kein Problem mehr darstellt.

==== Customization

(((Nextcloud, apps for)))
Nextcloud kann entweder so verwendet werden, wie es ist (siehe <<Grundinstallierung>>), oder stark angepasst werden.
Der einfachste und sicherste Weg zur Anpassung ist die Installation einer App aus dem integrierten App-Store (`/settings/apps`), besonders wenn eine App als ‚Äûfeatured‚Äú markiert ist.
Diese Nextcloud-Apps werden auf dem Server installiert und erweitern die Funktionalit√§t einer Basis-Nextcloud-Instanz.

Hier sind einige Nextcloud-Apps, die ich ausprobiert habe, was sie tun und eine Einsch√§tzung, ob sie einen Versuch wert sind.
Interpretiere ‚ÄûLohnt es sich?‚Äú hier eher als: ‚ÄûAdam hat diese App vielleicht ausprobiert und teilt seine Meinung dar√ºber, ob andere es lohnenswert finden k√∂nnten, sich die M√ºhe zu machen, sie zu erlernen und zu pflegen. Diese Einsch√§tzung basiert auf seinen eigenen Erfahrungen, die m√∂glicherweise nicht ganz zu deinen Anwendungsf√§llen passen.‚Äú
Mit anderen Worten: Mit Vorsicht genie√üen.
Im Zweifelsfall: klein anfangen (Standard-Nextcloud-Installation) und neue Apps nur behutsam und durchdacht einf√ºhren.

[cols="1,1,2",id=nextcloud-apps-commentary]
.Kommentare zu Nextcloud Apps
|===
|Nextcloud App |Verwendungszweck |Lohnt es sich?

|Antivirus for files |Virenscan der Uploads |*Ja*. Note: https://github.com/nextcloud/files_antivirus/issues/219[Von Desktop Clients hochgeladene Dateinen werden nicht auf Viren durchsucht].
|Analytics |Metriken erfassen und grafisch darstellen |*Ja*. Aber nur f√ºr kleine/einfache Anwendungen
|Appointments |Einfache Terminplanung durch Drittanbieter |*Ja*. Erfordert sorgf√§ltige Kalenderpflege. Etwas kompliziertes Setup.
|Calendar |Termine und Meetings verwalten |*Ja*. Siehe auch: <<Fehlerhafte Aktualisierungsbenachrichtigungen f√ºr Termine>>.
|Circles |Benutzer beliebig gruppieren |*Keine Meinung*. Ich habe nicht gen√ºgend Nutzer um diese App zu rechtfertigen.
|Collectives |Wiki oder Wissensdatenbank |*Vielleicht*. Scheint n√ºtzlich, um zusammenh√§ngende Dokumente zu organisieren. Erfordert Circles.
|Cookbook |Rezepte verwalten |*Ja*. Kann gut von Webseiten importieren, (dank der standardisierten Rezeptdaten, die bereits im HTML-Quelltext vorhanden sind). Ich w√ºnschte, es k√∂nnte besser drucken/exportieren.
|Contacts |Adressbuch |*Ja*.
|Dashboard |Startseite |*Nein*. Ich gehe lieber direkt zu meinen Dateien.
|Deck |Kanban-Board |*Keine Meinung*. Ich habe es ein bisschen ausprobiert und es hat funktionier, aber ich nutze Kanban einfach nicht oft.
|Draw.io |Diagramm-Editor |*Ja*.
|Duplicate Finder |Doppelte Dateien finden und l√∂schen |*Nein*. Langsam und undurchsichtig. Ich empfehle stattdessen https://github.com/pauldreik/rdfind[rdfind].
|Electronic Signatures |Elektronische Signaturen |*Nein*. Erfordert extrene Dienste. Ich bevorzuge gezeichnete Unterschriften. Siehe <<Gezeichnete Unterschriften in Formularen>>.
|End-to-End Encryption |Verschl√ºsselt Dateien auf Seiten des Servers, entschl√ºsselt sie beim Client |*Nein*. Nervenaufreibend fehleranf√§llig. Verwirrend. Siehe <<Ende-zu-Ende-Verschl√ºsselung>>.
|Files |Dateiverwaltung und -freigabe|*Ja*, aber das ‚ÄûVersions‚Äú-Tab ist nicht wirklich hilfreich.
|Forms |Alternative zu Google Forms |*Ja*.
|Full text search |Volltextsuche durch alle Dokumente |*Vielleicht*. Schnell. Fehleranf√§llig. Wahrscheinlich ein inaktives Projekt. Siehe <<Volltextsuche>>.
|Holiday Calendars |√ñffentliche Feiertage einfach hinzuf√ºgen |*Ja*. Die Konfiguration f√ºr diese App erscheint bei mir unter ‚ÄöPers√∂nlich‚Äò -> ‚ÄöVerf√ºgbarkeit‚Äò, nicht unter ‚ÄöGroupware‚Äò (obwohl die URL `/settings/user/groupware` lautet).
|Maps |Karten und Navigation |*Ja*. Mache dir eine Tasse Tee solltest du viele Fotos mit GPS-Koordinaten haben.
|Mail |Email |*Keine Meinung*. Ich habe es kurzzeitig ausprobiert aber es ist an meinen abermillionen von Gmail Nachrichten erstickt. Und ja, eines Tages m√∂chte ich von Gmail weg.
|Memories |Fotos |*Ja*. Ben√∂tigt Photos.
|News |Verfolge Blogs & Nachrichten √ºber RSS/Atom-Feeds |*Ja*.
|Nextcloud Office |Berarbeite Tabellen, Pr√§sentationen, usw. |*Ja*. Ich finde es nicht super, brauche es aber. Vielleicht ist das ein "Nein"? Mobile-Apps hierf√ºr sind schrecklich. Siehe <<Nextcloud Office>>.
|Notes |Einfache Notizen mit Markdown |*Ja*. ES gibt eine grossartige Mobile-App. Hat Google Notes f√ºr mich ersetzt.
|Passwords |Passwortmanager |*Nein*. Inaktiv.
|PhoneTrack |Standorte teile und verfolgen |*Ja*. Die Benutzeroberfl√§che ist reich an Funktionen und kompliziert. Die Fortbewegungslininen sind cool.
|Photos |Fotos, irgenwie |*Nein*. Langsam, schwerf√§llig, im Vergleich zu anderen FOSS Fotomanagern fehlen Funtionen. Nutze stattdessen Memories. Beachte dass Memories von Photos abh√§ngig ist.
|Polls |Einfache Umfragen |*Ja*.
|Ransomware protection |Warnt beim Hochladen vor gef√§hrlichen Dateinamen |*Nein*. Zu viele Fehlalarme. Nicht gepflegt.
|Recognize |Gesichtserkennung |*Nein*.
|Suspicious login |Warnt vor verd√§chtigen IPs |*Nein*. Zu viele Fehlalarme.
|Tasks |Aufgaben/To-Do's |*Ja*.
|Tables |Tabellarische Dateneingabe |*Nein*. Noch nicht bereit, k√∂nnte aber eine potenziell starke und n√ºtzliche ((low-code)) Plattform werden.
|Talk |Video- und Textchat |*Nein*. Funtioniert, aber nicht so gut wie andere Video- und Textchat Dienste/Apps. Ich nutze es jedoch f√ºr mein H√ºhner-Sicherheitssystem und sehe, dass es sich mit jeder Verion stark verbessert. Im Moment empfehle ich https://signal.org[Signal].
|Temporary files lock |Verhindert Bearbeitungskonflikte |*Ja*.
|Text |Bearbeite Textdokumente |*Ja*. Ich bin gro√üer Fan von reinen Markdown Textdokumenten, und Nextcloud kann gut mit diesen umgehen. Es hat einen guten webbasierten collaborativen Editor. Ich f√ºge gerne Rich-Text in den Editor ein und lasse ihn den Text automatisch in Markdown umschreiben. Siehe auch: <<Mobile Textbearbeitung ist schwierig>> und <<Fehlerhafte Konflikte im Web-Texteditor>>.
|Video converter |Video-Transkodierung |*Nein*. Coole Idee aber das Projekt scheint inaktiv.
|===

==== Volltextsuche

(((Nextcloud, full text search and)))
Diese App erm√∂glicht es, den gesamten Inhalt aller Dokumente auf deinem Server zu durchsuchen.
Die Suchsyntax ist schwer korrekt anzuwenden.
Sie https://github.com/nextcloud/fulltextsearch/issues/601[nutzt sehr viel Hauptprozessorkapazit√§t] und ben√∂tigt auch viel Speicher.

Die GitHub-Projekt-Repositories sind ziemlich ruhig. Siehe:

* https://github.com/nextcloud/fulltextsearch/pulse
* https://github.com/nextcloud/files_fulltextsearch/pulse
* https://github.com/nextcloud/fulltextsearch_elasticsearch/pulse

==== Mobile

(((Nextcloud, mobile and)))
Nextcloud funktioniert gut als Backend f√ºr ein mobiles Ger√§t.
Es kann deine einzige verl√§ssliche ‚ÄûQuelle der Wahrheit‚Äú f√ºr Kontakte, Kalender, Aufgaben und fast alles andere sein, was auf dem Handy wichtig ist.
Du kannst Dateien √∂ffnen und bearbeiten, aber die Benutzeroberfl√§che/UX ist schlecht.
Siehe <<Mobile Textbearbeitung ist schwierig>> f√ºr ein paar Problemumgehungen.

Neben der prim√§ren mobilen App (einfach ‚ÄûNextcloud‚Äú genannt) gibt es weitere mobile Apps, die mit Nextcloud-Apps zusammenarbeiten.
Hier sind die, die ich empfehle.
Ich habe kein iPhone, daher handelt es sich nur um Android-Apps.

[cols="1,1,2",id=recommended-nextcloud-mobile-apps]
.Nextcloud Mobile-App Empfehlungen
|===
|Mobile-App |Funtioniert mit diesen Nextcloud Apps |Weitere Infos

|DAVx5 |Calendar, Contacts, Tasks |https://davx5.com
|Maps Geofavorites |Maps |https://github.com/penguin86/nextcloud-maps-client
|NC Passwords |Passwords |https://gitlab.com/joleaf/nc-passwords-app
|Nextcloud Cookbook |Cookbook |https://github.com/nextcloud/cookbook
|Notes |Files, Notes, Text |https://github.com/nextcloud/notes-android
|OpenTasks |Tasks |https://github.com/dmfs/opentasks
|Nextcloud Talk |Talk |https://apps.nextcloud.com/apps/spreed
|===

Android-Ger√§te werden in der Regel mit ((Groupware))-Apps (Kalender und Kontakte) ausgeliefert, oder du kannst deine bevorzugten Apps installieren.
DAVx5 √ºbernimmt die Synchronisierung von Groupware-Daten zwischen deinem Ger√§t und dem Server.
DAVx5 ist nur auf Android erforderlich, vermutlich weil iOS besseren nativen WebDAV-Support hat.
Auf Murena-Handys (/e/ OS) wird DAVx5 nicht ben√∂tigt.

Es gibt tats√§chlich zwei Cookbook-Apps.
Beide funktionieren f√ºr mich gut.
Ich bin nicht w√§hlerisch, ich muss nur die Zutaten und Zubereitungsschritte sehen.
Die Version von ‚ÄûTeifun2‚Äú scheint beliebter zu sein.

Maps Geofavorites erm√∂glicht es dir, beliebige GPS-Koordinaten in der Nextcloud-Maps-App einfach zu speichern.
Praktisch, um sich zum Beispiel zu merken, wo du dein Fahrrad geparkt hast.

Notes funktioniert am besten, wenn es im Rasteransichtsmodus (Grid View) konfiguriert ist.

Talk‚Ä¶ trotz meines eigenen Ratschlags benutze ich Talk trotzdem.
Ich mag es, meinen eigenen Chat-Server zu haben, sch√§tze ich.
Ich erw√§hne es hier, weil ich es tats√§chlich nutze, und um mich zu beschweren, dass ich https://github.com/nextcloud/talk-android/issues/217[Nachrichten offline nicht lesen kann].
Es befindet sich au√üerdem in aktiver Weiterentwicklung und verbessert sich mit jeder Version deutlich.

Dies sind nur einige Beispiele.
Da du alle deine Daten hast und Nextcloud stets offene Formate nutzt, kannst du von Verbesserungen profitieren und das genie√üen, was am besten funktioniert.
Zum Beispiel habe ich gerade angefangen, https://github.com/jonasoreland/runnerup[RunnerUp] zu verwenden.
Wenn ich meine Tracks in Nextcloud speichere, erscheinen sie automatisch in Maps.
Super!

==== Nextcloud vs. ownCloud

(((Nextcloud, ownCloud vs.)))
Auf den ersten Blick ist es etwas schwierig, den Unterschied zwischen Nextcloud und ((ownCloud)) zu erkennen.
Das liegt daran, dass Nextcloud als Gabelung von ownCloud entstanden ist.

Warum sollte man also das eine dem anderen vorziehen?
Ein gesundes FOSS-Projekt ist in der Regel auch ein aktives Projekt. Eine M√∂glichkeit, deine Entscheidung zu treffen, besteht darin, die Aktivit√§tsmetriken auf GitHub zu vergleichen.
Siehe https://github.com/owncloud/core/pulse[owncloud/core Aktivit√§t] und https://github.com/nextcloud/server/pulse[nextcloud/server Aktivit√§t].
Anhand dieser beiden Metrik-Sets scheint Nextcloud zu florieren, w√§hrend ownCloud an Bedeutung verliert.

Eine andere Interpretation ist, dass ownCloud eine kleinere und langsamer voranschreitende Kerncodebasis hat.
F√ºr einen wirklich fundierten Vergleich w√§re jedoch noch mehr Arbeit n√∂tig.

Siehe auch: <<Merkmale-guter-Dienste>> und <<Merkmale-schlechter-Dienste>> unter <<Dienstwahl>>.

==== Nextcloud Office

(((Nextcloud, office and)))
https://nextcloud.com/office/ gibt deutliche Hinweise darauf, wie das Unternehmen hinter Nextcloud m√∂chte, dass wir ‚ÄûOffice‚Äú und seine Pl√§ne als Suite verwandter Werkzeuge verstehen.
Sie beabsichtigen eindeutig ein ganzheitliches, integriertes Office-Erlebnis, und Nextcloud kann so konfiguriert werden, dass es auf diese Weise genutzt wird.
https://nextcloud.com/office/ behandelt die kollaborative Bearbeitung von Office-Dokumenten (Textdokumente und Tabellen) sowie die Nutzung der Apps Notes, Collectives und Tables.
Es liefert einige clevere und n√ºtzliche Ideen f√ºr Arbeitsabl√§ufe.

Angesichts dieses weiten Umfangs sollte ((Groupware)) ebenfalls Teil von ‚ÄûOffice‚Äú sein. Konzentrieren wir uns daher vorerst speziell auf die kollaborative Bearbeitung von Office-Dokumenten.
Dies innerhalb von Nextcloud zu realisieren, erfordert eine App namens https://apps.nextcloud.com/apps/richdocuments[Nextcloud Office] sowie einen separaten Backend-Dienst, entweder ((Collabora)) oder ((ONLYOFFICE)).
Meine klare Pr√§ferenz liegt bei Collabora, im Einklang mit <<Geeignet f√ºrs Self-Hosting>>; trotz weniger GitHub-Sterne scheint die Entwicklung von Collabora zu florieren, w√§hrend ONLYOFFICE stagniert (obwohl schwer zu sagen ist, welche der vielen ONLYOFFICE-Repositories auf GitHub hier relevant sind).

==== Verschiedene Probleme

HHier ist eine Auswahl meiner liebsten Fehlerberichte und Funktionsanfragen f√ºr Nextcloud.

===== Ladesymbol auf Mobilger√§ten

Wenn du die Nextcloud-Mobile-App zum ersten Mal √∂ffnest, erscheint ein Ladesymbol vor einer zwischengespeicherten Ansicht der Dateien und Ordner, die beim letzten Gebrauch der App vorhanden waren.
Wenn du es ignorierst und tippst, um in einen Ordner zu navigieren oder eine Datei zu √∂ffnen, k√∂nntest du versehentlich einen anderen Ordner oder eine andere Datei ausw√§hlen, als du beabsichtigt hattest, da sich die Reihenfolge der Ordner w√§hrend du auf den Bildschirm tippst √§ndern kann.

Problemumgehung:

* Warte, bis das Ladesymbol verschwunden ist (bei mir dauert das normalerweise etwa eine Sekunde).
* Verringere die Wahrscheinlichkeit von Umordnungen, indem du ‚ÄûA ‚Äì Z‚Äú oder ‚ÄûZ ‚Äì A‚Äú sortierst, anstatt ‚ÄûNeueste zuerst‚Äú oder ‚Äû√Ñlteste zuerst‚Äú.

===== Mobile Textbearbeitung ist schwierig 

(((Nextcloud, mobile and)))
Nextcloud macht es einfach, auf deine Daten √ºber mobile Ger√§te zuzugreifen, aber das Bearbeiten ist m√ºhsam.

Das ist kein ausschlie√üliches Nextcloud-Problem; ich finde die gesamte Texteingabe und -bearbeitung auf Mobilger√§ten umst√§ndlich.
Das betrifft E-Mails, einfachen Text, Markdown und Office-Dokumente.

In der Nextcloud-Welt gibt es eine Problemumgehung, um die Eingabe von einfachem Text und Markdown zu verbessern: die https://github.com/nextcloud/notes-android[Notes-App f√ºr Android] oder f√ºr https://github.com/nextcloud/notes-ios[iOS].
Sie haben getrennte Bearbeitungs- und Anzeigemodi und eine aggressivere Synchronisierung.
Mit Notes hast du bessere Chancen auf aktuelle Daten und weniger Konflikte.

Du kannst auch https://github.com/gsantner/markor[Markor] nutzen, um dieses Problem zu umgehen.
Installiere die App, und mache dann Folgendes:

. In der Nextcloud-Mobile-App kannst du die Datei, die du lokal anzeigen oder bearbeiten m√∂chtest, herunterladen (‚ÄûDownload‚Äú) oder synchronisieren (‚ÄûSync‚Äú).
Dadurch wird eine Kopie auf deinem Smartphone zwischengespeichert.
. In der Nextcloud-App w√§hlst du dann ‚Äûopen with‚Äú f√ºr die Datei.
Sie sollte sofort ge√∂ffnet werden.
. Wenn du √Ñnderungen an der Datei vornimmst, speichere sie und ‚ÄûSync‚Äú die Datei anschlie√üend manuell in der Nextcloud-App.
Anscheinend werden lokale √Ñnderungen sonst nicht automatisch auf den Server √ºbertragen.

Bei https://jenson.org/text/ findest du mehr Informationen dazu, warum die mobile Textbearbeitung so ein komplexes und facettenreiches Problem ist. 

===== Umst√§ndliches Mobile-Setup

Um Kalender, Aufgaben und Kontakte mit dem Speicher deines Smartphones unter Android zu synchronisieren, musst du die Drittanbieter-App DAVx5 installieren und konfigurieren.
https://help.nextcloud.com/t/what-does-android-file-sync-do-for-a-nextcloud-account/154330[Ich wei√ü nicht, warum DAVx5 erforderlich ist], aber https://murena.com[Murena] hat dieses Problem f√ºr mich gel√∂st:

Ihr Android-basiertes '/e/ OS' bietet native Unterst√ºtzung f√ºr Nextcloud-Konten und macht DAVx5 √ºberfl√ºssig.
Benutzer mit iOS oder anderen Betriebssystemen au√üer Android k√∂nnen groupware-bezogene Daten https://docs.nextcloud.com/server/stable/user_manual/en/groupware/[ohne DAVx5] synchronisieren.

===== Fehlerhafte Konflikte im Web-Texteditor 

Die Zusammenarbeit an einfachen Text- und Markdown-Dateien f√ºhrt manchmal zu scheinbar grundlosen Konflikten.
Das Bearbeiten wird schon vor dem eigentlichen Start unterbrochen, und der webbasierte Texteditor zeigt zwei Versionen der Datei nebeneinander an.
Links steht ‚ÄûAktuelle Version verwenden‚Äú, rechts ‚ÄûGespeicherte Version verwenden‚Äú (oder die entsprechenden Begriffe f√ºr deine Sprache bzw. deinen Client).

Offenbar l√§dt der Browser zun√§chst eine in seinem lokalen Speicher abgelegte Kopie und betrachtet diese als ‚Äûaktuelle‚Äú Version.
Anschlie√üend l√§dt er die Version vom Server, nennt sie ‚Äûgespeicherte‚Äú Version, und wenn sich die beiden unterscheiden, musst du dich f√ºr eine entscheiden.

Workaround: W√§hle die rechte Version.
Das ist die aktuellste Kopie, wie sie auf dem Server gespeichert ist.

Warum das passiert ‚Ä¶ egal, nimm einfach die rechte Version.
Falls du tiefer in die Thematik einsteigen willst, findest du hier ein paar Links:

* https://github.com/nextcloud/text/issues/2388[Geteiltes Textdokument ist nicht auf dem gleichen Stand wie die gespeicherte Datei]
* https://github.com/nextcloud/text/issues/4078[Das √Ñndern einer Datei vom Desktop aus f√ºhrt zu einem Konflikt im Browser, selbst wenn im Browser keine √Ñnderungen vorgenommen wurden]
* https://help.nextcloud.com/t/text-document-current-vs-saved-version/151600[Text: aktuelle vs. gespeicherte Version eines Dokumentes] (von mir selbst)

Verwandter Desktop-Client-Bug: https://github.com/nextcloud/desktop/issues/2467[Nextcloud-Client erstellt Konflikte, wenn er es nicht sollte].
Konflikte scheinen in Situationen aufzutreten, in denen es eigentlich keine geben sollte.

Problemumgehung: Warte etwa 10 Sekunden zwischen den Speicherungen, bis der Desktop-Client synchronisiert und wieder im Leerlauf ist (Augenrollen inklusive).
Sieh dir die https://apps.nextcloud.com/apps/files_lock[Tempor√§re Dateisperre]-App an f√ºr eine halbautomatische, beratende Sperrung (z. B. um schnell mitzuteilen: ‚ÄûGib mir eine Minute, ich bearbeite gerade diese Markdown-Datei‚Äú).

===== Gezeichnete Unterschriften in Formularen

Forms sind praktisch, um einfache, minimal strukturierte Daten zu sammeln ‚Ä¶ Umfragen, Zusagen (RSVPs), solche Dinge.
Die Daten landen einfach in einer Tabellenkalkulation.
Mit einem Signaturfeld k√∂nnten Forms verwendet werden, um eine gezeichnete Unterschrift zu einem Formular hinzuzuf√ºgen, wie bei einem Vertrag oder einer Verzichtserkl√§rung.

Es gibt bereits Nextcloud-Apps f√ºr Online-Signaturen, die https://en.wikipedia.org/wiki/Digital_signature[digitale Signaturen] einbinden.

Ich m√∂chte jedoch keine digitalen Signaturen, vor allem nicht, wenn sie auf Drittanbieter-Dienste angewiesen sind.
Ich m√∂chte einfach nur ein Low-Tech-Bild, das wie eine gezeichnete Unterschrift am unteren Rand einer Seite aussieht.
Es muss nicht einmal echte Tinte sein.
Falls du das auch m√∂chtest, stimme hier ab oder hilf mit https://github.com/nextcloud/forms/issues/947

https://github.com/OpenSignLabs/OpenSign[OpenSign] und https://github.com/docusealco/docuseal[DocuSeal] sind zwei alternative FOSS self-hostbare Apps, die gezeichnete Unterschriften unterst√ºtzen.

===== Das Release-Skript fehlt im Quellcode

Nextcloud ist FOSS, obwohl https://help.nextcloud.com/t/build-bzip-and-package-from-git/58341[einige Release-Skripte zur√ºckgehalten werden].
Ob sie diese Skripte tats√§chlich ver√∂ffentlichen m√ºssen oder nicht, wei√ü ich nicht.
Ich hoffe, dass sie sich dazu entscheiden, sie freizugeben ‚Äì aus denselben Gr√ºnden, aus denen auch der Rest von Nextcloud FOSS ist.

===== Fehlerhafte Aktualisierungsbenachrichtigungen f√ºr Termine

Die Kalender-App ist ziemlich n√ºtzlich und vermutlich die am meisten genutzte von mir und meinen Nutzern.
Allerdings habe ich mich mittlerweile an eine bestimmte fehlerhafte ‚ÄûTermin aktualisiert‚Äú-Benachrichtigung gew√∂hnt, die m√∂glicherweise durch Probleme mit dem Kalender-Client oder der Synchronisation verursacht wird.

In einem freigegebenen Kalender (mit vielen Clients) bekomme ich oft Benachrichtigungen wie ‚ÄûPerson X hat Termin Y in Kalender Z aktualisiert‚Äú, obwohl in Wirklichkeit nur einer der Clients synchronisiert wurde (oder vielleicht eine unbedeutende √Ñnderung vorgenommen hat) und https://github.com/nextcloud/calendar/issues/5879[Nextcloud f√§lschlicherweise denkt, es handele sich um ein wichtiges Update].
Zumindest glaube ich, dass das passiert ‚Ä¶ manche √Ñnderungen (z. B. wenn sich das Datum √§ndert) zeigen explizit die alten und neuen Werte.
Nebenbei bemerkt gef√§llt mir dieses ‚Äûexplizite Diff‚Äú-Verhalten sehr, bei dem die genauen √Ñnderungen an Titel, Zeit, Ort oder Beschreibung angezeigt werden.

==== Ende-zu-Ende-Verschl√ºsselung

Ende-zu-Ende-verschl√ºsselte Ordner klingen nach einer gro√üartigen Idee.
Es gibt eine Nextcloud-App daf√ºr, aber ich empfehle, sie nicht zu verwenden.

Die Funktion wirkt zwar beinahe fertig, f√ºhlt sich aber immer noch wie fr√ºhe Beta-Software an.
Die Benutzeroberfl√§che ist verwirrend, und ich bin auf einen kritischen Fehler gesto√üen, der Dateien serverseitig unverschl√ºsselt hinterlassen hat.

Au√üerdem https://github.com/nextcloud/end_to_end_encryption/issues/520[funktioniert] https://help.nextcloud.com/t/how-to-setup-e2e-encryption-for-shared-folders/165610[Sharing] https://help.nextcloud.com/t/e2ee-and-file-sharing/145547[nicht], https://github.com/nextcloud/end_to_end_encryption/issues/82[es gibt keinen Web-Client], https://github.com/nextcloud/end_to_end_encryption/issues/285[die Roadmap ist unklar], und https://github.com/nextcloud/end_to_end_encryption/issues/8[Schl√ºssel werden immer auf dem Server gespeichert] (zumindest sind diese verschl√ºsselt).

ifdef::backend-pdf[]
Sorry f√ºr all die sehr langen Links.
Puh!
Tief durchatmen.
Bis 10 z√§hlen.
endif::[]

Gehe vorsichtig mit der Nextcloud-App f√ºr Ende-zu-Ende-Verschl√ºsselung um.
√úberpr√ºfe die https://github.com/nextcloud/end_to_end_encryption/issues[bekannten Probleme], stelle sicher, dass du mit all diesen leben k√∂nntest, und testen sie dann gr√ºndlich mit einer Wegwerf-Nextcloud-Instanz.
Stelle sicher, dass die App mit allen Clients funktioniert, die du verwenden m√∂chten (z. B. Desktop, Mobil).

==== AIO installer

(((Nextcloud, installing)))
Unter den unz√§hligen Nextcloud-Installationsmethoden gibt es einen relativ neuen und interessanten AIO (‚ÄûAll-in-One‚Äú) Installer (https://nextcloud.com/all-in-one).
Er ist kostenlos f√ºr eine Instanz mit weniger als 100 Benutzern.
Der AIO verfolgt einen anderen Ansatz als mario: Er konfiguriert und verwaltet mehrere Nextcloud-bezogene Service-Container f√ºr Sie.
Ich empfehle stattdessen die mario-Methode, da sie eine flexible und lehrreiche Erfahrung bietet, bei der Sie lernen, wie Sie einzelne Container selbst hinzuf√ºgen und verwalten k√∂nnen.

Bei https://github.com/nextcloud/all-in-one[AIO readme] findest du weitere Infos.

== Weitere Ressourcen

Bei https://selfhostbook.com findest du alle unterst√ºtzenden Materialien, inklusive Quellcode, f√ºr dieses Buch und mario.

* https://selfhostbook.com/code/[Quellcode]
* https://selfhostbook.com/contact/[Kontaktinformation]

Patches und Feedback sind sehr willkommen.
Dieses Buch ist nur ein Teil von etwas Gro√üem, und ich freue mich, dass du auch ein Teil davon bist!

=== Support

Hier ein paar Ideen was du tuen kannst, wenn du nicht mehr weiter weisst.

* Frage in Foren und Chats, die mit dem Projekt/Produkt zusammenh√§ngen, um Hilfe.
* Wenn du dir sicher bist, dass du einen Bug gefunden hast, melde es beim Projekt/Produkt.
* Frage https://selfhostbook.com/chat/[andere Leser] um Hilfe.
* Versuche dein Gl√ºck in semi-moderierten √∂ffentlichen Orten.
Halte deine Erwartungen an diese gering, du k√∂nntest aber trotzdem gelegentlich Gl√ºck haben.
** https://reddit.com/r/selfhosted/[self-host Subreddit]
** https://reddit.com/r/homelab/[homelab Subreddit]
** https://matrix.to/#/#Nextcloud:matrix.org[Nextcloud chat]
** https://matrix.to/#/#selfhosted:matrix.org[selbst-gehosteter Chat]
* Stelle mich ein; ich kann dir helfen.

=== Alternativen zu mario

Wenn Sie es eilig haben, k√∂nnen Sie One-Click-Installationen mit vielen sofort einsatzbereiten Apps finden.
(((FreedomBox)))
https://freedombox.org[FreedomBox] ist ein vielversprechender Kandidat.

Es gibt auch viele Abk√ºrzungen und Frontends f√ºr Self-Hosting.
Zum Beispiel sieht https://openmediavault.org[openmediavault] nach einer coolen M√∂glichkeit aus, ein ((DIY)) (Do-it-yourself) ((NAS)) (Network Attached Storage) aufzubauen.

(((YunoHost)))
(((CasaOS)))
(((Runtipi)))
Ausserdem gibt es unz√§hlige weitere dieser teils oder vollst√§ndig gewarteten self-hosting L√∂sungen; wie zum Beispiel:

https://yunohost.org[YunoHost]::
  Nicht ber√ºcksichtigt, ich verwende lieber immer Container.
https://casaos.io[CasaOS]::
  Neu, interessant, sehr wenig Dokumentation.
https://runtipi.io[Runtipi]::
  Neu, interessant, verwendet ((Docker Compose)) und Traefik.

Diese sehen interessant aus, und es ist ermutigend (und auch etwas √ºberw√§ltigend), so viele Optionen in diesem Bereich zu sehen.
Ich habe diese nur gerade so weit evaluiert, dass ich das Gef√ºhl hatte, sie passten nicht zu meinen W√ºnschen und Bed√ºrfnissen.
Ich bin ein m√ºrrischer alter Mann und z√∂gere, Ver√§nderungen vorzunehmen ‚Äì aber manchmal tue ich es trotzdem.
Wenn ich etwas Neues √ºbernehme, muss es eine hohe Messlatte bestehen, idealerweise die meisten oder alle dieser Tests:

.Checkliste: L√∂sungs-Tauglichkeits
[#solution-viability-checklist]
****
* [ ] Wird es √ºber Jahre hinweg mit minimalem Aufwand funktionieren?
* [ ] Ist es leicht erweiterbar?
* [ ] Vertraue ich denen, die es warten und erhalten?
* [ ] Verwendet es Technologien, mit denen ich vertraut bin?
* [ ] Verkleinert oder vergr√∂√üert es meine ((Angriffsfl√§che)) und beeinflusst damit die Sicherheit?
* [ ] F√ºgt es Funktionen oder Mehrwert hinzu, den ich brauche oder will, √ºber das hinaus, was ich bereits kann?
* [ ] Wird es meinen Nutzern helfen?
* [ ] Wird es mir helfen, das zu lernen, was ich lernen m√∂chte/muss, und k√ºmmert es sich sicher um den Rest, ohne dass ich mehr lernen muss?
* [ ] Hilft es mir dabei, herauszufinden, warum ich vor zwei Jahren eine √Ñnderung an einem meiner Dienste vorgenommen habe?
* [ ] Sendet es durch Telemetrie oder auf eine Weise meine Daten nach Hause, die ich nicht guthei√üe?
* [ ] DBeh√§lt es ‚ÄûEnterprise‚Äú-Funktionen vor, die ich auch in meinem kleineren Anwendungsfall brauche?
Ist es dabei aufdringlich und erinnert mich st√§ndig daran?
* [ ] Falls ich bezahlten Support m√∂chte, ist er verf√ºgbar?
* [ ] Ist es popul√§r?
Gibt es das schon l√§nger, und erwarte ich, dass es bestehen bleibt?
****

Siehe auch: <<Merkmale-guter-Dienste>> und <<Merkmale-schlechter-Dienste>> unter <<Dienstwahl>>.

Nach kurzen √úberpr√ºfungen stelle ich fest, dass bestehende Self-Hosting-L√∂sungen im Allgemeinen:
* neu und unreif sind
* keine ausreichende Dokumentation haben
* zu viel tun: versuchen, viele Probleme zu l√∂sen, ohne gen√ºgend Ressourcen oder Stabilit√§t, um alles zu pflegen
* zu wenig tun: im Grunde nur eine weitere Linux-Distribution mit einer zus√§tzlichen Schicht, um Apps zu entdecken und zu installieren
* technologische Entscheidungen treffen, mit denen ich nicht einverstanden bin
* eine begrenzte Liste von Apps in ihren App-Stores haben und die ausschlie√üen, die ich m√∂chte
* zu viele Apps in ihrem App-Store haben, ohne gute M√∂glichkeiten, Qualit√§t, Datenschutz und Funktionen zu vergleichen
* sich auf GUIs (graphische Benutzeroberfl√§chen) konzentrieren, w√§hrend ich lieber mit der Kommandozeile arbeite

Trotzdem: Schau sie dir an.
Vielleicht funktionieren sie f√ºr dich besser, wenn du nicht das Ma√ü an Macht und Kontrolle brauchst, das dieses Buch bietet.
Bis ich ver√∂ffentliche, k√∂nnten sie (oder neue Herausforderer) so weit gereift sein, dass sie meinen Ansatz √ºbertreffen.
Bitte lass mich wissen, was du herausfindest.
Falls ich etwas √ºbersehen habe, w√ºrde ich gerne davon erfahren!

(((Ansible)))
(((Clace)))
(((Cosmos Cloud)))
(((DockSTARTer)))
(((HomelabOS)))
(((Start9)))
(((MicroCloud)))
(((LibreServer)))
(((LinuxServer.io)))
(((NextcloudPi)))
(((UBOS)))
Hier sind einige weitere verwandte und interessante Self-Hosting-L√∂sungen, die eine weitere Recherche wert sind:

* https://github.com/davestephens/ansible-nas[Ansible NAS]
* https://clace.io[Clace]
* https://cosmos-cloud.io[Cosmos Cloud]
* https://dockstarter.com[DockSTARTer]
* https://homelabos.com[HomelabOS]
* https://start9.com[Start9]
* https://canonical.com/microcloud[MicroCloud]
* https://libreserver.org[LibreServer]
* https://www.linuxserver.io[LinuxServer.io]
* https://nextcloudpi.com[NextcloudPi]
* https://ubos.net[UBOS]

== Diskussionsthemen

Hier ein paar Gespr√§chseinstiege f√ºr einen Kurs oder eine Kleingruppendiskussion.

. Welche Dienste betreibst _du_?
Warum?
F√ºr wen?
. Was muss man bedenken, wenn man zwischen Self-Hosting in einer √∂ffentlichen Cloud und lokalem Self-Hosting entscheidet?
. Vergleiche verschiedene Optionen f√ºr bare Metal Self-Hosting-Hardware im Bezug auf Einrichtungskosten, Stromverbrauch und Erweiterbarkeit.
. Warum verschl√ºsselt der Autor den gesamten Netzwerkverkehr, sogar in einem geschlossenen LAN?
. Pr√ºfe dieses Buch auf schlechte Sicherheitspraktiken.
Wie k√∂nnte es verbessert werden?
. Warum ist Privatsph√§re wichtig, besonders bei digitalen Informationen?
. Was ist das Beste am Self-Hosting?
. Was sind einige Fallstricke des Self-Hosting?
. Wie sieht die Zukunft des Self-Hosting aus?
. Was ist die ideale Anzahl von Benutzern, die mit einem einzelnen Self-Hosted-Server unterst√ºtzt werden sollen?
. Ist die im Buch gennante Self-Hosting Methode n√ºtzlich f√ºr gr√∂√üere Gruppen, Gro√üfamilien, Kirchengemeinden, Schulen, Unternehmen und Regierungen?
Warum oder warum nicht?
. Wie k√∂nnte man dieses Buch anpassen f√ºr:
.. unterbrochene Stromversorgung
.. unterbrochene Netzwerkverbindung
.. rein lokale Netzwerke
.. Cluster-Hardware
. Betrachten Sie FOSS (Free and Open Source Software) in Bezug auf menschliche Aufmerksamkeit und Fokus.
Vergleichen Sie es mit nicht-freier Software.
. Welche Ans√§tze in diesem Buch k√∂nnten konzeptionell gef√§hrlich oder irref√ºhrend sein?
Warum?
Wie k√∂nnte man sie verbessern?
. Fassen Sie dieses Buch in einem Satz zusammen.
. Wie k√∂nnten Sie erkennen, ob Ihr Server kompromittiert wurde?

== √úbungen

√úbungen f√ºr individuelles √úben und Lerngruppen.

. Richte einen Dienst ein, zus√§tzlich zu den in mario enthaltenen, unter Verwendung eines bestehenden Images.
Beispiel: ein https://awesome-selfhosted.net/tags/personal-dashboards.html[Dashboard].
. Baue ein benutzerdefiniertes Image.
Hint: Nutze `docker build` der https://buildah.io[Buildah].
. Starte einen Container mit deinem benutzerdefinierten Image.
. Erstelle einen Dienst (unter Verwendung deines Containers), um zu erkennen, ob es Zeit ist, deinen Server neu zu starten.
Hint: √úberpr√ºfe, ob `/host/var/run/reboot-required` existiert.
. Richte einen zweiten Nextcloud-Dienst f√ºr Experimente ein.
Verwende ihn, um neue Versionen oder eine benutzerdefinierte App zu testen.
. Probiere Nextcloud mit Objektspeicher als prim√§rem Speicher aus.
. Passe diese Anleitung an eine andere Linux-Distribution als Ubuntu an.
. Hilf mit, einen in diesem Buch erw√§hnten Fehler zu beheben.
. Richte regelm√§√üige automatische Offsite-Backups ein.
. F√ºge deinem Server einen Grafikprozessor hinzu.
. Aktiviere Grafikprozessor-Transkodierung in Jellyfin.
. Unterzeichne den offenen Brief auf https://publiccode.eu[Public Money, Public Code], weil Software, die mit Steuergeldern bezahlt wird, FOSS sein sollte.
. ammle und fasse Protokolldaten zusammen.‚Äú
. W√§hle einen Docker-Container, der keine ausgehenden Netzwerkverbindungen initiieren muss.
Verhindere, dass er dies kann, und √ºberpr√ºfe, ob es funktioniert.
. Was, wenn der Server nicht bootet?
.. Beschreibe die Schritte zur Fehlerbehebung im Detail.
.. Erstelle einen Plan f√ºr die Systemwiederherstellung, falls der Server nicht startet.
. Richte https://en.wikipedia.org/wiki/Single_sign-on[Single Sign-on] ein.
. Richte https://fail2ban.org[Fail2Ban] ein.
F√ºttere es mit Protokolldaten von verschiedenen Diensten.
. Richte https://suricata.io[Suricata] f√ºr Netzwerkanalyse und Bedrohungserkennung ein.
. Probiere das Ausf√ºhren von Containern mit https://podman.io[podman] aus.
. Informiere dich √ºber andere M√∂glichkeiten, Prozesse zu isolieren, z. B. FreeBSD Jails und chroot.
. Trage zu mario bei.
. Verschiebe geheime Daten, die mario nutzt, in einen sicheren Speicher, z.‚ÄØB. Ansible Vault oder einen selbst gehosteten Dienst f√ºr Passw√∂rter.
. Passe mario an, sodass es mit Podman funktioniert.
. Passe mario an, sodass es mit https://kubernetes.io[Kubernetes] funktioniert.
. Wenn du eine dynamische WAN-IP hast, richte einen Client f√ºr dynamisches DNS ein oder nutze einen bestehenden.
. Richte einen eigenen Mail-Relay-Dienst ein, z.‚ÄØB. mit https://github.com/crazy-max/docker-msmtpd oder https://github.com/namshi/docker-smtp, 
damit alle mario-Dienste E-Mails dar√ºber versenden k√∂nnen..
. Richte einen eigenen DNS-Server ein.
. Ordne die mario-Dienste in unterschiedliche Ansible-Rollen ein.
Lade diese als Playbook-Bundle bei https://galaxy.ansible.com[Ansible Galaxy] hoch.
. Die Docker-Integration von Traefik hat https://doc.traefik.io/traefik/providers/docker/#docker-api-access[Sicherheitsimplikationen].
Teste diese Risiken anhand deines <<Bedrohungsmodell>>.
√§rte mario so ab, dass selbst bei einem kompromittierten Traefik der ganze Server nicht gef√§hrdet ist.
Lies dazu die Traefik-Dokumentation und schaue dir https://github.com/wollomatic/traefik-hardened[traefik-hardened] an.
. Passe mario so an, dass https://docs.docker.com/engine/security/userns-remap/[alle Container immer mit eingeschr√§nkten Benutzerrechten laufen (nicht als Root)].
. Stelle sicher, dass die Daten der Container korrekt zugeordnet und gesch√ºtzt sind (Besitzrechte und Zugriffsrechte).
. Richte die https://github.com/strukturag/nextcloud-spreed-signaling#running-with-docker[hochleistungsf√§hige Nextcloud-Talk-Backend-Komponente] ein.
. https://docs.docker.com/network/packet-filtering-firewalls/#docker-and-ufw[Docker und Unkomplizierte Firewall vertragen sich nicht gut].
Finde eine L√∂sung und teile sie mit anderen.
. Probiere https://nixos.org[Nix and NixOS] aus.
. Erstelle deine eigene Linux-Distribution.
. Baue, konfiguriere und betreibe eine https://opnsense.org[OPNsense Firewall].
. Richte ein eigenes VPN/Tailnet mit https://headscale.net[headscale] ein, um aus der Ferne auf dein LAN zuzugreifen.
. Verbessere die Vorschau- und Miniaturbildgenerierung in Nextcloud. 
.. Pr√ºfe zuerst: Wird die √Ñnderung dir und deinen Nutzern einen Nutzen bringen?
Gibt es Sicherheitsimplikationen?
Wie funktioniert die Standard-Vorschau-Generierung?
Welche Dateitypen werden vom Standard-Vorschauer und anderen Vorschauern unterst√ºtzt?
Wie viel Speicherplatz wird verwendet?
Wie schnell ist es, subjektiv und objektiv?
Welche Wartung wird erforderlich sein, sobald es aktiviert ist?
.. rstelle eine Testumgebung mit einer sauberen Installation und vielen Dateien, die Vorschauen erlauben, in verschiedenen Dateiformaten.
Finde oder schreibe Code, um objektive Leistungsmetriken zu erfassen (z.‚ÄØB. Zeit, die ben√∂tigt wird, um Vorschauen f√ºr einen Ordner mit vielen Dateien verschiedener Typen zu erzeugen).
Ber√ºcksichtige sowohl Client- als auch Server-Leistung.
F√ºhre manuelle Testnotizen (subjektive Messungen).
.. Vergleiche https://apps.nextcloud.com/apps/previewgenerator[Preview Generator], https://github.com/h2non/imaginary[Imaginary], und alle anderen existierenden Vorschauer.
.. Erstelle Basis-Leistungsmetriken, bevor √Ñnderungen vorgenommen werden.
.. Aktiviere einen Vorschauer, erfasse die Zeiten, wiederhole dies f√ºr jeden Vorschauer.
.. Beurteile die √Ñnderungen.
Ist es bemerkbar?
Zeigt dein Timing-Skript einen Unterschied?
Wie viel Speicherplatz wird f√ºr Vorschauen verwendet?
Wie schwierig war die Aktivierung?

Die detaillierten Schritte in der letzten √úbung zeigen, was im Allgemeinen erforderlich sein k√∂nnte, um bessere Ergebnisse zu erzielen.
Ich habe sie in den anderen √úbungen der K√ºrze halber weggelassen.
Bitte wende √§hnliche detaillierte Schritte an anderen Stellen nach Bedarf an.

:sectnums!:

== Nachwort

In den Worten von Scott McNealy, ehemaliger CEO von Sun Microsystems:
____
Open Source is free like a puppy is free.

Open Source ist genauso kostenlos wie ein Welpe kostenlos ist.
____

Jeder liebt Hundewelpen, oder?
_Oder??_
Ich hoffe es doch sehr.
Denn ‚Äì kleine Warnung ‚Äì wenn du zu viel Zeit mit deinem ‚ÄûWelpen‚Äú (Self-Hosting, FOSS usw.) verbringst, taucht dein Partner irgendwann mit einem echten Welpen auf.

[#image-puppy]
.Open Source ist so kostenlos wie ein Welpe. Abgebildet: Ein echter Welpe.
image::puppy.jpg[align="center",scaledwidth=80%]

Wenn dein Problem _so_ niedlich ist, dann ist es wohl kein allzu schlimmes Problem.
Ich hoffe, du findest, was du brauchst, um _deine_ Welpen gl√ºcklich zu machen!

Abschlie√üend m√∂chte ich ein Zitat von Ursula K. Le Guin teilen.
Ihr zufolge:

____
A book is just a box of words until a reader opens it.

Ein Buch ist blo√ü eine Kiste voller Worte, bis ein Leser es √∂ffnet.
____

Liebe Leser*in, _dieses Buch existiert, weil du existierst_.
Ich hoffe, es ist dir eine n√ºtzliche Hilfe.
Ich bin dem√ºtig und dankbar f√ºr deine Unterst√ºtzung.
Danke, danke, danke.

== Danksagungen

Manchmal f√ºhle ich mich eher wie ein Geburtstagskind als ein Author, weil ich so viele Geschenke von zahlreichen gro√üz√ºgige Menschen bekommen habe.
Ohne euch h√§tte ich es ehrlich nicht geschafft, und ich bin unendlich dankbar f√ºr euch.

Danke an Eva f√ºr mehr, als ich hier jemals aufz√§hlen k√∂nnte ‚Äì von ‚ÄûWas, wenn es regnet?‚Äú bis hin zum F√ºhren durch Lernen und furchtloses Handeln. 
F√ºr die Unterst√ºtzung meiner Tr√§ume, einschlie√ülich dieses Buches: deine zahlreichen inspirierenden Runden sorgf√§ltiger Code-Reviews, technischen Kritiken, Entwicklungsbearbeitung, Korrekturlesen, Lektorat und Zeilenbearbeitung.

Danke an meine Tochter f√ºr deine fantastischen Illustrationen.

Danke an Deb Nicholson f√ºr das Schreiben des bedeutungsvollen Vorworts.

Danke an meine Familie und Freunde daf√ºr, dass ihr meine ausgedehnten FOSS-Selbsthostings-Abenteuer, einschlie√ülich dieses Buches, geduldig ertragt.

Danke an Pro Git 2, meine Inspiration, auf Asciidoctor umzusteigen.

Danke an die Mitwirkenden der unz√§hligen FOSS-Programme, die ich zur Erstellung dieses Buches verwendet habe, insbesondere John MacFarlane und das Pandoc-Team, Dan Allen und das Asciidoctor-Team, sowie Bram Moolenaar und das Vim-Team (ruhe in Frieden, Bram).

Danke an Rob Smith und alle bei #underlug f√ºr Hilfe bei Hardware, Netzwerken, Ansible und Traefik.

Danke an die ‚ÄûDeadbeat Dads‚Äú Bryan Daisley und Rob Floberg f√ºr euer unbezahlbares Feedback.

// alphabetical by last name

Danke an alle meine geliebten Beta-Tester, darunter Andrew Davidson, Brendan Kidwell, Eva Monsen, Don O‚ÄôNeill und Lenny Wondra.

Danke an Bob Nystrom f√ºr dein geistig bereicherndes Design-Review.

Danke an Lenny Wondra f√ºr dein au√üerordentlich effektives technisches Review und Lektorat.

Am allermeisten danke ich meiner Frau und meinen Kindern daf√ºr, dass sie mich unterst√ºtzen und an mich glauben.
F√ºr all das Kochen, Reden, Zuh√∂ren, Kunst, Programmieren, Mathematik, Musik und die Liebe.
Haben wir ein Gl√ºck!

== Verzeichnis

Hier ist eine Liste von Definitionen f√ºr einige der weniger offensichtlichen Begriffe, die ich in diesem Buch verwende, um zu verdeutlichen, wie ich sie meine.
Sie orientieren sich so weit wie m√∂glich an der gebr√§uchlichen Verwendung.
Fachleute aus den Bereichen Informatik, Sicherheit, Systemadministration, Netzwerke usw. haben oft noch differenziertere Definitionen.

// Source for "These days that pretty much means git" statement: https://en.wikipedia.org/wiki/Git#Adoption

((AI))::
  Artificial intelligence.
((API))::
  Application programming interface. Provides a way to interact with a service from software. Useful for writing apps and integrations.
((attack surface))::
  Total of possible attack vectors. Fewer is more secure. Example: closing all but the ports you need open reduces yours.
((backend))::
  I use this term to refer to either a service (e.g. a database) or server. It's something you more frequently interact with indirectly, say, via a frontend like a web app or mobile UI.
((Bare Metal))::
  Physical nearby computing resources, as opposed to rented compute time on someone else's hardware. Used in this book primarily to indicate hardware autonomy.
((block storage))::
  Cloud storage option with direct filesystem access including files and folders. Used directly/natively/locally from an OS. Size is relatively fixed and determined at creation time.
((bot))::
  Short for robot. Software performing autonomous tasks such as responding to chat requests or attacking vulnerable servers.
((cattle vs. pets))::
  Highlights two distinct sysadmin approaches to systems/services. Cattle are automated, ephemeral, and hopefully immutable. Pets are managed manually, stateful, and long-lived.
((cert))::
  Shorthand for HTTPS encryption certificate.
((change management))::
  The means and methods of transitioning a group of people from one set of tools and processes to another.
((cloud))::
  An ambiguous amount of remote hardware. Scalable, programmable, and networked. ‚ÄûThe cloud‚Äú or ‚Äûpublic cloud‚Äú is someone else's hardware while ‚Äûpersonal cloud‚Äú is your own.
((cluster))::
  Collated collection of machines treated as a single machine to achieve higher scale computing power.
((compute))::
  Noun: Hauptprozessor or Grafikprozessor resources expended when running software services.
((container))::
  Running instance of an image. Containers may also be referred to as ‚Äûguests‚Äú, although this is more commonly used to describe VMs.
((Hauptprozessor))::
  Central processing unit. The main brain of the computer; the place where most of the math happens.
((data))::
  Noun, plural. Yes, I use the annoying plural form! Sorry, old habit.
((data sovereignty))::
  Full control of your data. For example, having original copies of your files.
((deploy))::
  Prepare a service for use. Typically involves building or copying files before a service is started.
((dogfooding))::
  Being a user of something you also created and/or maintain. ‚ÄûEat your own dogfood.‚Äú
((DHCP))::
  Dynamic Host Configuration Protocol. This is one way computers get IP addresses and related networking settings.
((DIY))::
  Do it yourself. Said of activities involving some amount of learning and tinkering you'd otherwise pay for. Cooking, for example. Also: self-hosting.
((DNS))::
  Domain Name System. Maps domain names to IP addresses.
((domain name))::
  How a server, service, or group of services are identified, e.g. `example.com`.
((DRM))::
  Digital restrictions management. Ancient, evil technology designed to prevent unapproved consumption of content. Probably used for surveillance too.
((egress))::
  Any outbound data transfer or download, in public cloud terms.
((entrypoint))::
  How traffic enters the Traefik Reverse-Proxy; network ports.
((firewall))::
  Means of controlling network traffic between computers.
((fork))::
  Verb: to split one software project into two. Noun: a derivative software work. The fork diverges from the original (otherwise it would simply be a copy). One or many software projects may succeed the original. Forking software is a useful and common activity.
((FOSS))::
  Free and open-Quellesoftware. An acronym designed to unite the goals of the FSF and the OSI.
((FSF))::
  Free Software Foundation. They strongly defend the ‚ÄûF‚Äú in FOSS.
((frontend))::
  The UI for a system or service.
((full-disk encryption))::
  When an entire storage area is cryptographically protected.
((GB))::
  Gigabyte. Typically 1,000^3^ (1,000,000,000) bytes for HDDs, or 1,024^3^ (1,073,741,824) bytes for RAM, for historical reasons. Cloud storage providers use the second (powers of two) form.
((good, fast, and cheap))::
  Used with a wink in this text because https://en.wikipedia.org/wiki/Project_management_triangle[typically we must pick two].
((Good Thing))::
  A hand-wavy way of saying something is self-evidently wonderful.
((Groupware))::
  Software for group collaboration. Loosely: mail, calendar, and contacts. Sometimes includes collborative editing of office documents and spreadsheets.
((Grafikprozessor))::
  Graphics processing unit. Originally intended for graphics. Found to be useful for many specialized compute workloads including transcoding video.
((GUI))::
  Graphical user interface.
((HDD))::
  Hard disk drive. Stores ones and zeros on spinning metal platters.
((homelab))::
  A physical or conceptional space for do-it-yourself flexible systems administration leaning and experimentation. A homelab is not quite what this book describes, it is more of an at-home hardware, software, and electronics maker-space. A _Steadfast_ server (or ‚Äûpersonal cloud‚Äú) should be nearly always online and useful--at least the user-facing part. Some self-hosters call this environment ‚Äûhomeprod‚Äú. Far from this level of hair-splitting detail, I'll use ‚Äûhomelab‚Äú as a shortcut for ‚Äûself-hosting setup‚Äú and/or ‚Äûhomeprod‚Äú.
((host))::
  The computer where Docker containers run. Also called a ‚Äûserver‚Äú in this text.
((hostname))::
  Name for a single server/computer/device.
((HVAC))::
  Heating, ventilation, and air conditioning.
((idempotent))::
  An operation which enacts changes only until an end state is reached. Repeating the operation has no effect once the end state is reached. For example, updating an OS. After the OS is up to date, updating again will cause no changes to the list of installed packages (assuming no new updates become available while updating).
((image))::
  A filesystem with code and dependencies necessary to run a container.
((immutable))::
  Doesn't change. For example, a particular Docker image. A container instantiated from that image can be modified, but the image cannot; a new image must be built.
((IPMI))::
  Intelligent Platform Management Interface. Used for remote server management including reboots and OS installs.
((IPS))::
  Intrusion prevention system. Mitigates the risk of penetration.
((isolation))::
  For software services: Keep separate from others. Eases sysadmin tasks such as preventing dependency version conflicts.
((ISP))::
  Internet service provider.
((kernel))::
  The part of the OS that talks directly with hardware.
((LAN))::
  Local area network. For example, the network used by computers and devices to talk with each other inside your home.
((LFNW))::
  LinuxFest Northwest. Annual conference in Bellingham, Washington dedicated to serving and connecting open Quellecommunities. Established in 2000.
((Linux))::
  The most popular server OS. Also works fine on a desktop or laptop. The old me would have insisted on calling it ‚ÄûGNU/Linux‚Äú or ‚Äûa Linux distribution‚Äú. A lot has happened since then, and I've come to believe ‚ÄûLinux‚Äú is enough to describe the OS used for self-hosting in the context of this book.
((low-code))::
  High-level application development platform with reduced focus on traditional programming. Typically provides a GUI and requires less files with configuration and code. Useful for prototyping or replacing some simpler data entry and analysis applications.
((LTS))::
  Long-term support. A stable software release, supported for many years.
((mario))::
  Provisioning system included with this book to assist with learning how to set up and maintain your own server. Consists of scripts, documentation, and configuration files.
((NAS))::
  Network-attached storage. A server made for storing data. Usually has several HDD bays in a non-Geh√§usestapel box-like form factor. Likely has less Hauptprozessor and RAM (and less power usage) than what I describe in <<Server>>.
((NIC))::
  Network interface card, also called a network adapter. Hardware for receiving and sending data over a network.
((Objektspeicher))::
  Relatively unlimited and typically remote cloud storage option. Actual data are abstracted: backups and structured access require special services, indexes, and software.
((OCR))::
  Optical character recognition. The process of converting images of text to actual text.
((OOB))::
  Out-of-band (management). A means of remote low-level server control including power cycling and console interaction, typically provided by an independently powered and networked embedded computer. See also: IPMI.
(((operating system)))
OS::
  Operating system.
((OSI))::
  Open QuelleInitiative. More concerned with the ‚ÄûOSS‚Äú of FOSS.
((PHP))::
  PHP: Hypertext Processor. Programming language built for the web.
((PoE))::
  Power over ethernet. Utilizes an ethernet cable for electricity as well as data.
((port))::
  Along with an IP address, a number used to connect to a service. Reserved port numbers such as 80 for HTTP are listed in `/etc/services`.
((partition))::
  Delineated section of a HDD or block storage, formatted with a filesystem such as ext4 or ZFS.
((port forward))::
  Router configuration to send traffic for a particular port to a computer inside a LAN.
((process))::
  Instance of running software. Note that ‚Äûrunning‚Äú processes are described in more detail by a lower-level state such as running, sleeping, idle, waiting for I/O completion and--my personal favorite--zombie.
((provision))::
  As in, ‚Äûprovision a server‚Äú. Set up a machine or otherwise bring it into alignment with a known/good configuration.
((RAID))::
  Redundant array of inexpensive disks. Allows flexible use of multiple drives for redundancy and/or speed, as desired.
((registrar))::
  Domain name vendor. May also offer other name- and hosting-related services.
((reproducible))::
  Able to be repeated following specific steps. E.g. ‚Äûrepro‚Äú a bug or ‚Äûa reproducible [software] build‚Äú. If two people try to repro a bug, they should have the same experience. If two people each build an image from the same `Dockerfile`, they should produce the same image. In practice, bug repros and build products are close enough and never exactly the same.
((Reverse-Proxy))::
  Networking software for filtering and directing traffic. In a self-hosted context, useful for SSL termination and for running several self-hosted web services with different domain names with a single IP address.
((router))::
  Network device used to handle traffic at the boundary between networks such as a WAN and LAN. A SOHO router typically also provides various other functions including DNS, DHCP, switching, firewalling, and Wi-Fi. See: port forward. A Traefik router is something different: this is a software logic connecting entrypoints to services. See <<Traefik Architektur>>.
((runtime))::
  The period of time when a software is running; when a set of machine instructions becomes a running process. Also used to describe a set of tools/libraries to facilitate same. May appear as ‚Äûruntime environment‚Äú in the latter form.
((SeaGL))::
  Seattle GNU/Linux Conference. Held yearly since 2013.
((server))::
  A computer that generally stays powered on and uses networking for interaction instead of a monitor, keyboard, or mouse. Also called a ‚Äûhost‚Äú.
((service))::
  A long-running process used by other local and remote processes to do something useful.
((SOHO))::
  Small office / home office.
((Quellecontrol))::
  A system for tracking changes in Quellcode along with who made the change, why, and when. Git is one such system.
((Quelleof truth))::
  The authoritative (home for a) document, perhaps among some number of available choices/copies.
((SSD))::
  Solid-state drive. A hard drive that doesn't spin.
((SSH))::
  Secure Shell. Provides encrypted remote command line access to a server.
((SSL termination))::
  Accepting encrypted traffic and passing along unencrypted traffic. Act performed by Traefik Reverse-Proxy in a mario-provisioned server. More accurately and less often referred to as ‚ÄûTLS termination‚Äú. Actual SSL is deprecated.
((sysadmin))::
  Portmanteau of ‚Äûsystems administrator‚Äú. A party responsible for the upkeep of a computer system.
((threat model))::
  Analysis of risks and defenses of digital assets.
((TB))::
  Terabyte. Like GB, can be either base-10 or base-2, so: 1,000^4^ (1,000,000,000,000) bytes for HDDs and 1,024^4^ (1,099,511,627,776) bytes for RAM.
((TLD))::
  Top-level domain. For ‚Äûexample.com‚Äú, ‚Äû.com‚Äú is the TLD.
((UI))::
  User interface. The means of interaction between a user and a system, e.g.: a web site or mobile app. Often considered along with user experience and notated ‚ÄûUI/UX‚Äú.
((UPS))::
  Uninterruptible power supply. A battery that sits between your server and an outlet, often with extra features such as a power outage alarm or surge suppressor.
((UX))::
  User experience. The nature of interaction between a user and a system they are using. Includes ease of use and steps involved to complete a task. Often considered along with user interface and written as ‚ÄûUI/UX‚Äú.
((volume))::
  Docker facility to mount a folder on the server to a folder inside a container. This is a common means of persisting container data that would otherwise be ephemeral.
((VM))::
  Virtual machine. OS isolation technique simulating nearly all aspects of hardware including power, input, and output.
((VPN))::
  Virtual private network. Useful to ‚Äûteleport home‚Äú and behave (from a networking perspective) as if you are inside your home LAN.
((WAN))::
  Wide-area network. Everything outside your LAN / home network / router.
((ZFS))::
  A filesystem with many advanced features such as encryption, bit rot mitigation, journaling, volume management, and snapshotting. Used to stand for Zettabyte File System.

// Ideally I'd like a full set of these lists for every output.
// See am64 in ../Readme.adoc
//
// The ifndef block disables all cross references for print PDF output. See:
// * https://github.com/Alwinator/asciidoctor-lists/issues/14
// * https://discuss.asciidoctor.org/asciidoctor-pdf-cross-ref-to-a-page-number-td8418.html
//
// An EPUB backend quirk necessitates explicit IDs for everything. See:
// * https://github.com/Alwinator/asciidoctor-lists/issues/25

ifndef::shb-printPdf[]
== Cross references

Here are lists of links to significant blocks of titled content.

=== Figures

list-of::image[]

=== Tables

list-of::table[]

=== Sidebars

list-of::sidebar[]

=== Code snippets

list-of::listing[]

endif::[]

// only matters for PDF output
// see https://docs.asciidoctor.org/asciidoc/latest/sections/user-index/
ifdef::backend-pdf[]
[index]
== Index
endif::[]
